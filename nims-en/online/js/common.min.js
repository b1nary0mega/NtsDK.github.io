"use strict";!function(e){e.profileFieldTypes={text:{name:"text",value:""},string:{name:"string",value:""},"enum":{name:"enum",value:"_"},number:{name:"number",value:0},checkbox:{name:"checkbox",value:!1}},e.objectSubsets=["allObjects","selectedCharacters","selectedStories"],e.networks=["socialRelations","characterPresenceInStory","characterActivityInStory"],e.noGroup="noGroup",e.characterActivityTypes=["active","follower","defensive","passive"],e.numberFilter=["ignore","greater","equal","lesser"],e.finishedText="finishedText",e.finishedSuffix="finishedSuffix",e.emptySuffix="emptySuffix",e[!0]="yes",e[!1]="no",e.yesNo=[e[!0],e[!1]],e.briefingNumber=[1,5,10,20],e.colorPalette=[{color:{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}}},{color:{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}}},{color:{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}}},{color:{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}}},{color:{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}}},{color:{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}}},{color:{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}}},{color:{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}}},{color:{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}}},{color:{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}}},{color:{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}}},{color:{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}}},{color:{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}}},{color:{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}}},{color:{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}}},{color:{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}}},{color:{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}}},{color:{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}}],e.CHAR_NAME="char-name",e.CHAR_OWNER="char-owner",e.summaryStats=[["summary-active","constant-active"],["summary-follower","constant-follower"],["summary-defensive","constant-defensive"],["summary-passive","constant-passive"],["summary-completeness","character-filter-completeness"],["summary-totalStories","character-filter-totalStories"]],e.socialNetworkOpts={nodes:{shape:"dot",scaling:{min:10,max:30,label:{min:8,max:30,drawThreshold:5,maxVisible:30}},font:{size:20,face:"Tahoma"}},edges:{width:.15,color:{inherit:"from"},smooth:{type:"dynamic"}},physics:{barnesHut:{gravitationalConstant:-3e4,springConstant:.1},stabilization:{iterations:50}},layout:{randomSeed:1200},interaction:{tooltipDelay:200}},e.groupSchemaOpts={nodes:{scaling:{min:10,max:30,label:{min:8,max:30,drawThreshold:5,maxVisible:30}},font:{size:20,face:"Tahoma"}},manipulation:!1,height:"90%",layout:{hierarchical:{enabled:!0,levelSeparation:200}},physics:{hierarchicalRepulsion:{nodeDistance:140}}},e.investigationBoardOpts={edges:{arrows:"to",width:.7,color:"black",smooth:{type:"dynamic"},font:{background:"#33cccc",strokeWidth:0}},groups:{groups:{color:{background:"#ffcc00",border:"#a78912"},borderWidth:1,shape:"box"},resources:{color:{background:"#99cc00",border:"#839159"},borderWidth:1,shape:"ellipse"}},physics:{barnesHut:{gravitationalConstant:-2e3,avoidOverlap:.4,springLength:120,centralGravity:.8},stabilization:{iterations:50},timestep:.3}},e.visLocales={ru:{edit:"Редактировать",del:"Удалить выбранное",back:"Назад",addNode:"Добавить узел",addEdge:"Добавить ребро",editNode:"Редактировать узел",editEdge:"Редактировать ребро",addDescription:"Кликните в свободное место, чтобы добавить новый узел.",edgeDescription:"Кликните на узел и протяните ребро к другому узлу, чтобы соединить их.",editEdgeDescription:"Кликните на контрольные точки и перетащите их к другому узлу, чтобы соединить узлы.",createEdgeError:"Невозможно соединить ребра в кластер.",deleteClusterError:"Кластеры не могут быть удалены",editClusterError:"Кластеры недоступны для редактирования."},en:{edit:"Edit",del:"Delete selected",back:"Back",addNode:"Add Node",addEdge:"Add Edge",editNode:"Edit Node",editEdge:"Edit Edge",addDescription:"Click in an empty space to place a new node.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",createEdgeError:"Cannot link edges to a cluster.",deleteClusterError:"Clusters cannot be deleted.",editClusterError:"Clusters cannot be edited."}},e.visLocales.en_EN=e.visLocales.en,e.visLocales.en_US=e.visLocales.en,e.visLocales.ru_RU=e.visLocales.ru,e.httpTimeout=5e3}("undefined"==typeof exports?this.Constants={}:exports),function(e){function t(e,t,i){e.startsWith=function(e,t){return e.substring(0,t.length)===t},e.removeFromArrayByIndex=function(e,t,i){var n=e.slice((i||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,n)},e.charOrdAFactoryBase=t.curry(function(e,t){return function(i,n){return i=t(i),n=t(n),i>n?"asc"===e?1:-1:n>i?"asc"===e?-1:1:0}}),e.charOrdAFactory=e.charOrdAFactoryBase("asc"),e.charOrdA=e.charOrdAFactory(function(e){return e.toLowerCase()}),e.eventsByTime=e.charOrdAFactory(function(e){return new Date(e.time)}),e.strFormat=function(e,t){return e.replace(/\{\{|\}\}|\{(\d+)\}/g,function(e,i){return"{{"==e?"{":"}}"==e?"}":t[i]})},e.consoleLog=function(e){console.log(e)},e.clone=function(t){if(!t||"object"!=typeof t)return t;var i,n,r="function"==typeof t.pop?[]:{};for(i in t)t.hasOwnProperty(i)&&(n=t[i],n&&"object"==typeof n?r[i]=e.clone(n):r[i]=n);return r};var n=function(e,t){return(e+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")};e.globStringToRegex=function(e){return new RegExp(n(e).replace(/\\\*/g,".*").replace(/\\\?/g,"."),"g")},e.escapeRegExp=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},e.arr2map=function(e,t){return e.reduce(function(e,i){return e[i[t]]=i,e},{})},e.acceptDataRow=t.curry(function(t,i){var n,r=!0,o=e.arr2map(i,"itemName");return t.forEach(function(e){if(r)switch(n=o[e.name].value,e.type){case"enum":case"checkbox":e.selectedOptions[n]||(r=!1);break;case"number":switch(e.condition){case"greater":r=n>e.num;break;case"equal":r=n===e.num;break;case"lesser":r=n<e.num}break;case"text":case"string":r=-1!=n.toLowerCase().indexOf(e.regexString.toLowerCase())}}),r}),e.makeFilterInfo=function(e,t,i,n,r){var o={};o.profiles=i,o.charactersSummary=n,o.characterOwners=t,o.profileSettings=e;var a=[];return a.push({name:r.CHAR_NAME,type:"string",displayName:"character-filter-character"}),a.push({name:r.CHAR_OWNER,type:"string",displayName:"character-filter-character-owner"}),a=a.concat(e.map(function(e){return{name:"profile-"+e.name,type:e.type,displayName:e.name,value:e.value}})),a=a.concat(r.summaryStats.map(function(e){return{name:e[0],type:"number",displayName:e[1]}})),o.innerProfileSettings=a,o},e.getCharacterInfoValue=function(t,n,r){return r==i.CHAR_NAME?n:r==i.CHAR_OWNER?t.characterOwners[n]:e.startsWith(r,"summary-")?t.charactersSummary[n][r.substring("summary-".length)]:t.profiles[n][r.substring("profile-".length)]},e.getDataArray=t.curry(function(t,i){return t.innerProfileSettings.map(function(n){var r=e.getCharacterInfoValue(t,i,n.name);return{value:r,type:n.type,itemName:n.name}})}),e.getDataArrays=function(t,i){return Object.keys(t.profiles).map(e.getDataArray(t)).filter(e.acceptDataRow(i))},e.isFilterModelCompatibleWithProfiles=function(e,i){var n=i.filter(t.compose(t.test(/^profile-/),t.prop("name"))),r=t.indexBy(t.prop("name"),e),o=[];return n.forEach(function(e){var i=e.name.substring("profile-".length),n=r[i];if(!n||n.type!==e.type)return void o.push(i);if("enum"===n.type){var a=n.value.split(","),s=Object.keys(e.selectedOptions);if(0!=t.difference(s,a).length)return void o.push(i)}}),o}}e(t)}(function(e){"undefined"==typeof exports?e(this.CommonUtils={},R,Constants):module.exports=e}.bind(this)),function(e){var t=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,i=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,r=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};return function(o,a,s){var h=t;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(o)||/\d/.test(o)||(a=o,o=void 0),o=o?new Date(o):new Date,isNaN(o))throw SyntaxError("invalid date");a=String(h.masks[a]||a||h.masks["default"]),"UTC:"==a.slice(0,4)&&(a=a.slice(4),s=!0);var l=s?"getUTC":"get",d=o[l+"Date"](),c=o[l+"Day"](),u=o[l+"Month"](),f=o[l+"FullYear"](),p=o[l+"Hours"](),m=o[l+"Minutes"](),g=o[l+"Seconds"](),v=o[l+"Milliseconds"](),A=s?0:o.getTimezoneOffset(),y={d:d,dd:r(d),ddd:h.i18n.dayNames[c],dddd:h.i18n.dayNames[c+7],m:u+1,mm:r(u+1),mmm:h.i18n.monthNames[u],mmmm:h.i18n.monthNames[u+12],yy:String(f).slice(2),yyyy:f,h:p%12||12,hh:r(p%12||12),H:p,HH:r(p),M:m,MM:r(m),s:g,ss:r(g),l:r(v,3),L:r(v>99?Math.round(v/10):v),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:s?"UTC":(String(o).match(i)||[""]).pop().replace(n,""),o:(A>0?"-":"+")+r(100*Math.floor(Math.abs(A)/60)+Math.abs(A)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return a.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();t.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},t.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},e(t)}(function(e){"undefined"==typeof exports?this.dateFormat=e:module.exports=e}.bind(this)),function(e){e.data={Meta:{name:"",date:"",preGameDate:"",description:""},Characters:{},ProfileSettings:[],Stories:{},Settings:{BriefingPreview:{},Stories:{},CharacterProfile:{}},Version:"0.4.1"}}("undefined"==typeof exports?this.EmptyBase={}:exports),function(e){function t(e,i){Error.call(this,arguments),this.name="ValidationError",this.messageId=e,this.parameters=i,Error.captureStackTrace?Error.captureStackTrace(this,t):this.stack=(new Error).stack}t.prototype=Object.create(Error.prototype),e.ValidationError=t}("undefined"==typeof exports?this.Errors={}:exports),function(){function e(){}function t(e,t){for(var i=e.length;i--;)if(e[i].listener===t)return i;return-1}function i(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,r=this,o=r.EventEmitter;n.getListeners=function(e){var t,i,n=this._getEvents();if(e instanceof RegExp){t={};for(i in n)n.hasOwnProperty(i)&&e.test(i)&&(t[i]=n[i])}else t=n[e]||(n[e]=[]);return t},n.flattenListeners=function(e){var t,i=[];for(t=0;t<e.length;t+=1)i.push(e[t].listener);return i},n.getListenersAsObject=function(e){var t,i=this.getListeners(e);return i instanceof Array&&(t={},t[e]=i),t||i},n.addListener=function(e,i){var n,r=this.getListenersAsObject(e),o="object"==typeof i;for(n in r)r.hasOwnProperty(n)&&-1===t(r[n],i)&&r[n].push(o?i:{listener:i,once:!1});return this},n.on=i("addListener"),n.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},n.once=i("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},n.removeListener=function(e,i){var n,r,o=this.getListenersAsObject(e);for(r in o)o.hasOwnProperty(r)&&(n=t(o[r],i),-1!==n&&o[r].splice(n,1));return this},n.off=i("removeListener"),n.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},n.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},n.manipulateListeners=function(e,t,i){var n,r,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(n=i.length;n--;)o.call(this,t,i[n]);else for(n in t)t.hasOwnProperty(n)&&(r=t[n])&&("function"==typeof r?o.call(this,n,r):a.call(this,n,r));return this},n.removeEvent=function(e){var t,i=typeof e,n=this._getEvents();if("string"===i)delete n[e];else if(e instanceof RegExp)for(t in n)n.hasOwnProperty(t)&&e.test(t)&&delete n[t];else delete this._events;return this},n.removeAllListeners=i("removeEvent"),n.emitEvent=function(e,t){var i,n,r,o,a,s=this.getListenersAsObject(e);for(o in s)if(s.hasOwnProperty(o))for(i=s[o].slice(0),r=0;r<i.length;r++)n=i[r],n.once===!0&&this.removeListener(e,n.listener),a=n.listener.apply(this,t||[]),a===this._getOnceReturnValue()&&this.removeListener(e,n.listener);return this},n.trigger=i("emitEvent"),n.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return r.EventEmitter=o,e},"function"==typeof define&&define.amd?define(function(){return e}):"object"==typeof module&&module.exports?module.exports=e:r.EventEmitter=e}.call(this),function(e){e.attachLogCalls=function(e,t,i,n){var r={getDatabase:{rewrite:!0},setDatabase:{ignoreParams:!0},setMetaInfo:{filter:function(e){return"description"!==e[0]}},createCharacter:{},renameCharacter:{},removeCharacter:{},createProfileItem:{},renameProfileItem:{},moveProfileItem:{},removeProfileItem:{},updateDefaultValue:{},changeProfileItemType:{},createStory:{},renameStory:{},removeStory:{},addStoryCharacter:{},switchStoryCharacters:{},removeStoryCharacter:{},updateCharacterInventory:{},onChangeCharacterActivity:{},addCharacterToEvent:{},removeCharacterFromEvent:{},createEvent:{},moveEvent:{},cloneEvent:{},mergeEvents:{},removeEvent:{},updateEventProperty:{filter:function(e){return"text"!==e[2]}},createGroup:{},renameGroup:{},removeGroup:{},saveFilterToGroup:{},changeAdaptationReadyStatus:{},getBriefingData:{},addBoardGroup:{},switchGroups:{},setGroupNotes:{},removeBoardGroup:{},createResource:{},renameResource:{},removeResource:{},addEdge:{},setEdgeLabel:{},removeEdge:{}};n&&(r=t.merge(r,n)),Object.keys(e.prototype).filter(t.prop(t.__,r)).forEach(function(t){var n=e.prototype[t];e.prototype[t]=function(){for(var e=[],o=0;o<arguments.length-1;o++)e.push(arguments[o]);var a=!0;if(r[t].filter&&(a=r[t].filter(e)),a){var s="user";i&&(s=arguments[arguments.length-1].name),this.log(s,t,r[t].rewrite,r[t].ignoreParams?[]:e)}return n.apply(this,arguments)}})}}("undefined"==typeof exports?this.Logger={}:exports),function(e){var t=function(e,t,i){console.log(t+"."+i+": "+(void 0!==e[i]?"OK":"undefined"))};e.migrate=function(e){if(t(e,"base","Stories"),!e.Version){e.Settings={};var i,n;Object.keys(e.Stories).forEach(function(t){i=e.Stories[t],n=Object.keys(i.characters),n.forEach(function(e){i.characters[e].activity={}})}),e.Version="0.0.4"}if("0.0.4"===e.Version&&(e.Version="0.4.1"),"0.4.1"===e.Version&&(delete e.Settings.Events,e.Version="0.4.3"),"0.4.3"===e.Version&&(e.Log=[],e.Version="0.4.4",e.Meta.saveTime=new Date),"0.4.4"===e.Version){var r,i;Object.keys(e.Characters).forEach(function(t){r=e.Characters[t],delete r.displayName}),Object.keys(e.Stories).forEach(function(t){i=e.Stories[t],delete i.displayName}),e.Version="0.4.4u1"}if("0.4.4u1"===e.Version){e.ProfileSettings.forEach(function(e){e.doExport=!0}),e.Meta.saveTime=(new Date).toString();for(var o in e.Stories){var i=e.Stories[o];i.events.forEach(function(e){delete e.index,delete e.storyName})}for(var o in e.Stories){var i=e.Stories[o];i.events.forEach(function(e){for(var t in e.characters)delete e.characters[t].name,e.characters[t].time=""})}e.Version="0.4.4u2"}if("0.4.4u2"===e.Version){for(var o in e.Stories){var i=e.Stories[o];i.events.forEach(function(e){for(var t in e.characters)delete e.characters[t].name})}e.Version="0.4.4u3"}if("0.4.4u3"===e.Version){if(e.Groups={},e.ManagementInfo)for(var a in e.ManagementInfo.UsersInfo)e.ManagementInfo.UsersInfo[a].groups=[];e.Version="0.5.0"}return"0.5.0"===e.Version&&(e.InvestigationBoard={groups:{},resources:{},relations:{}},e.Version="0.5.1"),"0.5.1"===e.Version&&(e.Relations={},e.Version="0.5.2"),t(e,"base","Characters"),t(e,"base","ProfileSettings"),t(e,"base","Meta"),t(e,"base","Log"),t(e.Meta,"base.Meta","name"),t(e.Meta,"base.Meta","date"),t(e.Meta,"base.Meta","preGameDate"),t(e.Meta,"base.Meta","description"),t(e.Meta,"base.Meta","saveTime"),e}}("undefined"==typeof exports?this.Migrator={}:exports),function(e){function t(e,t,i){function n(){return{title:"Meta",description:"Contains meta data for game: name, description, dates and saving time.",type:"object",properties:{name:{type:"string",description:"Game name"},date:{type:"string",description:"Time of starting game in game universe."},preGameDate:{type:"string",description:"Time of starting pregame events in game universe."},description:{type:"string",description:"Description text for game."},saveTime:{type:"string",description:"Stringified date of last database saving."}},required:["name","date","preGameDate","description","saveTime"],additionalProperties:!1}}function r(){return{title:"ProfileSettings",description:"Describes character profile settings.",type:"array",items:{type:"object",properties:{name:{type:"string"},type:{type:"string","enum":["string","number","text","checkbox","enum"]},value:{type:["string","number","boolean"]},doExport:{type:"boolean"}},required:["name","type","value","doExport"],additionalProperties:!1}}}function o(){return{type:"array",items:{type:"array",items:{type:"string"},minItems:4,maxItems:4}}}function a(e,t){var i=Object.keys(t.groups),n=i.map(function(e){return"group-"+e}),r=Object.keys(t.resources),o=r.map(function(e){return"resource-"+e}),a={type:"object",properties:{},additionalProperties:!1};n.forEach(function(e){a.properties[e]={type:"string"}}),o.forEach(function(e){a.properties[e]={type:"string"}});var s={type:"object",properties:{},additionalProperties:!1};0!=n.length&&(s.required=n),n.forEach(function(e){s.properties[e]=a});var h={type:"object",properties:{},additionalProperties:!1};r.forEach(function(e){h.properties[e]={type:"object",properties:{name:{type:"string","enum":[e]}},required:["name"],additionalProperties:!1}});var l={type:"object",properties:{},additionalProperties:!1},d=Object.keys(e);d.forEach(function(e){l.properties[e]={type:"object",properties:{name:{type:"string","enum":[e]},notes:{type:"string"}},required:["name","notes"],additionalProperties:!1}});var c={type:"object",properties:{groups:l,resources:h,relations:s},required:["groups","resources","relations"],additionalProperties:!1};return c}function s(e){var t=[];t.push({type:"object",properties:{name:{type:"string","enum":["char-name"]},type:{type:"string","enum":["string"]},regexString:{type:"string",minLength:1}},required:["name","type","regexString"],additionalProperties:!1}),t.push({type:"object",properties:{name:{type:"string","enum":["char-owner"]},type:{type:"string","enum":["string"]},regexString:{type:"string",minLength:1}},required:["name","type","regexString"],additionalProperties:!1}),t=t.concat(e.map(function(e){var t={type:"object",properties:{name:{type:"string","enum":["profile-"+e.name]},type:{type:"string","enum":[e.type]}},required:["name","type"],additionalProperties:!1};switch(e.type){case"text":case"string":t.properties.regexString={type:"string",minLength:1},t.required.push("regexString");break;case"number":t.properties.num={type:"number"},t.properties.condition={type:"string","enum":["greater","lesser","equal"]},t.required.push("num"),t.required.push("condition");break;case"checkbox":t.properties.selectedOptions={type:"object",properties:{"false":{},"true":{}},additionalProperties:!1},t.required.push("selectedOptions");break;case"enum":var i=e.value.split(",").reduce(function(e,t){return e[t]={},e},{});t.properties.selectedOptions={type:"object",properties:i,additionalProperties:!1},t.required.push("selectedOptions")}return t}));var i=["active","follower","defensive","passive","completeness","totalStories"];i.forEach(function(e){t.push({type:"object",properties:{name:{type:"string","enum":["summary-"+e]},type:{type:"string","enum":["number"]},num:{type:"number"},condition:{type:"string","enum":["greater","lesser","equal"]}},required:["name","type","num","condition"],additionalProperties:!1})});var n={name:{type:"string"},masterDescription:{type:"string"},characterDescription:{type:"string"},filterModel:{type:"array",items:{oneOf:t}},doExport:{type:"boolean"}},r={type:"object",additionalProperties:{type:"object",properties:n,required:Object.keys(n),additionalProperties:!1}};return r}function h(e){var t,i={name:{type:"string"}};e.forEach(function(e){switch(e.type){case"text":case"string":t={type:"string"};break;case"checkbox":t={type:"boolean"};break;case"number":t={type:"number"};break;case"enum":t={type:"string","enum":e.value.split(",").map(function(e){return e.trim()})}}i[e.name]=t});var n={type:"object",additionalProperties:{type:"object",properties:i,required:Object.keys(i),additionalProperties:!1}};return n}function l(e){var t=Object.keys(e),i={type:"object",properties:{text:{type:"string"},time:{type:"string"},ready:{type:"boolean"}},required:["text","time"],additionalProperties:!1},n={type:"object",properties:{name:{type:"string"},text:{type:"string"},time:{type:"string"},characters:{type:"object",properties:t.reduce(function(e,t){return e[t]=i,e},{}),additionalProperties:!1}},required:["name","text","time","characters"],additionalProperties:!1},r={type:"object",properties:{name:{type:"string","enum":t},inventory:{type:"string"},activity:{type:"object",properties:{active:{type:"boolean"},follower:{type:"boolean"},defensive:{type:"boolean"},passive:{type:"boolean"}},additionalProperties:!1}},required:["name","inventory","activity"],additionalProperties:!1},o={type:"object",properties:{name:{type:"string"},story:{type:"string"},characters:{type:"object",properties:t.reduce(function(e,t){return e[t]=r,e},{}),additionalProperties:!1},events:{type:"array",items:n}},required:["name","story","characters","events"],additionalProperties:!1},a={type:"object",additionalProperties:o};return a}function d(e,t,i,n){var r=Object.keys(t),o=Object.keys(i),a=Object.keys(n),s=Object.keys(e.UsersInfo);0==o.length&&(o=["123"]),0==r.length&&(r=["123"]),0==a.length&&(a=["123"]);var h={type:"object",properties:{name:{type:"string"},stories:{type:"array",items:{type:"string","enum":o},minItems:0},characters:{type:"array",items:{type:"string","enum":r}},groups:{type:"array",items:{type:"string","enum":a}},salt:{type:"string"},hashedPassword:{type:"string"}},required:["name","stories","characters","groups","salt","hashedPassword"],additionalProperties:!1},l={type:"object",properties:{UsersInfo:{type:"object",additionalProperties:h},admin:{type:"string","enum":s},editor:{type:["string","null"],"enum":s.concat(null)},adaptationRights:{type:"string","enum":["ByStory","ByCharacter"]}},required:["UsersInfo","admin","editor","adaptationRights"],additionalProperties:!1};return l}function c(e,n){var r="^("+t.keys(e).map(i.escapeRegExp).join("|")+")$",o={type:"object",additionalProperties:!1,patternProperties:{}};return o.patternProperties[r]={type:"object",additionalProperties:!1,patternProperties:{}},o.patternProperties[r].patternProperties[r]={type:"string",minLength:1},o}e.getSchema=function(e){var t={$schema:"http://json-schema.org/draft-04/schema#",title:"SMTK NIMS base",description:"SMTK NIMS base schema.",type:"object",definitions:{}},i=n(),u=r(),f=o(),p=h(e.ProfileSettings),m=l(e.Characters),g=s(e.ProfileSettings),v=a(e.Groups,e.InvestigationBoard),A=c(e.Characters,t.definitions),y={};return e.ManagementInfo&&(y=d(e.ManagementInfo,e.Characters,e.Stories,e.Groups)),t.properties={Meta:i,ProfileSettings:u,Characters:p,Stories:m,Version:{type:"string"},Log:f,Groups:g,InvestigationBoard:v,Settings:{},Relations:A,ManagementInfo:y},t.required=["Meta","ProfileSettings","Version","Characters","Stories","Log","Groups","InvestigationBoard","Relations"],t.additionalProperties=!1,t}}e(t)}(function(e){"undefined"==typeof exports?e(this.Schema={},R,CommonUtils):module.exports=e}.bind(this)),function(e){function t(e,t,i){e.prototype.getManagementInfo=function(e){var n=this.database.ManagementInfo,r=t.clone(i.keys(n.UsersInfo).reduce(function(e,t){return e[t]=i.pick(["characters","groups","stories"],n.UsersInfo[t]),e},{}));e(null,{usersInfo:r,admin:n.admin,editor:n.editor,adaptationRights:n.adaptationRights})},e.prototype.assignAdmin=function(e,t){this.database.ManagementInfo.admin=e,this.publishPermissionsUpdate(),t()},e.prototype.assignEditor=function(e,t){this.database.ManagementInfo.editor=e,this.publishPermissionsUpdate(),t()},e.prototype.removeEditor=function(e){this.database.ManagementInfo.editor=null,this.publishPermissionsUpdate(),e()},e.prototype.changeAdaptationRightsMode=function(e,t){this.database.ManagementInfo.adaptationRights=e,this.publishPermissionsUpdate(),t()},e.prototype.isUserNameUsed=function(e,t){t(null,void 0!==this.database.ManagementInfo.UsersInfo[e])},e.prototype.createUser=function(e,t,i){this.database.ManagementInfo.UsersInfo[e]={name:e,stories:[],characters:[],groups:[]},i()},e.prototype.changePassword=function(e,t,i){Utils.alert(strFormat(getL10n("function-must-be-overriden-on-server"),["changePassword"])),i()},e.prototype.removeUser=function(e,t){delete this.database.ManagementInfo.UsersInfo[e],this.publishPermissionsUpdate(),t()},e.prototype.removePermission=function(e,t,i){var n=this.database.ManagementInfo;for(var r in t)0!=t[r].length&&(n.UsersInfo[e][r]=n.UsersInfo[e][r].filter(function(e){return-1===t[r].indexOf(e)}));this.publishPermissionsUpdate(),i()},e.prototype.assignPermission=function(e,t,i){var n=this.database.ManagementInfo;for(var r in t)0!=t[r].length&&(t[r].forEach(function(t){-1===n.UsersInfo[e][r].indexOf(t)&&n.UsersInfo[e][r].push(t)}),Object.keys(n.UsersInfo).forEach(function(i){i!==e&&(n.UsersInfo[i][r]=n.UsersInfo[i][r].filter(function(e){return-1===t[r].indexOf(e)}))}));this.publishPermissionsUpdate(),i()},e.prototype.publishPermissionsUpdate=function(){Utils.alert(strFormat(getL10n("function-must-be-overriden-on-server"),["publishPermissionsUpdate"]))}}e(t)}(function(e){"undefined"==typeof exports?this.accessManagerAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype._init=function(e){this.ee=new n;var t=this;for(var i in e)e[i].forEach(function(e){t.ee.on(i,e.bind(t))})},e.prototype.getDatabase=function(e){this.database.Meta.saveTime=(new Date).toString(),e(null,i.clone(this.database))},e.prototype.setDatabase=function(e,i){this.database=t.migrate(e),i&&i()},e.prototype.getMetaInfo=function(e){e(null,i.clone(this.database.Meta))},e.prototype.setMetaInfo=function(e,t,i){this.database.Meta[e]=t,i&&i()}}e(t)}(function(e){"undefined"==typeof exports?this.baseAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype.getBriefingData=function(e,t){var n=this;n.getAllCharacterGroupTexts(function(o,a){return o?void t(o):(e=i.isNil(e)?i.keys(n.database.Characters):i.keys(e),void r(n._getKnownCharacters,n.database,e,a,t))})};var r=function(e,n,r,u,f){var p=r.map(function(t){var r={gameName:n.Meta.name,charName:t,inventory:a(n,t),storiesInfo:d(n,t),eventsInfo:c(n,t),profileInfoArray:l(n,t),groupTexts:u[t],relations:o(e(n,t),n,t)};return r=i.merge(r,h("profileInfo-",n,t,!1)),r=i.merge(r,h("profileInfo-splitted-",n,t,!0)),r=i.merge(r,s("profileInfo-notEmpty-",n,t))});p.sort(t.charOrdAFactory(i.prop("charName"))),f(null,{briefings:p,gameName:n.Meta.name})},o=function(e,n,r){var o=n.Relations[r],a=n.Characters;return i.keys(o).map(function(t){return{toCharacter:t,text:o[t],splittedText:p(o[t]),profile:a[t],stories:i.keys(e[t]||{}).join(", ")}}).sort(t.charOrdAFactory(i.prop("toCharacter")))},a=function(e,t){var n=[];return i.values(e.Stories).forEach(function(e){e.characters[t]&&e.characters[t].inventory&&""!==e.characters[t].inventory&&(n=n.concat(e.characters[t].inventory))}),n=n.join(", ")},s=function(e,t,i){var n=t.Characters[i],r={};return t.ProfileSettings.forEach(function(t){r[e+t.name]=0!==String(n[t.name]).length}),r},h=function(e,t,i,n){var r=t.Characters[i],o={};return t.ProfileSettings.forEach(function(t){o[e+t.name]=n?p(String(r[t.name])):r[t.name]}),o},l=function(e,t){var n,r,o=e.Characters[t],a=i.compose(i.equals(!0),i.prop("doExport")),s=e.ProfileSettings.filter(a).map(function(e){return n=o[e.name],r=p(String(n)),{itemName:e.name,value:n,splittedText:r,notEmpty:0!==String(n).length}});return s},d=function(e,n){return i.values(e.Stories).filter(function(e){return e.characters[n]}).map(function(t){return{storyName:t.name,eventsInfo:u(t,n,e.Meta.date)}}).sort(t.charOrdAFactory(function(e){return e.storyName.toLowerCase()}))},c=function(e,n){var r=i.values(e.Stories).filter(function(e){return e.characters[n]}).map(function(t){return u(t,n,e.Meta.date)});return r=r.reduce(function(e,t){return e.concat(t)},[]),r.sort(t.eventsByTime),r},u=function(e,t,i){return e.events.filter(function(e){return e.characters[t]}).map(f(t,e.name,i))},f=i.curry(function(e,t,i,n){var r={};return""!==n.characters[e].text?r.text=n.characters[e].text:r.text=n.text,r.splittedText=p(r.text),r.time=""===n.time?i:n.time,""!==n.characters[e].time?r.displayTime=n.characters[e].time:r.displayTime=r.time,r.eventName=n.name,r.storyName=t,r}),p=function(e){return e.split("\n").map(function(e){return{string:e}})}}e(t)}(function(e){"undefined"==typeof exports?this.briefingExportAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r){function o(e,t,i){var n=this;Object.keys(n.database.Characters).forEach(function(t){n.database.Characters[t][e]=i})}function a(e,t){var i=this;Object.keys(this.database.Characters).forEach(function(e){delete i.database.Characters[e][t]})}function s(e,i){var n=this;Object.keys(this.database.Characters).forEach(function(r){n.database.Characters[r][e]=t.profileFieldTypes[i].value})}function h(e,t){var i=this;Object.keys(this.database.Characters).forEach(function(n){var r=i.database.Characters[n][t];delete i.database.Characters[n][t],i.database.Characters[n][e]=r})}function l(e,t,i){var n=this;Object.keys(this.database.Characters).forEach(function(r){var o=n.database.Characters[r][e];
i[o]||(n.database.Characters[r][e]=t)})}e.prototype.getCharacterNamesArray=function(e){e(null,Object.keys(this.database.Characters).sort(i.charOrdA))},e.prototype.getProfile=function(e,t){t(null,i.clone(this.database.Characters[e]))},e.prototype.getAllProfiles=function(e){e(null,i.clone(this.database.Characters))},e.prototype.isCharacterNameUsed=function(e,t){t(null,void 0!==this.database.Characters[e])},e.prototype.createCharacter=function(e,t){if(""===e)return void t(new n.ValidationError("characters-character-name-is-not-specified"));if(this.database.Characters[e])return void t(new n.ValidationError("characters-character-name-already-used",[e]));var i={name:e};this.database.ProfileSettings.forEach(function(e){"enum"===e.type?i[e.name]=e.value.split(",")[0]:i[e.name]=e.value}),this.database.Characters[e]=i,this.ee.trigger("createCharacter",arguments),t&&t()},e.prototype.renameCharacter=function(e,t,i){if(""===t)return void i(new n.ValidationError("characters-new-character-name-is-not-specified"));if(e===t)return void i(new n.ValidationError("characters-names-are-the-same"));if(this.database.Characters[t])return void i(new n.ValidationError("characters-character-name-already-used",[t]));var r=this.database.Characters[e];r.name=t,this.database.Characters[t]=r,delete this.database.Characters[e],this.ee.trigger("renameCharacter",arguments),i&&i()},e.prototype.removeCharacter=function(e,t){delete this.database.Characters[e],this.ee.trigger("removeCharacter",arguments),t&&t()},e.prototype.updateProfileField=function(e,t,i,r,o){var a=this.database.Characters[e];switch(i){case"text":case"string":case"enum":a[t]=r;break;case"number":if(isNaN(r))return void o(new n.ValidationError("characters-not-a-number"));a[t]=Number(r);break;case"checkbox":a[t]=r}o&&o()},r.createProfileItem=r.createProfileItem||[],r.createProfileItem.push(o),r.removeProfileItem=r.removeProfileItem||[],r.removeProfileItem.push(a),r.changeProfileItemType=r.changeProfileItemType||[],r.changeProfileItemType.push(s),r.renameProfileItem=r.renameProfileItem||[],r.renameProfileItem.push(h),r.replaceEnumValue=r.replaceEnumValue||[],r.replaceEnumValue.push(l)}e(t)}(function(e){"undefined"==typeof exports?this.charactersAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r){e.prototype.getConsistencyCheckResult=function(e){var t=[],i=function(e){t.push(e)};d(this.database,i),l(this.database,i),h(this.database,i),s(this.database,i),this.database.ManagementInfo&&a(this.database,i);var o=r.getSchema(this.database),c=n({allErrors:!0}),u=c.compile(o),f=u(this.database);f||(t=t.concat(u.errors)),e(null,t)};var o=function(e){return t.curry(t.compose(e,i.strFormat))},a=function(e,i){var n=t.values(e.Stories).map(t.prop("name")),r=t.values(e.Characters).map(t.prop("name")),a=o(i);t.values(e.ManagementInfo.UsersInfo).forEach(function(e){var i=t.difference(e.characters,r);0!=i.length&&a("Object rights inconsistent, user character is not exist: user {0}, character {1}",[e.name,i]),i=t.difference(e.stories,n),0!=i.length&&a("Object rights inconsistent, user story is not exist: user {0}, story {1}",[e.name,i])})},s=function(e,i){var n=o(i);t.values(e.Stories).forEach(function(e){var i=t.values(e.characters).map(t.prop("name"));e.events.forEach(function(r,o){var a=t.keys(r.characters),s=t.difference(a,i);0!=s.length&&n("Event characters inconsistent, some character is not exist: story {0}, character {1}",[e.name+":"+o,s])})})},h=function(e,i){var n=t.values(e.Characters).map(t.prop("name")),r=o(i);t.values(e.Stories).forEach(function(e){var i=t.values(e.characters).map(t.prop("name")),o=t.difference(i,n);0!=o.length&&r("Story characters inconsistent, some character is not exist: story {0}, character {1}",[e.name,o]);var a=t.keys(e.characters),s=t.symmetricDifference(i,a);0!=s.length&&r("Story characters inconsistent, inner and outer character name are inconsistent: story {0}, character {1}",[e.name,s])})},l=function(e,i){var n=e.ProfileSettings,r=o(i)("Profile value inconsistency, item type is inconsistent: char {0}, item {1}, value {2}"),a=function(e,i,n){switch(i){case"text":case"string":return!t.is(String,e);case"enum":if(t.is(String,e)){var r=n.split(",").map(t.trim);return!t.contains(e.trim(),r)}return!0;case"number":return!t.is(Number,e);case"checkbox":return!t.is(Boolean,e)}};t.values(e.Characters).forEach(function(e){n.forEach(function(t){a(e[t.name],t.type,t.value)&&r([e.name,t.name,e[t.name]])})})},d=function(e,i){var n=e.ProfileSettings.map(t.prop("name")),r=o(i);t.values(e.Characters).forEach(function(e){var i=t.keys(e).filter(t.compose(t.not,t.equals("name"))),o=t.symmetricDifference(i,n);if(0!=o.length){var a=r(t.__,[e.name,o]);if(i.length!==n.length)return a("Character profile inconsistent, lengths are different: char {0}, difference [{1}]");if(!t.all(t.contains(t.__,n))(i))return a("Character profile inconsistent, item name inconsistency: char {0}, difference [{1}]")}})}}e(t)}(function(e){"undefined"==typeof exports?this.consistencyCheckAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r,o){function a(e,t){var i="profile-"+t,n=this;Object.keys(this.database.Groups).forEach(function(e){var t=n.database.Groups[e];t.filterModel=t.filterModel.filter(function(e){return e.name!==i})})}function s(e,t){a.apply(this,[-1,e])}function h(e,t){var i="profile-"+t,n=this;Object.keys(this.database.Groups).forEach(function(t){var r=n.database.Groups[t];r.filterModel=r.filterModel.map(function(t){return t.name===i&&(t.name="profile-"+e),t})})}function l(e,t,i){var n="profile-"+e,r=this;Object.keys(this.database.Groups).forEach(function(e){var t=r.database.Groups[e];t.filterModel.forEach(function(e){if(e.name===n)for(var t in e.selectedOptions)i[t]||delete e.selectedOptions[t]})}),Object.keys(this.database.Groups).forEach(function(e){var t=r.database.Groups[e];t.filterModel=t.filterModel.filter(function(e){return e.name!==n?!0:0!=Object.keys(e.selectedOptions).length})})}e.prototype.getGroupNamesArray=function(e){e(null,Object.keys(this.database.Groups).sort(n.charOrdA))},e.prototype.getGroup=function(e,t){t(null,n.clone(this.database.Groups[e]))};var d=function(e,i,r){var o=n.getDataArray(i,r),a=t.values(e).filter(function(e){return e.doExport&&n.acceptDataRow(e.filterModel,o)}).map(function(e){return{groupName:e.name,text:e.characterDescription}});return a.sort(n.charOrdAFactory(t.prop("groupName"))),a};e.prototype.getCharacterGroupTexts=function(e,t){var i=this;this.getCharacterFilterInfo(function(n,r){return n?void t(n):void t(null,d(i.database.Groups,r,e))})},e.prototype.getAllCharacterGroupTexts=function(e){var t=this;this.getCharacterFilterInfo(function(i,n){if(i)return void e(i);var r=Object.keys(t.database.Characters).reduce(function(e,i){return e[i]=d(t.database.Groups,n,i),e},{});e(null,r)})},e.prototype.isGroupNameUsed=function(e,t){t(null,void 0!==this.database.Groups[e])},e.prototype.createGroup=function(e,t){if(""===e)return void t(new r.ValidationError("groups-group-name-is-not-specified"));if(this.database.Groups[e])return void t(new r.ValidationError("groups-group-name-already-used",[e]));var i={name:e,masterDescription:"",characterDescription:"",filterModel:[],doExport:!0};this.database.Groups[e]=i,this.ee.trigger("createGroup",arguments),t&&t()},e.prototype.renameGroup=function(e,t,i){if(""===t)return void i(new r.ValidationError("groups-new-group-name-is-not-specified"));if(e===t)return void i(new r.ValidationError("groups-names-are-the-same"));if(this.database.Groups[t])return void i(new r.ValidationError("groups-group-name-already-used",[t]));var n=this.database.Groups[e];n.name=t,this.database.Groups[t]=n,delete this.database.Groups[e],this.ee.trigger("renameGroup",arguments),i&&i()},e.prototype.removeGroup=function(e,t){delete this.database.Groups[e],this.ee.trigger("removeGroup",arguments),t&&t()},e.prototype.saveFilterToGroup=function(e,t,i){var o=n.isFilterModelCompatibleWithProfiles(this.database.ProfileSettings,t);return 0!=o.length?void i(new r.ValidationError("groups-page-filter-is-incompatible-with-base-profiles",[o.join(",")])):(this.database.Groups[e].filterModel=t,void(i&&i()))},e.prototype.updateGroupField=function(e,t,i,n){var r=this.database.Groups[e];r[t]=i,n&&n()},e.prototype.getCharacterFilterInfo=function(e){var r=this;r.getCharacterNamesArray(function(o,a){return o?void e(o):(a=r._getOwnerMap?r._getOwnerMap("Characters"):t.zipObj(a,t.repeat("user",a.length)),void r.getAllProfiles(function(t,o){return t?void e(t):void r.getCharactersSummary(function(t,s){return t?void e(t):void r.getAllProfileSettings(function(t,r){if(t)return void e(t);var h=n.makeFilterInfo(r,a,o,s,i);e(null,h)})})}))})},o.removeProfileItem=o.removeProfileItem||[],o.removeProfileItem.push(a),o.changeProfileItemType=o.changeProfileItemType||[],o.changeProfileItemType.push(s),o.renameProfileItem=o.renameProfileItem||[],o.renameProfileItem.push(h),o.replaceEnumValue=o.replaceEnumValue||[],o.replaceEnumValue.push(l);var c=function(e,i){var n=t.indexBy(t.prop("name"),e),r=t.indexBy(t.prop("name"),i);return t.equals(n,r)},u=function(e,i){return 0==t.symmetricDifference(t.keys(e),t.keys(i)).length},f=function(e,i){return 0==t.difference(t.keys(e),t.keys(i)).length},p=function(e,i){var n=t.indexBy(t.prop("name"),e),r=t.indexBy(t.prop("name"),i),o=t.keys(n),a=t.keys(r);return 0==a.length?!0:0!=t.difference(a,o).length?!1:a.every(function(e){var i=r[e],o=n[e];switch(i.type){case"text":case"string":return-1!==o.regexString.indexOf(i.regexString);case"enum":case"checkbox":return 0==t.difference(t.keys(i.selectedOptions),t.keys(o.selectedOptions)).length;case"number":if("greater"===o.condition&&"lesser"===i.condition)return!1;if("lesser"===o.condition&&"greater"===i.condition)return!1;if("equal"===o.condition)return"equal"!==i.condition?!1:o.num==i.num;if("greater"===o.condition)return o.num<=i.num;if("lesser"===o.condition)return o.num>=i.num}})},m=function(e){t.values(e).forEach(function(i){for(var n=t.keys(i),r=0;r<n.length;++r)for(var o=0;o<n.length;++o)if(r!=o){var a=n[r],s=n[o];e[a][s]&&delete i[s]}})},g=function(e,i,n){function r(e){if(o[e])return o[e];var n=t.keys(i[e]);return 0==n.length?1:n.map(r).reduce(function(e,t){return t>e?t:e},-1)+1}var o={};t.keys(i).forEach(function(e){o[e]||(o[e]=r(e))});var a=t.keys(i).map(function(i){return{id:i,label:[i].concat(e[i]||[]).join(", "),level:o[i],title:t.keys(n[i]).join(", ")}}),s=t.keys(i).reduce(function(e,n){return e.concat(t.keys(i[n]).map(function(e){return{from:n,to:e,arrow:"to"}}))},[]);return{nodes:a,edges:s}},v=function(e,i,n,r,o){for(var a=t.keys(e),s=t.zipObj(a,t.repeat(!0,a.length)),h={},l=0;l<a.length;++l){var d=a[l];if(s[d])for(var c=l+1;c<a.length;++c){var u=a[c];s[u]&&i(r(d),r(u))&&(s[u]=!1,h[d]=h[d]||[],h[d].push(u))}}for(var f=t.toPairs(s).filter(function(e){return e[1]}).map(t.head),p=t.zipObj(f,t.ap([t.clone],t.repeat({},f.length))),l=0;l<f.length;++l)for(var c=0;c<f.length;++c)if(l!=c){var d=f[l],u=f[c];n(r(d),r(u))&&(p[d][u]=!0)}return m(p),g(h,p,o)},A=function(e,i,r){var o=t.keys(e),a=t.zipObj(o,t.ap([t.clone],t.repeat({},o.length)));return i.forEach(function(t){var i=n.getDataArray(r,t);o.forEach(function(r){n.acceptDataRow(e[r].filterModel,i)&&(a[r][t]=!0)})}),a};e.prototype.getGroupSchemas=function(e){var i=this;this.getCharacterFilterInfo(function(n,r){if(n)return void e(n);var o={},a=i.database.Groups,s=A(a,t.keys(i.database.Characters),r);o.theory=v(a,c,p,function(e){return a[e].filterModel},s),o.practice=v(a,u,f,function(e){return s[e]},s),e(null,o)})}}e(t)}(function(e){"undefined"==typeof exports?this.groupsAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r,o){function a(e,i){"resources"!==i&&(t.path(f,this.database)[m(e,i)]={})}function s(e,i){var n=m(e,i),r=t.path(f,this.database);delete r[n],t.values(r).forEach(function(e){delete e[n]})}function h(e,i,n){var r=t.path(f,this.database),o=m(i,n),a=m(e,n);"groups"===n&&(r[o]=r[a],delete r[a]),t.values(r).forEach(function(e){void 0!==e[a]&&(e[o]=e[a],delete e[a])})}function l(e,i){var n=t.path(u,this.database),r=n[e];r.name=i,n[i]=r,delete n[e],h.apply(this,[e,i,"groups"])}function d(e){var i=t.path(u,this.database);if(void 0!==i[e]){delete i[e],i=t.path(f,this.database);var n=m(e,"groups");delete i[n],t.values(i).forEach(function(e){void 0!==e[n]&&delete e[n]})}}var c=["InvestigationBoard","resources"],u=["InvestigationBoard","groups"],f=["InvestigationBoard","relations"],p="investigation-board";e.prototype.isResourceNameUsed=function(e,t){t(null,void 0!==this.database.InvestigationBoard.resources[e])},e.prototype.getInvestigationBoardData=function(e){e(null,n.clone(this.database.InvestigationBoard))},e.prototype.addBoardGroup=function(e,t){if(""===e)return void t(new r.ValidationError(p+"-group-name-is-not-specified"));var i=this.database.InvestigationBoard;return i.groups[e]?void t(new r.ValidationError(p+"-group-already-used-on-board")):(i.groups[e]={name:e,notes:""},this.ee.trigger("nodeAdded",[e,"groups"]),void(t&&t()))},e.prototype.switchGroups=function(e,i,n){var r=this._renameEntityPrecondition(e,i,u,p);if(r)n(r);else{var o=t.path(u,this.database),a=o[e];a.name=i,o[i]=a,delete o[e],this.ee.trigger("nodeRenamed",[e,i,"groups"]),n&&n()}},e.prototype.setGroupNotes=function(e,i,n){var r=t.path(u,this.database),o=r[e];o.notes=i,n&&n()},e.prototype.removeBoardGroup=function(e,t){if(""===e)return void t(new r.ValidationError(p+"-group-name-is-not-specified"));var i=this.database.InvestigationBoard;return i.groups[e]?(delete i.groups[e],this.ee.trigger("nodeRemoved",[e,"groups"]),void(t&&t())):void t(new r.ValidationError(p+"-group-is-not-used-on-board"))},e.prototype._createEntityPrecondition=function(e,i,n){return""===e?new r.ValidationError(n+"-new-name-is-not-specified"):void 0!==t.path(i,this.database)[e]?new r.ValidationError(n+"-name-already-used",[e]):void 0},e.prototype._renameEntityPrecondition=function(e,i,n,o){return""===i?new r.ValidationError(o+"-rename-name-is-not-specified"):i===e?new r.ValidationError(o+"-names-are-the-same"):t.path(n,this.database)[i]?new r.ValidationError(o+"-name-already-used",[i]):void 0},e.prototype.createResource=function(e,i){var n=this._createEntityPrecondition(e,c,p);n?i(n):(t.path(c,this.database)[e]={name:e},this.ee.trigger("nodeAdded",[e,"resources"]),i&&i())},e.prototype.renameResource=function(e,i,n){var r=this._renameEntityPrecondition(e,i,c,p);if(r)n(r);else{var o=t.path(c,this.database),a=o[e];a.name=i,o[i]=a,delete o[e],this.ee.trigger("nodeRenamed",[e,i,"resources"]),n&&n()}},e.prototype.removeResource=function(e,i){delete t.path(c,this.database)[e],this.ee.trigger("nodeRemoved",[e,"resources"]),i&&i()},e.prototype._addEdgePrecondition=function(e,i,o,a){return n.startsWith(e,"resource-")?new r.ValidationError(a+"-resource-node-cant-be-first"):void 0!==t.path(f,this.database)[e][i]?new r.ValidationError(a+"-such-relation-already-exists"):void 0},e.prototype.addEdge=function(e,i,n,r){var o=this._addEdgePrecondition(e,i,n,p);o?r(o):(t.path(f,this.database)[e][i]=n,r&&r())},e.prototype._setEdgeLabelPrecondition=function(e,i,o,a){return n.startsWith(e,"resource-")?new r.ValidationError(a+"-resource-node-cant-be-first"):void 0===t.path(f,this.database)[e][i]?new r.ValidationError(a+"-relation-is-not-exist"):void 0},e.prototype.setEdgeLabel=function(e,i,n,r){var o=this._setEdgeLabelPrecondition(e,i,n,p);o?r(o):(t.path(f,this.database)[e][i]=n,r&&r())},e.prototype.removeEdge=function(e,i,n){delete t.path(f,this.database)[e][i],n&&n()};var m=function(e,t){return("groups"===t?"group-":"resource-")+e};o.nodeAdded=o.nodeAdded||[],o.nodeAdded.push(a),o.nodeRemoved=o.nodeRemoved||[],o.nodeRemoved.push(s),o.nodeRenamed=o.nodeRenamed||[],o.nodeRenamed.push(h),o.renameGroup=o.renameGroup||[],o.renameGroup.push(l),o.removeGroup=o.removeGroup||[],o.removeGroup.push(d)}e(t)}(function(e){"undefined"==typeof exports?this.investigationBoardAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i){e.prototype.log=function(e,t,n,r,o){var a=[e,(new Date).toString(),t,JSON.stringify(r)];this.database&&(n&&void 0!=this.database.Log[this.database.Log.length-1]?this.database.Log[this.database.Log.length-1][2]===t&&(this.database.Log[this.database.Log.length-1]=a):(this.database.Log.push(a),this.database.Log.length>2e3&&this.database.Log.splice(0,1e3))),console.log(i.strFormat("{0},{1},{2},{3}",a)),o&&o()},e.prototype.getLog=function(e,t){for(var i=[],n=100*e;100*(e+1)>n;n++)this.database.Log[n]&&i.push([n+1].concat(this.database.Log[n]));t(null,{requestedLog:i,logSize:Math.ceil(this.database.Log.length/100)})}}e(t)}(function(e){"undefined"==typeof exports?this.logAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype.getAllProfileSettings=function(e){e(null,i.clone(this.database.ProfileSettings))},e.prototype.createProfileItem=function(e,t,i,r,o,a){var s=this;this.isProfileItemNameUsed(e,function(h,l){if(h)return void a(h);if(l)return void a(new n.ValidationError("characters-such-name-already-used"));var d={name:e,type:t,value:i,doExport:!0};r?s.database.ProfileSettings.push(d):s.database.ProfileSettings.splice(o,0,d),s.ee.trigger("createProfileItem",[e,t,i]),a()})},e.prototype.moveProfileItem=function(e,t,i){t>e&&t--;var n=this.database.ProfileSettings,r=n[e];n.splice(e,1),n.splice(t,0,r),i()},e.prototype.removeProfileItem=function(e,t,n){i.removeFromArrayByIndex(this.database.ProfileSettings,e),this.ee.trigger("removeProfileItem",arguments),n()},e.prototype.changeProfileItemType=function(e,i,n){var r=this.database.ProfileSettings.filter(function(t){return t.name===e})[0];r.type=i,r.value=t.profileFieldTypes[i].value,this.ee.trigger("changeProfileItemType",arguments),n()},e.prototype.isProfileItemNameUsed=function(e,t){if(""===e)return void t(new n.ValidationError("characters-profile-item-name-is-not-specified"));if("name"===e)return void t(new n.ValidationError("characters-profile-item-name-cant-be-name"));var i=function(t){return e===t.name};t(null,this.database.ProfileSettings.some(i))},e.prototype.renameProfileItem=function(e,t,i){var r=this;this.isProfileItemNameUsed(e,function(o,a){return o?void i(o):a?void i(new n.ValidationError("characters-such-name-already-used")):(r.ee.trigger("renameProfileItem",[e,t]),r.database.ProfileSettings.filter(function(e){return e.name===t})[0].name=e,void i())})},e.prototype.doExportProfileItemChange=function(e,t,i){var n=this.database.ProfileSettings.filter(function(t){return t.name===e})[0];n.doExport=t,i()},e.prototype.updateDefaultValue=function(e,t,i){var r,o,a,s,h=this.database.ProfileSettings.filter(function(t){return t.name===e})[0];switch(h.type){case"text":case"string":case"checkbox":h.value=t;break;case"number":if(isNaN(t))return void i(new n.ValidationError("characters-not-a-number"));h.value=Number(t);break;case"enum":if(""===t)return void i(new n.ValidationError("characters-enum-item-cant-be-empty"));r=h.value.split(","),o=t.split(","),o=o.map(function(e){return e.trim()}),a=[{}].concat(o).reduce(function(e,t){return e[t]=!0,e}),s=r.filter(function(e){return!a[e]}),0!==s.length&&this.ee.trigger("replaceEnumValue",[e,o[0],a]),h.value=o.join(",")}i()}}e(t)}(function(e){"undefined"==typeof exports?this.profileConfigurerAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r,o){var a=["Relations"];e.prototype._getKnownCharacters=function(e,i){var n=e.Stories,r={};return t.values(n).forEach(function(e){var n=t.compose(t.not,t.isNil,t.prop(i),t.prop("characters"));e.events.filter(n).forEach(function(i){t.keys(i.characters).forEach(function(t){r[t]=r[t]||{},r[t][e.name]=!0})})}),delete r[i],r},e.prototype.getRelationsSummary=function(e,i){var n=t.path(a,this.database),r={};t.keys(n).forEach(function(t){var i=n[t];i[e]&&(r[t]=i[e])}),i(null,{directRelations:n[e]||{},reverseRelations:r,knownCharacters:this._getKnownCharacters(this.database,e)})};var s=function(e,t,i){return void 0===i.Characters[e]?new r.ValidationError("briefings-character-does-not-exist",[e]):void 0===i.Characters[t]?new r.ValidationError("briefings-character-does-not-exist",[t]):void 0};e.prototype.setCharacterRelation=function(e,i,n,r){var o=s(e,i,this.database),h=t.path(a,this.database);o?r(o):(n=n.trim(),""===n?void 0!==h[e]&&delete h[e][i]:(h[e]=h[e]||{},h[e][i]=n),r&&r())};var h=function(e,i){var n=t.path(a,this.database);void 0!==n[e]&&(n[i]=n[e],delete n[e]),t.values(n).forEach(function(t){void 0!==t[e]&&(t[i]=t[e],delete t[e])})};o.renameCharacter=o.renameCharacter||[],o.renameCharacter.push(h);var l=function(e){var i=t.path(a,this.database);void 0!==i[e]&&delete i[e],t.values(i).forEach(function(t){void 0!==t[e]&&delete t[e]})};o.removeCharacter=o.removeCharacter||[],o.removeCharacter.push(l)}e(t)}(function(e){"undefined"==typeof exports?this.relationsAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i){e.prototype.getStatistics=function(e){var t=this;this.getAllCharacterGroupTexts(function(i,r){return i?void e(i):void n(t.database,r,e)})};var n=function(e,i,n){var r={};r.storyNumber=Object.keys(e.Stories).length,r.characterNumber=Object.keys(e.Characters).length,r.eventsNumber=t.sum(t.values(e.Stories).map(t.compose(t.length,t.prop("events")))),r.userNumber=1,e.ManagementInfo&&e.ManagementInfo.UsersInfo&&(r.userNumber=Object.keys(e.ManagementInfo.UsersInfo).length),r.textCharacterNumber=b(e);var a=E(e);r.firstEvent=a[0]?a[0]:"",r.lastEvent=a[1]?a[1]:"",r.storyEventsHist=w(e,function(e){return e.events.length}),r.storyCharactersHist=w(e,function(e){return Object.keys(e.characters).length}),r.eventCompletenessHist=p(e),r.characterStoriesHist=f(e,l),r.characterSymbolsHist=f(e,d(i)),r.generalCompleteness=A(e),r.storyCompleteness=v(e),r.characterChartData=s(e,"characters","Characters"),r.storyChartData=s(e,"stories","Stories"),r.groupChartData=s(e,"groups","Groups"),r.profileCharts=o(e),n(null,r)},r=function(e){var t=e.reduce(function(e,t){return t>e?t:e},e[0]),i=e.reduce(function(e,t){return e>t?t:e},e[0]),n=Math.ceil((t-i)/20);n=0===n?1:n;for(var r=1;n>10*r;)r=10*r;for(var o=[1,2,5,10,12],a=0;a<o.length-1;a++)if(r*o[a]<n&&n<r*o[a+1]){n=r*o[a];break}return n},o=function(e){var i=e.ProfileSettings.filter(function(e){return"string"!==e.type&&"text"!==e.type}).map(t.pick(["name","type"])),n=t.groupBy(t.__,t.values(e.Characters)),o=function(e){return t.fromPairs(t.toPairs(e).map(function(e){return e[1]=e[1].length,e}))},a=i.map(function(i){if("enum"===i.type||"checkbox"===i.type)return o(n(t.prop(i.name)));var a=t.ap([t.prop(i.name)],t.values(e.Characters)),s=r(a);return{groups:o(n(function(e){return Math.floor(e[i.name]/s)})),step:s}});return t.transpose([i,a]).map(function(e){return t.assoc("data",e[1],e[0])})},a=function(e,t,i){return[e,": ",(t/i*100).toFixed(0),"% (",t,"/",i,")"].join("")},s=function(e,t,i){var n=[],r=Object.keys(e[i]).length,o=0;if(e.ManagementInfo&&e.ManagementInfo.UsersInfo){var s,h;for(var l in e.ManagementInfo.UsersInfo)s=e.ManagementInfo.UsersInfo[l],h=s[t].length,n.push({value:h,label:a(l,h,r)}),o+=h;o!==r&&n.push({value:r-o,label:a("unknown",r-o,r)})}else n.push({value:r,label:a("user",r,r)});return n},h=function(e,t,i,n,r,o){e[i]?(e[i].value=o(e[i].value,t),e[i].tip.push(n)):e[i]={value:r(t),label:i,tip:[n]}},l=function(e,i){t.values(e.Stories).forEach(function(e){t.keys(e.characters).forEach(function(e){i[e]++})})},d=t.curry(function(e,i,n){t.values(i.Stories).forEach(function(e){e.events.forEach(function(e){for(var t in e.characters)0!=e.characters[t].text.length?n[t]+=y(e.characters[t].text):n[t]+=y(e.text)})});for(var r in e)n[r]+=t.sum(e[r].map(t.pipe(t.prop("text"),y)))}),c=function(e,t){return e+" ("+t+")"},u=function(e,t,i){return e*t+"-"+((e+1)*t-1)+": "+i.join(", ")},f=function(e,i){var n=t.keys(e.Characters),o=t.zipObj(n,t.repeat(0,n.length));i(e,o);for(var a=t.values(o),s=r(a),l=t.keys(o).reduce(function(e,i){var n=Math.floor(o[i]/s);return h(e,1,n,c(i,o[i]),t.always(1),t.add),e},[]),d=0;d<t.max(l.length,10);d++)l[d]?l[d].tip=u(d,s,l[d].tip):l[d]=null;return l},p=function(e){var i,n,r=[];for(var o in e.Stories){i=e.Stories[o],n=g(i);var a=Math.floor(10*n),s=i.name+" ("+(100*n).toFixed(0)+"%)";h(r,1,a,s,t.always(1),t.add)}for(var l=0;11>l;l++)r[l]?r[l].tip=r[l].tip.join(", "):r[l]=null;return r},m=function(e){var t=0,i=0;return e.events.forEach(function(e){i+=Object.keys(e.characters).length;for(var n in e.characters)e.characters[n].ready&&t++}),{finishedAdaptations:t,allAdaptations:i}},g=function(e){var t=m(e);return 0!==t.allAdaptations?t.finishedAdaptations/t.allAdaptations:0},v=function(e){var i=0,n=Object.keys(e.Stories).length;return t.values(e.Stories).map(m).forEach(function(e){e.allAdaptations===e.finishedAdaptations&&0!=e.allAdaptations&&i++}),[(i/(0===n?1:n)*100).toFixed(1),i,n]},A=function(e){var i=0,n=0;return t.values(e.Stories).map(m).forEach(function(e){i+=e.finishedAdaptations,n+=e.allAdaptations}),[(i/(0===n?1:n)*100).toFixed(1),i,n]},y=function(e){return e.replace(/\s/g,"").length},b=function(e){var i,n,r,o=0;for(r in e.Stories)i=e.Stories[r],o+=y(i.story),i.events.forEach(function(e){o+=y(e.text);for(n in e.characters)o+=y(e.characters[n].text)});return o+=t.sum(t.values(e.Groups).map(t.compose(y,t.prop("characterDescription"))))},E=function(e){var t,i,n=null,r=null;for(var o in e.Stories)t=e.Stories[o],t.events.forEach(function(e){""!=e.time&&(i=new Date(e.time),(null===n||i>n)&&(n=i),(null===r||r>i)&&(r=i))});return[r,n]},w=function(e,i){var n,r=[];for(var o in e.Stories){n=e.Stories[o];var a=i(n);h(r,1,a,n.name,t.always(1),t.add)}for(var s=0;s<r.length;s++)r[s]?r[s].tip=s+": "+r[s].tip.join(", "):r[s]=null;return r}}e(t)}(function(e){"undefined"==typeof exports?this.statisticsAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t){e.prototype.getFilteredStoryNames=function(e,r){var o=Object.keys(this.database.Stories).sort(t.charOrdA),a=this;o=o.map(function(e){return{storyName:e,isFinished:n(a.database,e),isEmpty:i(a.database,e)}}),e&&(o=o.filter(function(e){return!e.isFinished||e.isEmpty})),r(null,o)};var i=function(e,t){return 0==e.Stories[t].events.length},n=function(e,t){return e.Stories[t].events.every(function(e){var t=!0;for(var i in e.characters)if(e.characters[i]&&!e.characters[i].ready){t=!1;break}return t})};e.prototype.getFilteredCharacterNames=function(e,i,n){var r;r=this.database.Stories[e].characters,r=Object.keys(r).sort(t.charOrdA);var s=this;r=r.map(function(t){return{characterName:t,isFinished:a(s.database,e,t),isEmpty:o(s.database,e,t)}}),i&&(r=r.filter(function(e){return!e.isFinished||e.isEmpty})),n(null,r)},e.prototype.getFilteredEventNames=function(e,t,i){var n=this.database.Stories[e].events.map(function(e,t){return{name:e.name,index:t,isFinished:r(e),isEmpty:0===Object.keys(e.characters).length}});t&&(n=n.filter(function(e){return!e.isFinished||e.isEmpty})),i(null,n)};var r=function(e){for(var t in e.characters)if(!e.characters[t].ready)return!1;return!0},o=function(e,t,i){return e.Stories[t].events.every(function(e){return!e.characters[i]})},a=function(e,t,i){return e.Stories[t].events.every(function(e){return e.characters[i]?e.characters[i].ready:!0})};e.prototype.getEvents=function(e,i,n){var r,o=t.clone(this.database.Stories[e].events).map(function(e,t){return e.index=t,e}).filter(function(e){for(r=0;r<i.length;r++)if(e.characters[i[r]])return!0;return!1});n(null,o)},e.prototype.setEventAdaptationTime=function(e,t,i,n,r){var o=this.database.Stories[e].events[t];o.characters[i].time=n,r()},e.prototype.setOriginEventText=function(e,t,i,n){var r=this.database.Stories[e].events[t];r.text=i,n()},e.prototype.setAdaptationEventText=function(e,t,i,n,r){var o=this.database.Stories[e].events[t];o.characters[i].text=n,r()},e.prototype.changeAdaptationReadyStatus=function(e,t,i,n,r){var o=this.database.Stories[e].events[t];o.characters[i].ready=n,r()}}e(t)}(function(e){"undefined"==typeof exports?this.storyAdaptationsAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype.getStoryNamesArray=function(e){e(null,Object.keys(this.database.Stories).sort(i.charOrdA))},e.prototype.getAllStories=function(e){e(null,i.clone(this.database.Stories))},e.prototype.getMasterStory=function(e,t){t(null,this.database.Stories[e].story)},e.prototype.updateMasterStory=function(e,t,i){this.database.Stories[e].story=t,i()},e.prototype.isStoryExist=function(e,t){t(null,void 0!==this.database.Stories[e])},e.prototype.createStory=function(e,t){return""===e?void t(new n.ValidationError("stories-story-name-is-not-specified")):this.database.Stories[e]?void t(new n.ValidationError("stories-story-name-already-used",[e])):(this.database.Stories[e]={name:e,story:"",characters:{},events:[]},this.ee.trigger("createStory",arguments),void t())},e.prototype.renameStory=function(e,t,i){if(""===t)return void i(new n.ValidationError("stories-story-name-is-not-specified"));if(e===t)return void i(new n.ValidationError("stories-names-are-the-same"));if(this.database.Stories[t])return void i(new n.ValidationError("stories-story-name-already-used",[t]));var r=this.database.Stories[e];r.name=t,this.database.Stories[t]=r,delete this.database.Stories[e],this.ee.trigger("renameStory",arguments),i()},e.prototype.removeStory=function(e,t){delete this.database.Stories[e],this.ee.trigger("removeStory",arguments),t()}}e(t)}(function(e){"undefined"==typeof exports?this.storyBaseAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n,r){e.prototype.getStoryCharacterNamesArray=function(e,t){var n=this.database.Stories[e].characters;t(null,Object.keys(n).sort(i.charOrdA))},e.prototype.getStoryCharacters=function(e,t){t(null,i.clone(this.database.Stories[e].characters))},e.prototype.addStoryCharacter=function(e,t,i){return""===t?void i(new n.ValidationError("stories-character-name-is-not-specified")):(this.database.Stories[e].characters[t]={name:t,inventory:"",activity:{}},void i())},e.prototype.switchStoryCharacters=function(e,t,i,r){if(""===t||""===i)return void r(new n.ValidationError("stories-one-of-switch-characters-is-not-specified"));var o=this.database.Stories[e];o.characters[i]=o.characters[t],o.characters[i].name=i,delete o.characters[t],o.events.forEach(function(e){e.characters[t]&&(e.characters[i]=e.characters[t],delete e.characters[t])}),r()},e.prototype.removeStoryCharacter=function(e,t,i){if(""===t)return void i(new n.ValidationError("stories-character-name-is-not-specified"));var r=this.database.Stories[e];delete r.characters[t],r.events.forEach(function(e){delete e.characters[t]}),i()};var o=function(e,t){var i,n,r,o=function(i){i.characters[e]&&(r=i.characters[e],i.characters[t]=r,delete i.characters[e])};for(i in this.database.Stories)n=this.database.Stories[i],n.characters[e]&&(r=n.characters[e],r.name=t,n.characters[t]=r,delete n.characters[e],n.events.forEach(o))};r.renameCharacter=r.renameCharacter||[],r.renameCharacter.push(o);var a=function(e){var t,i,n=function(t){t.characters[e]&&delete t.characters[e]};for(t in this.database.Stories)i=this.database.Stories[t],i.characters[e]&&(delete i.characters[e],i.events.forEach(n))};r.removeCharacter=r.removeCharacter||[],r.removeCharacter.push(a),e.prototype.updateCharacterInventory=function(e,t,i,n){this.database.Stories[e].characters[t].inventory=i,n()},e.prototype.onChangeCharacterActivity=function(e,t,i,n,r){var o=this.database.Stories[e].characters[t];n?o.activity[i]=!0:delete o.activity[i],r()},e.prototype.addCharacterToEvent=function(e,t,i,n){this.database.Stories[e].events[t].characters[i]={text:"",time:""},n()},e.prototype.removeCharacterFromEvent=function(e,t,i,n){delete this.database.Stories[e].events[t].characters[i],n()}}e(t)}(function(e){"undefined"==typeof exports?this.storyCharactersAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype.getStoryEvents=function(e,t){t(null,i.clone(this.database.Stories[e].events))},e.prototype.createEvent=function(e,t,i,r,o,a){if(""===t)return void a(new n.ValidationError("stories-event-name-is-not-specified"));if(""===i)return void a(new n.ValidationError("stories-event-text-is-empty"));
var s={name:t,text:i,time:"",characters:{}};r?this.database.Stories[e].events.push(s):this.database.Stories[e].events.splice(o,0,s),a()},e.prototype.moveEvent=function(e,t,i,n){i>t&&i--;var r=this.database.Stories[e].events,o=r[t];r.splice(t,1),r.splice(i,0,o),n()},e.prototype.cloneEvent=function(e,t,n){var r=this.database.Stories[e],o=r.events[t],a=i.clone(o);r.events.splice(t,0,a),n()},e.prototype.mergeEvents=function(e,t,r){var o=this.database.Stories[e];if(o.events.length===t+1)return void r(new n.ValidationError("stories-cant-merge-last-event"));var a=o.events[t],s=o.events[t+1];a.name+=s.name,a.text+=s.text;for(var h in s.characters)a.characters[h]?(a.characters[h].text+=s.characters[h].text,a.characters[h].time+=s.characters[h].time,a.characters[h].ready=!1):a.characters[h]=s.characters[h];i.removeFromArrayByIndex(o.events,t+1),r()},e.prototype.removeEvent=function(e,t,n){var r=this.database.Stories[e];i.removeFromArrayByIndex(r.events,t),n()},e.prototype.updateEventProperty=function(e,t,i,r,o){if("name"===i&&""===r.trim())return void o(new n.ValidationError("stories-event-name-is-not-specified"));if("text"===i&&""===r.trim())return void o(new n.ValidationError("stories-event-text-is-empty"));this.database.Stories[e].events[t][i]=r;o()}}e(t)}(function(e){"undefined"==typeof exports?this.storyEventsAPI=e:module.exports=e}.bind(this)),function(e){function t(e,t,i,n){e.prototype.getAllInventoryLists=function(e,t){var i=[];for(var n in this.database.Stories){var r=this.database.Stories[n];r.characters[e]&&r.characters[e].inventory&&""!==r.characters[e].inventory&&i.push({storyName:n,inventory:r.characters[e].inventory})}t(null,i)},e.prototype.getCharacterEventGroupsByStory=function(e,n){var r,o=[],a=this;Object.keys(this.database.Stories).filter(function(t){return a.database.Stories[t].characters[e]}).forEach(function(t){r=[];var n=i.clone(a.database.Stories[t].events);n.map(function(e,i){return e.index=i,e.storyName=t,e.isTimeEmpty=""===e.time,e.time=e.isTimeEmpty?a.database.Meta.date:e.time,e}).filter(function(t){return t.characters[e]}).forEach(function(e){r.push(e)}),o.push({storyName:t,events:r})}),o.sort(i.charOrdAFactory(t.prop("storyName"))),n(null,o)},e.prototype.getCharacterEventsByTime=function(e,t){var n=[],r=this;Object.keys(this.database.Stories).filter(function(t){return r.database.Stories[t].characters[e]}).forEach(function(t){var o=i.clone(r.database.Stories[t].events);n=n.concat(o.map(function(e,i){return e.index=i,e.storyName=t,e.isTimeEmpty=""===e.time,e.time=e.isTimeEmpty?r.database.Meta.date:e.time,e}).filter(function(t){return t.characters[e]}))}),n.sort(i.eventsByTime),t(null,n)},e.prototype.getEventGroupsForStories=function(e,t){var n,r=[],o=this;Object.keys(this.database.Stories).filter(function(t){return-1!==e.indexOf(t)}).forEach(function(e){n=[];var t=i.clone(o.database.Stories[e].events);t.map(function(t,i){return t.index=i,t.storyName=e,t}).forEach(function(e){n.push(e)}),r.push({storyName:e,events:n})}),t(null,r)},e.prototype.getCharactersSummary=function(e){var i=t.keys(this.database.Characters),n={};i.forEach(function(e){n[e]={active:0,follower:0,defensive:0,passive:0,totalAdaptations:0,finishedAdaptations:0,totalStories:0}}),t.values(this.database.Stories).forEach(function(e){t.values(e.characters).forEach(function(e){var i=n[e.name];i.totalStories++,t.toPairs(e.activity).forEach(function(e){e[1]===!0&&i[e[0]]++})}),e.events.forEach(function(e){t.toPairs(e.characters).forEach(function(e){var t=n[e[0]];t.totalAdaptations++,e[1].ready&&t.finishedAdaptations++})})}),t.values(n).forEach(function(e){e.completeness=Math.round(100*e.finishedAdaptations/(0!=e.totalAdaptations?e.totalAdaptations:1))}),e(null,n)}}e(t)}(function(e){"undefined"==typeof exports?this.storyViewAPI=e:module.exports=e}.bind(this)),function(e){e.data={Meta:{name:"The Lord of the Rings",date:"3019/02/27 00:00",preGameDate:"3018/01/01 00:00",description:"Film based LARP game basis. This base describes the first film from trilogy The Lord of the Rings. Timeline is taken from books.",saveTime:"Thu Dec 08 2016 04:57:04 GMT+0500 (Pakistan Standard Time)"},Characters:{Aragorn:{name:"Aragorn",Player:"Micheal",Status:"Reserved",Race:"Human",Weapon:"sword, bow, knife",Civility:"M",Outfit:"","Weight, kilos.":80,"Sing good":!0,Biography:"The last strider's leader and the first king of joined kingdoms, direct descent of Elendil's royal blood (by Isildur line).\nAragorn became the greatest human of his age. He leaded the people of west against Sauron forces. He helped to destroy the One Ring (he was one of the ring fellowship). He joined Arnor and Gondor kingdoms.","VKontakte image":"photo-17502880_426145599","Site image":"Aragorn",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Arwen:{name:"Arwen",Player:"Jade",Status:"Reserved",Race:"Elf",Weapon:"",Civility:"F",Outfit:"","Weight, kilos.":55,"Sing good":!0,Biography:"Elrond's daughter. Galadriel's granddaughter.\n","VKontakte image":"photo-17502880_426145598","Site image":"Arwen",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Bilbo:{name:"Bilbo",Player:"Jack",Status:"In discussion",Race:"Hobbit",Weapon:"sword, chestnuts",Civility:"M",Outfit:"","Weight, kilos.":73,"Sing good":!1,Biography:"Frodo's uncle.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Boromir:{name:"Boromir",Player:"Peter",Status:"In discussion",Race:"Human",Weapon:"sword, bow",Civility:"M",Outfit:"the Horn of Gondor","Weight, kilos.":90,"Sing good":!1,Biography:"The eldest son and successor of Steward of Gondor - Denethor the second and his wife Finduilas. He is a Faramir's brother.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Neutral","People of Gondor":!0,"People of Rohan":!1},Galadriel:{name:"Galadriel",Player:"Anna",Status:"Reserved",Race:"Elf",Weapon:"",Civility:"F",Outfit:"the Nenya ring","Weight, kilos.":53,"Sing good":!1,Biography:"The mightiest elven ruler in the Middle-earth after the War of Wrath. She is the ruler of Lothlórien. ","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Gandalf:{name:"Gandalf",Player:"",Status:"Open",Race:"Maiar",Weapon:"staff, magic",Civility:"M",Outfit:"the Narya ring","Weight, kilos.":82,"Sing good":!1,Biography:"Mighty wizard.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Gimli:{name:"Gimli",Player:"",Status:"Open",Race:"Dwarf",Weapon:"axe",Civility:"M",Outfit:"","Weight, kilos.":80,"Sing good":!1,Biography:"He is dwarf joined to war against Sauron.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Gollum:{name:"Gollum",Player:"",Status:"Open",Race:"Other",Weapon:"",Civility:"M",Outfit:"","Weight, kilos.":34,"Sing good":!1,Biography:'A small, slimy creature who lived on a small island in the centre of an underground lake at the roots of the Misty Mountains. He survived on cave fish, which he caught from his small boat, and small goblins who strayed too far from the stronghold of the Great Goblin. Over the years, his eyes adapted to the dark and became "lamp-like", shining with a sickly pale light.',"VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Dark","People of Gondor":!1,"People of Rohan":!1},Legolas:{name:"Legolas",Player:"",Status:"Open",Race:"Elf",Weapon:"bow, elven knifes",Civility:"M",Outfit:"","Weight, kilos.":57,"Sing good":!0,Biography:"Legolas was the son of Thranduil, King of the Woodland Realm of Northern Mirkwood.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Merry:{name:"Merry",Player:"",Status:"Open",Race:"Hobbit",Weapon:"chestnuts",Civility:"M",Outfit:"","Weight, kilos.":57,"Sing good":!0,Biography:"Frodo's friend. The fellow of the ring.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Nazgul:{name:"Nazgul",Player:"",Status:"Open",Race:"Other",Weapon:"sword",Civility:"M",Outfit:"","Weight, kilos.":0,"Sing good":!0,Biography:"They were nine men who succumbed to Sauron's power and attained near-immortality as wraiths, servants bound to the power of the One Ring and completely under the dominion of Sauron.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Dark","People of Gondor":!1,"People of Rohan":!1},Pippin:{name:"Pippin",Player:"",Status:"Open",Race:"Hobbit",Weapon:"chestnuts",Civility:"M",Outfit:"","Weight, kilos.":53,"Sing good":!0,Biography:"Frodo's friend. The fellow of the ring.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Saruman:{name:"Saruman",Player:"",Status:"Open",Race:"Maiar",Weapon:"staff, magic",Civility:"M",Outfit:"palantir","Weight, kilos.":68,"Sing good":!1,Biography:"He is leader of the Istari, wizards sent to Middle-earth in human form by the godlike Valar to challenge Sauron.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Dark","People of Gondor":!1,"People of Rohan":!1},Sauron:{name:"Sauron",Player:"",Status:"Open",Race:"Other",Weapon:"",Civility:"M",Outfit:"palantir","Weight, kilos.":1,"Sing good":!1,Biography:"He is described as the chief lieutenant of the first Dark Lord, Morgoth.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Dark","People of Gondor":!1,"People of Rohan":!1},Sam:{name:"Sam",Player:"",Status:"Open",Race:"Hobbit",Weapon:"chestnuts",Civility:"M",Outfit:"Hollow-ware","Weight, kilos.":57,"Sing good":!0,Biography:"Gardener, servant and friend of Frodo.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Frodo:{name:"Frodo",Player:"",Status:"Open",Race:"Hobbit",Weapon:"chestnuts",Civility:"M",Outfit:"","Weight, kilos.":64,"Sing good":!0,Biography:"Hobbit which became the Ring-bearer by the twist of fate.","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},Elrond:{name:"Elrond",Player:"",Status:"Open",Race:"Elf",Weapon:"",Civility:"M",Outfit:"the Vilya ring","Weight, kilos.":72,"Sing good":!1,Biography:"Elrond is a son of Eärendil and Elwing. Elrond was Lord of Rivendell, one of the mighty rulers of old that remained in Middle-earth in its Third Age. ","VKontakte image":"photo-17502880_426145597","Site image":"Question",Side:"Light","People of Gondor":!1,"People of Rohan":!1},"People of Gondor":{name:"People of Gondor",Player:"",Status:"Open",Race:"Human",Civility:"doesn't matter",Weapon:"",Outfit:"","Weight, kilos.":0,"Sing good":!1,Biography:"","VKontakte image":"photo-17502880_426145597","Site image":"",Side:"Dark","People of Gondor":!0,"People of Rohan":!1},"People of Rohan":{name:"People of Rohan",Player:"",Status:"Open",Race:"Human",Civility:"doesn't matter",Weapon:"",Outfit:"","Weight, kilos.":0,"Sing good":!1,Biography:"","VKontakte image":"photo-17502880_426145597","Site image":"",Side:"Dark","People of Gondor":!1,"People of Rohan":!0}},ProfileSettings:[{name:"Side",type:"enum",value:"Dark,Light,Neutral",doExport:!0},{name:"Player",type:"string",value:"",doExport:!0},{name:"Status",type:"enum",value:"Open,Reserved,In discussion",doExport:!0},{name:"Race",type:"enum",value:"Human,Elf,Dwarf,Orc,Hobbit,Maiar,Other",doExport:!0},{name:"Civility",type:"enum",value:"doesn't matter,M,F",doExport:!0},{name:"Weapon",type:"string",value:"",doExport:!0},{name:"Outfit",type:"string",value:"",doExport:!0},{name:"Weight, kilos.",type:"number",value:0,doExport:!0},{name:"Sing good",type:"checkbox",value:!1,doExport:!1},{name:"Biography",type:"text",value:"",doExport:!0},{name:"VKontakte image",type:"string",value:"photo-17502880_426145597",doExport:!0},{name:"Site image",type:"string",value:"",doExport:!0},{name:"People of Gondor",type:"checkbox",value:!1,doExport:!0},{name:"People of Rohan",type:"checkbox",value:!1,doExport:!0}],Stories:{"Arwen and Aragorn":{name:"Arwen and Aragorn",story:"Love story of Aragorn and Arwen. \n\n// activity\nBoth actively think about each other.\n// activity",characters:{Aragorn:{name:"Aragorn",inventory:"Evenstar",activity:{active:!0}},Arwen:{name:"Arwen",inventory:"",activity:{active:!0}}},events:[{name:"Evenstar",text:"Aragorn and Arwen. Arwen gives Aragorn her jeweled pendant - Evenstar.",time:"3018/10/25 02:00",characters:{Aragorn:{text:"",time:""},Arwen:{text:"",time:""}}}]},"The fellowship of the Ring":{name:"The fellowship of the Ring",story:"// activity\nFrodo actively moves forward.\nAll other heros follow him.\nBoromir actively think how to bring the Ring to Gondor.\nSaruman actively tries to stop the fellowship.\nElrond knows that the fellowship goes to Mount Doom.\nGaladriel waits fellowship in Lorien.\n// activity",characters:{Aragorn:{name:"Aragorn",inventory:"sheath, Elven cloak",activity:{follower:!0}},Boromir:{name:"Boromir",inventory:"golden belt, Elven cloak",activity:{follower:!0,active:!0}},Galadriel:{name:"Galadriel",inventory:"",activity:{passive:!0}},Gandalf:{name:"Gandalf",inventory:"",activity:{follower:!0}},Gimli:{name:"Gimli",inventory:"Three strands of Galadriel's hair, Elven cloak",activity:{follower:!0}},Legolas:{name:"Legolas",inventory:"Galadhrim bow, Elven cloak",activity:{follower:!0}},Merry:{name:"Merry",inventory:"silver belt, Elven cloak",activity:{follower:!0}},Pippin:{name:"Pippin",inventory:"silver belt, Elven cloak",activity:{follower:!0}},Saruman:{name:"Saruman",inventory:"",activity:{active:!0}},Sam:{name:"Sam",inventory:"small grey wooden box, Elven cloak, Elven rope",activity:{follower:!0}},Frodo:{name:"Frodo",inventory:"Phial of Galadriel, Elven cloak",activity:{active:!0}},Elrond:{name:"Elrond",inventory:"",activity:{passive:!0}}},events:[{name:"Council of Elrond",text:"Council discuss the problem of destroying the Ring. Ring can be destroyed only in the Mount Doom. Nobody can do it. Frodo takes this task. Aragorn, Legolas, Gimli, Boromir, Gandalf and his Shire friends follow him. The fellowship of the Ring is created.",time:"3018/10/25 17:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""},Elrond:{text:"",time:""}}},{name:"The earth way",text:"First way is closed by Sauron patrols.",time:"3019/01/08 13:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Saruman:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"The mountain way",text:"Saruman's magic blocks the mountain way.",time:"3019/01/12 16:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Saruman:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Moria way",text:"The fellowship goes to Moria. They awaken Watcher in the Water which destroys Moria's gate after fellowship come in. Inside fellowship find dead bodies and understand Moria is controlled by orcs.",time:"3019/01/13 18:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Moria",text:"Gandalf shows Gollum to Frodo and tells that Gollum walk with them for a long time.\nPippin accidentally drop bucket to well near Balin's grave. This sound awakes orcs and Balrog.",time:"3019/01/14 21:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Moria exit",text:"Gandalf defends the bridge from Balrog. Balrog breaks the bridge and fall down with Gandalf. The rest of fellowship goes away from Moria and go deep in Galadriel's Lorien.",time:"3019/01/15 16:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gandalf:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Galadriel's mirror",text:"Galadriel shows Frodo the future in the magic mirror.",time:"3019/02/14 21:30",characters:{Galadriel:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Leaving Lórien",text:"Lorien elves give supplies to the fellowship help to go further.",time:"3019/02/16 12:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Galadriel:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Uruk-hai",text:"Saruman sends Uruk-hai to catch the Ring-bearer.",time:"3019/01/10 00:00",characters:{Saruman:{text:"",time:""}}},{name:"Waterfall",text:"Fellowship make stop near waterfall.",time:"3019/02/25 16:00",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}},{name:"Fork",text:"Boromir tries to take the Ring from Frodo. At this moment Uruk-hai found them. They kill Boromir, take Merry and Pippin and run away to Saruman. Frodo decides to go alone but Sam goes with him. The rest of fellowship bury Boromir and run for Uruk-hai detachment.",time:"3019/02/26 17:20",characters:{Aragorn:{text:"",time:""},Boromir:{text:"",time:""},Gimli:{text:"",time:""},Legolas:{text:"",time:""},Merry:{text:"",time:""},Pippin:{text:"",time:""},Sam:{text:"",time:""},Frodo:{text:"",time:""}}}]},"Saruman's story":{name:"Saruman's story",story:"// activity\nSauron and Saruman actively work on their dark plans. \n// activity\n\nSaruman creates orc army and Uruk-hai.",characters:{Saruman:{name:"Saruman",inventory:"",activity:{active:!0}},Sauron:{name:"Sauron",inventory:"",activity:{active:!0}}},events:[{name:"Destroying grove",text:"Saruman creates orcs and gives order to destroy grove nearby Orthanc. Also he creates Uruk-hais.",time:"3018/07/13 18:00",characters:{Saruman:{text:"",time:""},Sauron:{text:"",time:""}}}]},"Journey begins":{name:"Journey begins",story:"// activity\nGandalf actively search the Ring information.\nGandalf sends Frodo to Bree. Frodo runs away from nazguls (defence).\nSam, Merry and Pippin follows Frodo.\nSaruman actively catches Gandalf. Gandalf actively running away.\nAragorn passively waits hobbits in Bree. After that he defends them.\nNazguls actively search hobbits.\nSauron passively waits when Frodo puts the Ring on to find him. Arwen actively saves Frodo from nazguls.\nElrond passively waits Frodo to cure him.\n// activity\n\nDuring another one birthday Bilbo make a festive occasion and mysteriously disappered. He leaves all his things to nephew - Frodo. And the unknown Ring too.\n\nGandalf feels black magic in the Ring so he goes to Minas Tirith to find more information.\n\nSauron takes information from Gollum who is the Ring bearer and sends nazguls to catch him. \n\nGandalf goes back to Shire to warn Frodo. Ancient evil is awaken and black knights are on the way. Gandalf checks the Ring and it is that ring. Gandalf sends Frodo to Bree to the Prancing Pony tavern. Sam listens all this conversation so he was added to party.\n\nGandalf goes to Saruman to discuss the plan. But Saruman already falls into the dark side.\n\nGoing from Shire Frodo and Sam meets Merry and Pippin which stole vegetables. Suddenly nazguls go near them. All hobbits run away from nazguls.\n\nHobbit party goes to Bree and finds the Prancing Pony. They don't find Gandalf there. Accidentally Frodo put the Ring on. Strider sees this. Strider explains he is a friend and take hobbits to other longing.\n\nNazguls goes to the Prancing Pony into the night. They break everything hobbit room but there are no hobbits.\n\nNazguls catch hobbits in Amon Sul. One of them wounded Frodo. Strider beats off the nazguls. Arwen finds them and takes wounded Frodo to Rivendell running from nazguls.\n\nArwen brings Frodo to Rivendell. Nazguls can't get across the river the Rivendell boundary.\n\nFrodo is cured. Frodo meets Bilbo and gets the last inherit. The sword and the Dwarven mail.",characters:{Aragorn:{name:"Aragorn",inventory:"",activity:{passive:!0,follower:!0}},Arwen:{name:"Arwen",inventory:"",activity:{active:!0}},Bilbo:{name:"Bilbo",inventory:"",activity:{passive:!0}},Gandalf:{name:"Gandalf",inventory:"",activity:{active:!0}},Merry:{name:"Merry",inventory:"",activity:{follower:!0}},Nazgul:{name:"Nazgul",inventory:"",activity:{active:!0}},Pippin:{name:"Pippin",inventory:"",activity:{follower:!0}},Saruman:{name:"Saruman",inventory:"",activity:{active:!0}},Sauron:{name:"Sauron",inventory:"",activity:{passive:!0}},Sam:{name:"Sam",inventory:"",activity:{follower:!0}},Frodo:{name:"Frodo",inventory:"the Ring, Sting, Dwarven mail",activity:{defensive:!0}},Elrond:{name:"Elrond",inventory:"",activity:{passive:!0}}},events:[{name:"Bilbo's birthday",text:"During another one birthday Bilbo make a festive occasion and mysteriously disappered. He leaves all his things to nephew - Frodo. And the unknown Ring too.",time:"3001/09/22 21:00",characters:{Bilbo:{text:"So I live a long life. So I think my age is near over. Thats why I go to elves after my birthday. But I think speech disappearing wasn't brilliant idea. Seems the Ring goes to my finger itself.",time:"September 22, 3001",ready:!0},Gandalf:{text:"I always know Bilbo is unusual hobbit. I don't like his last disappearing joke in birthday but he has the heart and energy to go to elves.",time:"September 22, 3001",ready:!0},Merry:{text:"Old man Bilbo made a wonderful party on his 111 birthday. Then he just disappeared from stage during his speech. Nobody understand what happens. And nobody see Bilbo in Shire anymore. Bilbo left all his things to Frodo.",time:"September 22, 3001",ready:!0},Pippin:{text:"Old man Bilbo made a wonderful party on his 111 birthday. Then he just disappeared from stage during his speech. Nobody understand what happens. And nobody see Bilbo in Shire anymore. Bilbo left all his things to Frodo.",time:"September 22, 3001",ready:!0},Sam:{text:"Old man Bilbo made a wonderful party on his 111 birthday. Then he just disappeared from stage during his speech. Nobody understand what happens. And nobody see Bilbo in Shire anymore. Bilbo left all his things to Frodo.",time:"September 22, 3001",ready:!0},Frodo:{text:"Old man Bilbo made a wonderful party on his 111 birthday. Then he just disappeared from stage during his speech. Nobody understand what happens. And nobody see Bilbo in Shire anymore. He give all his things to me including strange ring which he never left before.",time:"September 22, 3001",ready:!0}}},{name:"Gandalf's suspicions",text:"Gandalf feels black magic in the Ring so he goes to Minas Tirith to find more information.",time:"3001/09/23 12:00",characters:{Bilbo:{text:"So much time I tell myself - don't listen Gandalf. But he persuades me again. Thats why I left my precious ring to Frodo. Oh, how it lives without me?",time:"September 23, 3001",ready:!0},Gandalf:{text:"I'm worry about Bilbo's ring. It has powerful magic and he was so attached to the ring. It was very hard to persuade him to leave the ring to Frodo. I need to know more about this ring.",time:"September 23, 3001",ready:!0},Frodo:{text:"Usually I carry the Bilbo's Ring but don't use it. Generally life goes further. Gandalf goes away somewhere.",time:"September 23, 3001",ready:!0}}},{name:"Nazguls",text:"Sauron takes information from Gollum who is the Ring bearer and sends nazguls to catch him. ",time:"3018/03/02 15:00",characters:{Nazgul:{text:"Overlord sends us to Shire. We need to find the Ring-bearer and take the Ring.",time:"March 2, 3018",ready:!0},Sauron:{text:"This beast tells us about the Ring bearer. This is some hobbit from Shire so I send nazguls to find him. By the way, who are hobbits?",time:"March 2, 3018",ready:!0}}},{name:"Frodo's journey begin",text:"Gandalf goes back to Shire to warn Frodo. Ancient evil is awaken and black knights are on the way. Gandalf checks the Ring and it is that ring. Gandalf sends Frodo to Bree to the Prancing Pony tavern. Sam listens all this conversation so he was added to party.",time:"3018/04/13 20:00",characters:{Gandalf:{text:"In Minas Tirith I found that it can be the Sauron Ring. I went back to Shire. Unfortunately the ring check gives us the answer. There were fire letters on the Ring surface after throwing ring into the fire. I hear stories about black knights near the Shire. I sended Frodo to Bree. I hope I will be there in the same time. I need to have talk with Saruman. Sam heard our talk and I didn't want to send Frodo alone. I think Frodo needs somebody to remind him about home and resist to the Ring. Sam got a scolding for it. I'm sure he will do task well.",time:"April 4, 3018",ready:!0},Sam:{text:"It was a late night. I cut bushes near open window and suddenly heard Frodo and Gandalf talk. Gangalf's voice was very strained so I decided to listen carefully. I understand that Bilbo's Ring is real and it is very unusual and Sauron search it and it is actually not die. I listen so careful that forgot about cutting. And Gandalf pay attention that scissors are not clanking. He caught me and I tell about everything. So he sended me with Frodo to Bree.",time:"April 4, 3018",ready:!0},Frodo:{text:"I went home and found agitated Gandalf. He asked me to get Bilbo's ring and throw it to the fire. I was surprised but the Ring was cold and there were some strange letters. Gandalf said the only one Ring has such properties - the Sauron Ring. And now Sauron is not dead. He is growing in strength and search for the Ring. He sended black knights for me and I need to run. Sam listened our talk so Gandalf sended Sam with me. We go to Bree. Gandalf will meet us there.",time:"April 4, 3018",ready:!0}}},{name:"Saruman captures Gandalf",text:"Gandalf goes to Saruman to discuss the plan. But Saruman already falls into the dark side.",time:"3018/07/10 16:00",characters:{Gandalf:{text:"I came to Saruman to discuss our actions. But as it happens Saruman is on the one side with Sauron. He caught me and lock on the Orthanc roof. Miraculously the eagle saved me. I can't be in Bree in time.",time:"July 10, 3018",ready:!0},Saruman:{text:"I see infinite darkness in palantir and I see this is my way. Gandalf's visit was not surprise. The overlord ordered to join Gandalf to us. But Gandalf find how to run away. So much the worse for him.",time:"July 10, 3018",ready:!0}}},{name:"Merry and Pippin",text:"Going from Shire Frodo and Sam meets Merry and Pippin which stole vegetables. Suddenly nazguls go near them. All hobbits run away from nazguls.",time:"3018/04/17 13:00",characters:{Merry:{text:"I and Pippin run away from angry farmer by the field and suddenly meet Frodo and Sam. They run with us. I don't think farmer will examine who is not guilty. We escaped from farmer and found the road and suddenly feel cold. We hide nearby and at this moment see the black rider. Frodo tells that there are several riders which search him and they go to Bree as fast as possible. We joined their company.",time:"April 17, 3018",ready:!0},Pippin:{text:"I and Merry run away from angry farmer by the field and suddenly meet Frodo and Sam. They run with us. I don't think farmer will examine who is not guilty. We escaped from farmer and found the road and suddenly feel cold. We hide nearby and at this moment see the black rider. Frodo tells that there are several riders which search him and they go to Bree as fast as possible. We joined their company.",time:"April 17, 3018",ready:!0},Sam:{text:"Pippin and Merry as usual run away from angry farmer by the field and suddenly meet us. We run with them. I don't think farmer will examine who is not guilty. We escaped from farmer and found the road and suddenly feel cold. We hide nearby and at this moment see the black rider. Frodo told that there are several riders which search him and we go to Bree as fast as possible. Merry and Pippin joined to our company.",time:"April 17, 3018",ready:!0},Frodo:{text:"Pippin and Merry run away from angry farmer by the field and suddenly meet us. We run with them. I don't think farmer will examine who is not guilty. We escaped from farmer and found the road and suddenly feel cold. We hide nearby and at this moment see the black rider. I told that there are several riders which search me and we go to Bree. Merry and Pippin joined to our company.",time:"April 17, 3018",ready:!0}}},{name:"the Prancing Pony",text:"Hobbit party goes to Bree and finds the Prancing Pony. They don't find Gandalf there. Accidentally Frodo put the Ring on. Strider sees this. Strider explains he is a friend and take hobbits to other longing.",time:"3018/09/30 20:00",characters:{Aragorn:{text:"Hobbits company came to Bree. Hobbits are so awkward. I knew that they will come but I decided to wait a bit. Too bad I didn't come at once - Frodo bering the Ring in the hall centre. Now Sauron and nazguls definitely knows where to search them. One way or another I introduced myself took hobbits to other longing. It is obvious nazguls will visit the Prancing Pony this night.",time:"September 30, 3018",ready:!0},Merry:{text:"We came to the Prancing Pony. There was no Gangalf. We didn't know what to do and decided to stay overnight. Suddenly Frodo felt sick and disappeared the same way as Bilbo in birthday. We didn't understand what happen. We tried to find Frodo without success. Suddenly we saw human going away with Frodo. We went for him and prepare to fight. It emerged that this is Strider, Gandalf's friend and he will guard us. Strider said it is dangerous to stay overnight in the Prancing Pony so he lead us to other longing.",time:"September 30, 3018",ready:!0},Pippin:{text:"We came to the Prancing Pony. There was no Gangalf. We didn't know what to do and decided to stay overnight. Suddenly Frodo felt sick and disappeared the same way as Bilbo in birthday. We didn't understand what happen. We tried to find Frodo without success. Suddenly we saw human going away with Frodo. We went for him and prepare to fight. It emerged that this is Strider, Gandalf's friend and he will guard us. Strider said it is dangerous to stay overnight in the Prancing Pony so he lead us to other longing.",time:"September 30, 3018",ready:!0},Sam:{text:"We came to the Prancing Pony. There was no Gangalf. We didn't know what to do and decided to stay overnight. Suddenly Frodo felt sick and disappeared the same way as Bilbo in birthday. We didn't understand what happen. We tried to find Frodo without success. Suddenly we saw human going away with Frodo. We went for him and prepare to fight. It emerged that this is Strider, Gandalf's friend and he will guard us. Strider said it is dangerous to stay overnight in the Prancing Pony so he lead us to other longing.",time:"September 30, 3018",ready:!0},Frodo:{text:"We came to the Prancing Pony. There was no Gangalf. We didn't know what to do and decided to stay overnight. Suddenly I felt irresistible desire to bear the Ring and did it. The world loose all colours. There were only shadows instead people. And among everything the big fire eye look at me. Horror stricken I slipped the ring off finger. Nobody looked at me. Thats why I think everything is good but suddenly human grabbed me and take away to internal rooms. It was a Strider a Gandalf's friend. He met us. He was very angry at me that I bering the ring. Sauron has eyes and ears everywhere. My friends tried to save me from Strider but I explain them he is a friend. Strider said it is dangerous to stay overnight in the Prancing Pony so he lead us to other longing.",
time:"September 30, 3018",ready:!0}}},{name:"Night attack",text:"Nazguls goes to the Prancing Pony into the night. They break everything hobbit room but there are no hobbits.",time:"3018/09/31 04:00",characters:{Aragorn:{text:"We heard strange sounds and screams from the Prancing Pony. In the morning hobbits room was upside down and beds were pierced with swords. This time nazguls made a mistake. We need to go away from Bree.",time:"October 1, 3018",ready:!0},Merry:{text:"We heard strange sounds and screams from the Prancing Pony. In the morning hobbits room was upside down and beds were pierced with swords. I'm very scared but I need to go with Frodo. He is in a big danger.",time:"October 1, 3018",ready:!0},Nazgul:{text:"We went to tavern in the night. There were hobbits which we searched for. But there were no one in their room. We will happily kill everybody in this city but Strider is nearby and only he can interferes. We have time. We will wait when hobbit bering the ring and show himself.",time:"October 1, 3018",ready:!0},Pippin:{text:"We heard strange sounds and screams from the Prancing Pony. In the morning hobbits room was upside down and beds were pierced with swords. I'm very scared but I need to go with Frodo. He is in a big danger.",time:"October 1, 3018",ready:!0},Sam:{text:"We heard strange sounds and screams from the Prancing Pony. In the morning hobbits room was upside down and beds were pierced with swords. I'm very scared but I need to go with Frodo. He is in a big danger.",time:"October 1, 3018",ready:!0},Frodo:{text:"We heard strange sounds and screams from the Prancing Pony. In the morning hobbits room was upside down and beds were pierced with swords. I'm very scared but we need to go. The Ring is my burden. Nobody can do this except me.",time:"October 1, 3018",ready:!0}}},{name:"Amon Sûl",text:"Nazguls catch hobbits in Amon Sul. One of them wounded Frodo. Strider beats off the nazguls. Arwen finds them and takes wounded Frodo to Rivendell running from nazguls.",time:"3018/10/04 03:30",characters:{Aragorn:{text:"I went to patrol for nothing. Nazguls stole by me. I drove them away hardly but they wounded Frodo. I could save him. Arwen came unexpectedly. She took Frodo from me. I hope black riders will not overtake them on the Rivendell way.",time:"October 4, 3018",ready:!0},Arwen:{text:"I felt cold and pain and run to this place. Strider just drove nazguls away from hobbits. The ring-bearer was wounded. The only hope was my horse. We rode to Rivendell as far as we can.",time:"October 4, 3018",ready:!0},Merry:{text:"Strider went to patrol. Suddenly nazguls surrounded us. We tried to fight but they just throw us. They wounded me and finally Strider came back. Strider drove out nazguls. He tended to wound but suddenly we saw elven woman. So Rivendell was not far away. She took Frodo and rode to Rivendell. I hope Frodo will be fine.",time:"October 4, 3018",ready:!0},Nazgul:{text:"We surrounded hobbits. We felt the Ring power. And Strider came back. He countered an attack. We wounded the Ring bearer. He hadn't much time. Suddenly elven woman appered...",time:"October 4, 3018",ready:!0},Pippin:{text:"Strider went to patrol. Suddenly nazguls surrounded us. We tried to fight but they just throw us. They wounded me and finally Strider came back. Strider drove out nazguls. He tended to wound but suddenly we saw elven woman. So Rivendell was not far away. She took Frodo and rode to Rivendell. I hope Frodo will be fine.",time:"October 4, 3018",ready:!0},Sam:{text:"Strider went to patrol. Suddenly nazguls surrounded us. We tried to fight but they just throw us. They wounded me and finally Strider came back. Strider drove out nazguls. He tended to wound but suddenly we saw elven woman. So Rivendell was not far away. She took Frodo and rode to Rivendell. I hope Frodo will be fine.",time:"October 4, 3018",ready:!0},Frodo:{text:"Strider went to patrol. Suddenly nazguls surrounded us. We tried to fight but they just throw us. They wounded me and finally Strider came back. Strider drove out nazguls. He tended to wound but suddenly we saw elven woman. So Rivendell was not far away. She took me to Rivendell.",time:"October 4, 3018",ready:!0}}},{name:"Rivendell",text:"Arwen brings Frodo to Rivendell. Nazguls can't get across the river the Rivendell boundary.",time:"3018/10/20 15:00",characters:{Aragorn:{text:"We went to Rivendell as far as we can. Fortunately Arwen successfully brought Frodo to Rivendell. We saw dead rider horses down the river. For some time nazguls will not bother us. Elves gave us a shelter. Gandalf is already in Rivendell. Elrond will heal Frodo. We will wait and when Frodo will be fine we will make the Ring council.",time:"October 20, 3018",ready:!0},Arwen:{text:"I took Frodo and fortunately we came across the boundary river in time. Black riders tried to go across the river and river sweep them. For some time they will not bother Frodo. Father healed Frodo but nazgul's wounds can't be healed completely.",time:"October 20, 3018",ready:!0},Bilbo:{text:"I heard my nephew with several friends came to Rivendell. Brave guys. I hope Frodo visit me. Perhaps his journey only begin and couple items... are not very useful for me so I will give it to him. I'm already in Rivendell. What a wonderful land.",time:"October 20, 3018",ready:!0},Gandalf:{text:"Arwen saved Frodo. I will heal him but it take some time. Now we sure black riders can't find way into Rivendell. Saruman left our side. Orthanc is orcs land now and nobody knows how strong Saruman's black magic is. Soon we will make the Ring council and decide what we can do.",time:"October 20, 3018",ready:!0},Merry:{text:"We went to Rivendell as far as we can. Fortunately Arwen successfully brought Frodo to Rivendell. We saw dead rider horses down the river. For some time nazguls will not bother us. Elves gave us a shelter. Gandalf is already in Rivendell. Elrond will heal Frodo. We will wait for Frodo healing.",time:"October 20, 3018",ready:!0},Nazgul:{text:"Elf brought Frodo to Rivendell. We can't find the way into the Rivendell. Ancient magic is still alive. The Lord ordered to come back to Mordor. We will know what to do next there.",time:"October 20, 3018",ready:!0},Pippin:{text:"We went to Rivendell as far as we can. Fortunately Arwen successfully brought Frodo to Rivendell. We saw dead rider horses down the river. For some time nazguls will not bother us. Elves gave us a shelter. Gandalf is already in Rivendell. Elrond will heal Frodo. We will wait for Frodo healing.",time:"October 20, 3018",ready:!0},Sam:{text:"We went to Rivendell as far as we can. Fortunately Arwen successfully brought Frodo to Rivendell. We saw dead rider horses down the river. For some time nazguls will not bother us. Elves gave us a shelter. Gandalf is already in Rivendell. Elrond will heal Frodo. We will wait for Frodo healing.",time:"October 20, 3018",ready:!0},Frodo:{text:"I didn't remember how I came to Rivendell. I came to life already here. All my followers are in Rivendell too.",time:"October 20, 3018",ready:!0},Elrond:{text:"Arwen saved Frodo. I will heal him but it take some time. Now we sure black riders can't find way into Rivendell. Soon we will make the Ring council and decide what we can do.",time:"October 20, 3018",ready:!0}}},{name:"the Ring in Revendell",text:"Frodo is cured. Frodo meets Bilbo and gets the last inherit. The sword and the Dwarven mail.",time:"3018/12/24 16:00",characters:{Bilbo:{text:"Frodo visited me and I gave the last part of inheritance - sword and mail. Sword and mail served me well. Now they will serve Frodo. When I saw the Ring I asked Frodo to give it to me for a second but he hide it. I became angry and again quiet very fast. I don't know what happen with me.",time:"December 24, 3018",ready:!0},Frodo:{text:"I visited Bilbo in Rivendell. He is looking very old now. Bilbo gave me his sword and mail - magic items. I don't want to try them in action but it is better to have it. Bilbo asked to to show the Ring and suddenly became angry when I refused. He changed so quickly and became quiet again in a second. Now I know how what is the Ring stamp on the Ring-bearer which holds it too much time.",time:"December 24, 3018",ready:!0}}}]}},Settings:{BriefingPreview:{characterName:"Aragorn"},Stories:{storyName:"The fellowship of the Ring"},CharacterProfile:{characterName:"People of Gondor"},Events:{storyName:"Journey begins",characterNames:["Aragorn","Arwen","Bilbo","Elrond","Frodo","Gandalf","Merry","Nazgul","Pippin","Sam","Saruman","Sauron"],eventIndexes:[],selectedFilter:"adaptationFilterByCharacter"},GroupProfile:{groupName:"People of Gondor"}},Version:"0.5.2",Log:[["user","Mon Aug 01 2016 01:11:26 GMT+0500 (Pakistan Standard Time)","getDatabase","[]"],["user","Thu Dec 08 2016 04:35:38 GMT+0500 (Pakistan Standard Time)","createCharacter",'["People of Gondor"]'],["user","Thu Dec 08 2016 04:35:45 GMT+0500 (Pakistan Standard Time)","createCharacter",'["People of Rohan"]'],["user","Thu Dec 08 2016 04:36:48 GMT+0500 (Pakistan Standard Time)","createProfileItem",'["Side","enum","_",true,11]'],["user","Thu Dec 08 2016 04:36:57 GMT+0500 (Pakistan Standard Time)","moveProfileItem","[11,0]"],["user","Thu Dec 08 2016 04:37:17 GMT+0500 (Pakistan Standard Time)","updateDefaultValue",'["Side","Dark,Light,Neutral"]'],["user","Thu Dec 08 2016 04:37:34 GMT+0500 (Pakistan Standard Time)","createProfileItem",'["People of Gondor","checkbox",false,true,12]'],["user","Thu Dec 08 2016 04:37:39 GMT+0500 (Pakistan Standard Time)","createProfileItem",'["People of Rohan","checkbox",false,true,13]'],["user","Thu Dec 08 2016 04:40:42 GMT+0500 (Pakistan Standard Time)","createGroup",'["People of Gondor"]'],["user","Thu Dec 08 2016 04:40:52 GMT+0500 (Pakistan Standard Time)","createGroup",'["People of Rohan"]'],["user","Thu Dec 08 2016 04:41:02 GMT+0500 (Pakistan Standard Time)","createGroup",'["Neutrals"]'],["user","Thu Dec 08 2016 04:41:06 GMT+0500 (Pakistan Standard Time)","createGroup",'["Elves"]'],["user","Thu Dec 08 2016 04:41:17 GMT+0500 (Pakistan Standard Time)","createGroup",'["Light side"]'],["user","Thu Dec 08 2016 04:41:22 GMT+0500 (Pakistan Standard Time)","createGroup",'["Dark side"]'],["user","Thu Dec 08 2016 04:42:03 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["People of Gondor",[{"type":"checkbox","name":"profile-People of Gondor","selectedOptions":{"true":true}}]]'],["user","Thu Dec 08 2016 04:42:33 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["People of Rohan",[{"type":"checkbox","name":"profile-People of Rohan","selectedOptions":{"true":true}}]]'],["user","Thu Dec 08 2016 04:42:43 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["Neutrals",[{"type":"enum","name":"profile-Side","selectedOptions":{"Neutral":true}}]]'],["user","Thu Dec 08 2016 04:43:19 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["Light side",[{"type":"enum","name":"profile-Side","selectedOptions":{"Light":true}}]]'],["user","Thu Dec 08 2016 04:43:36 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["Dark side",[{"type":"enum","name":"profile-Side","selectedOptions":{"Dark":true}}]]'],["user","Thu Dec 08 2016 04:43:47 GMT+0500 (Pakistan Standard Time)","saveFilterToGroup",'["Elves",[{"type":"enum","name":"profile-Side","selectedOptions":{"Light":true}},{"type":"enum","name":"profile-Race","selectedOptions":{"Elf":true}}]]'],["user","Thu Dec 08 2016 04:47:35 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["Dark side"]'],["user","Thu Dec 08 2016 04:47:38 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["Elves"]'],["user","Thu Dec 08 2016 04:47:41 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["Light side"]'],["user","Thu Dec 08 2016 04:47:46 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["Neutrals"]'],["user","Thu Dec 08 2016 04:47:50 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["People of Gondor"]'],["user","Thu Dec 08 2016 04:47:54 GMT+0500 (Pakistan Standard Time)","addBoardGroup",'["People of Rohan"]'],["user","Thu Dec 08 2016 04:48:08 GMT+0500 (Pakistan Standard Time)","createResource",'["Mines of Moria"]'],["user","Thu Dec 08 2016 04:48:20 GMT+0500 (Pakistan Standard Time)","createResource",'["The One Ring"]'],["user","Thu Dec 08 2016 04:48:35 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Dark side","resource-The One Ring","Controls"]'],["user","Thu Dec 08 2016 04:48:48 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Gondor","resource-The One Ring","Want to use"]'],["user","Thu Dec 08 2016 04:49:03 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Dark side","group-Light side","Want destroy"]'],["user","Thu Dec 08 2016 04:49:08 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Light side","group-Dark side","Want destroy"]'],["user","Thu Dec 08 2016 04:49:25 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Dark side","group-Neutrals","Want to enslave"]'],["user","Thu Dec 08 2016 04:49:36 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Light side","group-Neutrals","Want to join"]'],["user","Thu Dec 08 2016 04:49:49 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Elves","group-Light side","Directs"]'],["user","Thu Dec 08 2016 04:50:19 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Light side","resource-The One Ring","Want to destroy"]'],["user","Thu Dec 08 2016 04:50:46 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Rohan","group-People of Gondor","ally"]'],["user","Thu Dec 08 2016 04:50:51 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Gondor","group-People of Rohan","ally"]'],["user","Thu Dec 08 2016 04:51:49 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Rohan","group-Light side","incline"]'],["user","Thu Dec 08 2016 04:51:55 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Gondor","group-Light side","incline"]'],["user","Thu Dec 08 2016 04:52:16 GMT+0500 (Pakistan Standard Time)","setEdgeLabel",'["group-Dark side","resource-The One Ring","Want to get"]'],["user","Thu Dec 08 2016 04:52:24 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Dark side","resource-Mines of Moria","Controls"]'],["user","Thu Dec 08 2016 04:52:54 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-People of Gondor","resource-Mines of Moria","Want to capture"]'],["user","Thu Dec 08 2016 04:53:21 GMT+0500 (Pakistan Standard Time)","addEdge",'["group-Neutrals","resource-The One Ring","Want to use"]'],["user","Thu Dec 08 2016 04:53:34 GMT+0500 (Pakistan Standard Time)","removeEdge",'["group-People of Gondor","resource-The One Ring"]'],["user","Thu Dec 08 2016 04:53:36 GMT+0500 (Pakistan Standard Time)","setEdgeLabel",'["group-People of Gondor","resource-The One Ring","Want to use"]']],Groups:{"People of Gondor":{name:"People of Gondor",masterDescription:"",characterDescription:'During the first millennium of the Third Age, Gondor was victorious in war and its wealth and power grew. After Sauron\'s defeat, Gondor watched over Mordor. In T.A. 490, Gondor\'s centuries-old peace was ended by the first of many Easterling invasions.[1] That war lasted into the following century, and from it Gondor conquered much territory in Rhûn north of Mordor.\n\nUnder the rule of the four "Ship-Kings", Gondor established a powerful navy and extended along the coast from the Mouths of Anduin. In 933,[1] Gondor captured the southern port city Umbar, formerly held by the hostile Black Númenóreans. Later, the Haradrim defeated Gondor on land and besieged Umbar; but King Hyarmendacil I strengthened his army and navy, and forced the kings of Harad to submit after a great victory in T.A. 1050.\n\nGondor reached its peak during the reign of Hyarmendacil, controlling a vast territory and holding suzerainty over neighbouring nations such as the Haradrim and the northern Men of the Vales of Anduin. Mordor was desolate and guarded by fortresses. Under Hyarmendacil I\'s successor, Atanatar the Glorious, The kingdom enjoyed such wealth and splendour that, according to The Lord of the Rings, "men said precious stones are pebbles in Gondor for children to play with".[4]',filterModel:[{type:"checkbox",name:"profile-People of Gondor",selectedOptions:{"true":!0}}],doExport:!0},"People of Rohan":{name:"People of Rohan",masterDescription:"",characterDescription:"In the thirteenth century of the Third Age (T.A.), the Kings of Gondor made close alliances with the Northmen of Rhovanion, a people said in The Lord of the Rings to be akin to the Three Houses of Men (later the Dúnedain) from the First Age.\n\nIn the twenty-first century, a remnant tribe of such Northmen calling itself the Éothéod moved from the valleys of Anduin to the north west of Mirkwood, clearing out what remained of the recently defeated witch kingdom of Angmar, east of the Misty Mountains. While there, some dispute arose between them and the Dwarves over the treasure-hoard of Scatha the dragon.\n\nLater, in 2509, Cirion the Steward of Gondor sent summons to the Éothéod for aid in throwing off a combined invasion of Men from the north east of Middle-earth, and Orcs from Mordor.\n\nEorl the Young, king of the Éothéod, answered the summons, and arrived unexpected at a decisive battle at the Field of Celebrant, routing the orc army, and then destroying it as it fled.\n\nAs a reward, Eorl was given the plains of Calenardhon, and he moved his kingdom there. This land had earlier been part of Gondor proper, but had been devastated by the plague of 1636, and the survivors to a large extent slain in the invasion mentioned above.",filterModel:[{type:"checkbox",name:"profile-People of Rohan",selectedOptions:{"true":!0}}],doExport:!0},Neutrals:{name:"Neutrals",masterDescription:"They have choice and they don't do it yet.",characterDescription:"",filterModel:[{type:"enum",name:"profile-Side",selectedOptions:{Neutral:!0}}],doExport:!0},Elves:{name:"Elves",masterDescription:"Our way is Valinor.",characterDescription:"",filterModel:[{type:"enum",name:"profile-Side",selectedOptions:{Light:!0}},{type:"enum",name:"profile-Race",selectedOptions:{Elf:!0}}],doExport:!0},"Light side":{name:"Light side",masterDescription:"Want to destroy Sauron and his harm to Middle-earth.",characterDescription:"",filterModel:[{type:"enum",name:"profile-Side",selectedOptions:{Light:!0}}],doExport:!0},"Dark side":{name:"Dark side",masterDescription:"Want to control Arda.",characterDescription:"",filterModel:[{type:"enum",name:"profile-Side",selectedOptions:{Dark:!0}}],doExport:!0}},InvestigationBoard:{groups:{"Dark side":{name:"Dark side",notes:""},Elves:{name:"Elves",notes:""},"Light side":{name:"Light side",notes:""},Neutrals:{name:"Neutrals",notes:""},"People of Gondor":{name:"People of Gondor",notes:""},"People of Rohan":{name:"People of Rohan",notes:""}},resources:{"Mines of Moria":{name:"Mines of Moria"},"The One Ring":{name:"The One Ring"}},relations:{"group-Dark side":{"resource-The One Ring":"Want to get","group-Light side":"Want destroy","group-Neutrals":"Want to enslave","resource-Mines of Moria":"Controls"},"group-Elves":{"group-Light side":"Directs"},"group-Light side":{"group-Dark side":"Want destroy","group-Neutrals":"Want to join","resource-The One Ring":"Want to destroy"},"group-Neutrals":{"resource-The One Ring":"Want to use"},"group-People of Gondor":{"group-People of Rohan":"ally","group-Light side":"incline","resource-Mines of Moria":"Want to capture"},"group-People of Rohan":{"group-People of Gondor":"ally","group-Light side":"incline"}}},Relations:{Aragorn:{Gandalf:"My respect.",Arwen:"My shiny."},Arwen:{Aragorn:"My tiger."},Sauron:{Aragorn:"You wil not be a king. You wil not be a king. You wil not be a king. You wil not be a king. You wil not be a king. You wil not be a king. You wil not be a king. You wil not be a king."}}}}("undefined"==typeof exports?this.BaseExample={}:exports);var defaultLang="en";