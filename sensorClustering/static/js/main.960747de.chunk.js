(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(e){e.exports=[{x:200,y:150,startX:300,startY:350,rx:100,ry:100,moveDirection:1,speed:1,id:"Max",color:"blue"},{x:200,y:150,startX:300,startY:350,rx:200,ry:100,moveDirection:1,speed:1,id:"Ghost",color:"grey"},{x:0,y:0,startX:500,startY:400,rx:125,ry:75,speed:2,moveDirection:-1,id:"Bob",color:"green"},{x:0,y:0,startX:300,startY:150,rx:50,ry:150,moveDirection:1,speed:3,id:"Sue",color:"red"}]},44:function(e,t,a){e.exports=a(89)},49:function(e,t,a){},50:function(e,t,a){},59:function(e,t,a){},61:function(e,t,a){},62:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},82:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(37),l=a.n(r),c=(a(49),a(15)),i=a(10),u=a(2),s=a(1),m=a(6),d=a(4),g=a(5),h=(a(50),a(31)),p=a.n(h),b=a(17),f=a.n(b),v=a(19),y=a(28),E=(a(59),a(99)),k=a(32),C=a(97),F={linear:function(e){return e},quad:function(e){return Math.pow(e,2)}};F.poly=C.a(function(e,t){return Math.pow(t,e)}),F.circ=function(e){return 1-Math.sin(Math.acos(e))},F.back=C.a(function(e,t){return Math.pow(t,2)*((e+1)*t-e)}),F.bounce=function(e){for(var t=0,a=1;;t+=a,a/=2)if(e>=(7-4*t)/11)return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(a,2)},F.elastic=function(e,t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*e/3*t)},F.makeEaseOut=function(e){return function(t){return 1-e(1-t)}},F.makeEaseInOut=function(e){return function(t){return t<.5?e(2*t)/2:(2-e(2*(1-t)))/2}};var B=function(e){var t=performance.now(),a={enable:!0};return requestAnimationFrame(function n(o){if(a.enable){var r=(o-t)/e.duration;r>1&&(r=1);var l=e.timing(r);e.draw(l),r<1?requestAnimationFrame(n):e.loop&&(t+=e.duration,requestAnimationFrame(n))}}),a},w=a(42),P=a(39),x=a.n(P),O=a(95),j=a(98),A=a(100),S=a(93);function D(e){return function(e){var t=O.a(e.map(E.a("volume"))),a=e.reduce(function(e,t){return e[0]+=t.x*t.volume,e[1]+=t.y*t.volume,e},[0,0]);return{x:a[0]/t,y:a[1]/t,volume:t}}(j.a(e.map(function(e){return e.map(function(e){return Object(i.a)({},M(e))})})))}function M(e){var t=A.a(e),a=S.a(e);return{x:a[0],y:a[1],volume:t}}var I=function(e){return e?e.map(function(e){return e.join(",")}).join(" "):""},N=function(e,t){var a=e.x,n=e.y,o=t.x,r=t.y;return Math.sqrt((o-a)*(o-a)+(r-n)*(r-n))},U=function(e,t){return x.a.intersection([e],[t])};var R=function(e,t,a,n){var o=e.map(function(e){return[e.x,e.y]}),r=w.a.from(o),l=r.voronoi([0,0,t,a]),c=[],u=!0,s=!1,m=void 0;try{for(var d,g=l.cellPolygons()[Symbol.iterator]();!(u=(d=g.next()).done);u=!0){var h=d.value;c.push(h)}}catch(b){s=!0,m=b}finally{try{u||null==g.return||g.return()}finally{if(s)throw m}}var p={delaunay:r,polygons:c,beaconIds:e.map(E.a("id")),beaconColors:e.map(E.a("color")),polygonCenters:c.map(M).map(function(t,a){return Object(i.a)({},t,{id:e[a].id})})};return n&&n.length>1?(p.clippedPolygons=c.map(function(e,t){return U(e,n)}),p.clippedCenters=p.clippedPolygons.map(D).map(function(t,a){return Object(i.a)({},t,{id:e[a].id})})):(p.clippedPolygons=p.polygons.map(function(e){return[[e]]}),p.clippedCenters=p.polygonCenters),p},T=(a(61),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.x,a=e.y,n=e.id,r=e.color,l=e.onClick;return o.a.createElement("g",{transform:"translate(".concat(t-10,",").concat(a-35,") scale(0.5)"),onClick:l},o.a.createElement("svg",{version:"1.1",baseProfile:"full",width:"40",height:"70",viewBox:"0 0 40 70",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("circle",{cx:"20",cy:"20",r:"18.75",strokeWidth:"2.5",stroke:r||"black",fill:"white"}),o.a.createElement("text",{x:"20",y:"25",fontSize:"15",textAnchor:"middle",fill:"black"},n),o.a.createElement("path",{d:"M 1.75 28 L 20 70 L 38.25 28 A 20 20 0 0 1 1.75 28",fill:r})))}}]),t}(n.Component));T.defaultProps={};var W=T,H=(a(62),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.x,a=e.y,n=e.fill,r=e.r,l=void 0===r?2:r;return o.a.createElement("circle",{r:l,cx:t,cy:a,fill:n||"red"})}}]),t}(n.Component));H.defaultProps={};var L=H,X=(n.Component,a(63),a(7)),Y=a.n(X),G=a(21),q=a.n(G),J=a(20),_=a.n(J),$=(a(64),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.mainPolygon;return o.a.createElement(n.Fragment,null,o.a.createElement("polyline",{fill:"none",stroke:"red",strokeWidth:"4",opacity:"0.5",points:I(e)}),e.map(function(e){return o.a.createElement(L,{x:e[0],y:e[1],r:5})}))}}]),t}(n.Component)),z=(a(65),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.imagePositionX,a=e.imagePositionY,n=e.imageOpacity,r=e.imageScale,l=e.svgWidth,c=e.svgHeight,i=(e.onPropChange,e.children),u=(e.onClick,e.imageUrl),s={background:"linear-gradient(to bottom,\n                    rgba(255,255,255,".concat(n/100,") 0%,\n                    rgba(255,255,255,").concat(n/100,") 100%),\n                    url(").concat(u,") no-repeat ").concat(t,"% ").concat(a,"% / ").concat(r,"px auto")};return o.a.createElement("svg",Object.assign({className:"root-image margin-2rem",width:l,height:c,xmlns:"http://www.w3.org/2000/svg",style:s},this.props),i)}}]),t}(n.Component));z.defaultProps={};var K=z,Q=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a.onFileUpload=function(e){var t=a.props.setImageUrl;console.log(e);var n=e.target.files[0];if(n){var o=new FileReader;o.onload=function(e){var a=e.target.result;t(a)},o.readAsDataURL(n)}},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.imagePositionX,a=e.imagePositionY,n=e.imageOpacity,r=e.imageScale,l=e.svgWidth,c=e.svgHeight,i=e.onPropChange,u=e.mainPolygon,s=e.imageUrl,m=e.toDefaultImageUrl;return o.a.createElement("div",{className:"MapEditor flex-row justify-content-center"},o.a.createElement(Y.a,{className:"margin-2rem"},o.a.createElement("h3",null,"Canvas parameters"),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"svgWidth, px"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("svgWidth"),placeholder:"svgWidth",value:l}))),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"svgHeight, px"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("svgHeight"),placeholder:"svgHeight",value:c}))),o.a.createElement("h3",null,"Background parameters"),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"image"),o.a.createElement(Y.a.Control,{type:"file",accept:"image/*",onChange:this.onFileUpload}))),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"imagePositionX, %"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("imagePositionX"),placeholder:"imagePositionX",value:t}))),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"imagePositionY, %"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("imagePositionY"),placeholder:"imagePositionY",value:a}))),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"imageWidth, px"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("imageScale"),placeholder:"imageScale",value:r}))),o.a.createElement(q.a,null,o.a.createElement(Y.a.Group,{as:_.a},o.a.createElement(Y.a.Label,null,"imageOpacity, %"),o.a.createElement(Y.a.Control,{type:"number",onChange:i("imageOpacity"),placeholder:"imageOpacity",value:n}))),o.a.createElement(f.a,{onClick:m},"Set default image")),o.a.createElement(K,{className:"margin-2rem",imagePositionX:t,imagePositionY:a,imageOpacity:n,imageScale:r,svgWidth:l,svgHeight:c,imageUrl:s},o.a.createElement($,{mainPolygon:u})))}}]),t}(n.Component);Q.defaultProps={};var V=Q,Z=(a(82),a(94)),ee=a(40),te=a.n(ee),ae=a(41),ne=function(e){return new Promise(function(t,a){var n=e.target.files[0];if(n){var o=new FileReader;o.onload=function(e){var n=e.target.result;try{var o=JSON.parse(n);t(o)}catch(r){a(r)}},o.readAsText(n)}else a(new Error("utils-base-file-loading-error"))})},oe=function(e){return new Promise(function(t,a){var n=e.target.files[0];if(n){var o=new FileReader;o.onload=function(e){var a=e.target.result;t({name:n.name,buffer:a})},o.readAsArrayBuffer(n)}else a(new Error("utils-base-file-loading-error"))})},re=/[\/\?<>\\:\*\|":]/g,le=/[\x00-\x1f\x80-\x9f]/g,ce=/^\.+$/,ie=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,ue=/[\. ]+$/;function se(e,t,a){a=a||new Date;var n,o,r=te()(a,"dd-mmm-yyyy_HH-MM-ss"),l="".concat(e,"_").concat(r);return"".concat((n=l,o=o||"",n.replace(re,o).replace(le,o).replace(ce,o).replace(ie,o).replace(ue,o).substring(0,255)),".").concat(t)}function me(e,t){!function(e,t){var a=new Blob([e],{type:"text/plain;charset=utf-8"});Object(ae.saveAs)(a,t)}(JSON.stringify(e,null,"  "),t)}var de=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={buffers:[],loading:!0},a.componentDidMount=function(){console.log("MusicEditor mounted"),a.props.audioService.isLoaded.then(function(){return a.setState({loading:!1,buffers:a.getBuffers()})})},a.componentDidUpdate=function(){console.log("MusicEditor did update")},a.componentWillUnmount=function(){console.log("MusicEditor will unmount")},a.getBuffers=function(){return a.props.audioService.getBuffers().map(Z.a(["name","props"]))},a.updateBufferNames=function(){return a.setState({buffers:a.getBuffers()})},a.onSoundSelected=function(e){oe(e).then(function(e){a.props.audioService.addAudioFile(e).then(a.updateBufferNames)})},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.buffers,r=this.props.audioService;return o.a.createElement("div",{className:"MusicEditor  margin-2rem"},a&&"loading",o.a.createElement("table",{className:"beaconTable"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"Name"))),o.a.createElement("tbody",null,n.map(function(t){return o.a.createElement("tr",null,o.a.createElement("td",null,o.a.createElement("span",null,t.name)),o.a.createElement("td",null,o.a.createElement("button",{type:"button",onClick:function(){r.removeSound(t.name),e.updateBufferNames()}},"Remove"),o.a.createElement("button",{type:"button",onClick:function(){return r.startSound(t.name)}},"Play"),o.a.createElement("button",{type:"button",onClick:function(){return r.stopSound(t.name)}},"Stop"),o.a.createElement("input",{type:"color",value:t.props.color})))}))),o.a.createElement("input",{type:"file",onChange:this.onSoundSelected}))}}]),t}(n.Component);de.defaultProps={};var ge,he=a(26),pe=(a(83),a(96)),be=(a(84),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.audioService,e.beacons),a=e.onTableHover,n=e.onBeaconChange,r=(e.onBeaconPropChange,e.onBeaconPropCheckboxChange),l=e.onBeaconRemove;return o.a.createElement("table",{className:"beaconTable"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"\u2116"),o.a.createElement("th",null,"id"),o.a.createElement("th",null,"x"),o.a.createElement("th",null,"y"),o.a.createElement("th",null,"fix position"))),o.a.createElement("tbody",null,t.map(function(e,t){return o.a.createElement("tr",{onMouseOver:a(e.id)},o.a.createElement("td",null,t+1),o.a.createElement("td",null,o.a.createElement("input",{value:e.id,onChange:n(e.id,"id")})),o.a.createElement("td",null,o.a.createElement("input",{className:"coordInput",value:e.x,type:"number",onChange:n(e.id,"x")})),o.a.createElement("td",null,o.a.createElement("input",{className:"coordInput",value:e.y,type:"number",onChange:n(e.id,"y")})),o.a.createElement("td",null,o.a.createElement("input",{type:"checkbox",onChange:r(e.id,"positionFixed"),checked:e.props.positionFixed})),o.a.createElement("td",null,o.a.createElement("button",{type:"button",onClick:l(e.id)},"Remove")))})))}}]),t}(n.Component)),fe=(a(85),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.mainPolygon,a=e.onPointChange;return o.a.createElement("table",{className:"beaconTable"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",null,"\u2116"),o.a.createElement("th",null,"x"),o.a.createElement("th",null,"y"))),o.a.createElement("tbody",null,t.map(function(e,t){return o.a.createElement("tr",null,o.a.createElement("td",null,t+1),o.a.createElement("td",null,o.a.createElement("input",{className:"coordInput",value:e[0],type:"number",onChange:a(t,0)})),o.a.createElement("td",null,o.a.createElement("input",{className:"coordInput",value:e[1],type:"number",onChange:a(t,1)})))})))}}]),t}(n.Component)),ve=(a(86),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props,t=e.showBeaconMarkers,a=e.showPolygonLabels,n=e.showPolygonBoundaries,r=e.showMassCenters,l=e.showBeaconSignalArea,c=e.signalRadius,i=e.enableAutoIteration,u=e.maxDelta,s=e.showTracks,m=this.props,d=m.toggleCheckbox,g=m.onStateChange,h=m.nextIteration,p=m.clearPolygon,b=m.clearBeacons,v=m.clearTracks;return o.a.createElement("div",{className:"flex-row"},o.a.createElement("div",{className:"margin-1rem"},o.a.createElement("input",{id:"showBeaconMarkersInput",type:"checkbox",onChange:d("showBeaconMarkers"),checked:t}),o.a.createElement("label",{htmlFor:"showBeaconMarkersInput"},"Show beacon markers"),o.a.createElement("br",null),o.a.createElement("input",{id:"showPolygonLabelsInput",type:"checkbox",onChange:d("showPolygonLabels"),checked:a}),o.a.createElement("label",{htmlFor:"showPolygonLabelsInput"},"Show polygon labels"),o.a.createElement("br",null),o.a.createElement("input",{id:"showPolygonBoundariesInput",type:"checkbox",onChange:d("showPolygonBoundaries"),checked:n}),o.a.createElement("label",{htmlFor:"showPolygonBoundariesInput"},"Show polygon boundaries"),o.a.createElement("br",null),o.a.createElement("input",{id:"showMassCentersInput",type:"checkbox",onChange:d("showMassCenters"),checked:r}),o.a.createElement("label",{htmlFor:"showMassCentersInput"},"Show mass centers"),o.a.createElement("br",null),o.a.createElement("input",{id:"showTracksInput",type:"checkbox",onChange:d("showTracks"),checked:s}),o.a.createElement("label",{htmlFor:"showTracksInput"},"Show tracks"),o.a.createElement("br",null),o.a.createElement("input",{id:"showBeaconSignalAreaInput",type:"checkbox",onChange:d("showBeaconSignalArea"),checked:l}),o.a.createElement("label",{htmlFor:"showBeaconSignalAreaInput"},"Show beacon signal area"),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("label",null,"Signal radius"),o.a.createElement("br",null),o.a.createElement("input",{type:"number",value:c,onChange:g("signalRadius")}))),o.a.createElement("div",{className:"margin-1rem"},o.a.createElement("input",{id:"enableAutoIterationInput",type:"checkbox",onChange:d("enableAutoIteration"),checked:i}),o.a.createElement("label",{htmlFor:"enableAutoIterationInput"},"Enable auto iteration"),o.a.createElement("br",null),o.a.createElement(f.a,{variant:"primary",onClick:h},"Next iteration"),o.a.createElement("div",null,o.a.createElement("label",null,"Delta (stop condition)"),o.a.createElement("br",null),o.a.createElement("input",{type:"number",value:u,onChange:g("maxDelta")}))),o.a.createElement("div",{className:"margin-1rem"},o.a.createElement(f.a,{variant:"primary",onClick:p,className:"margin-right-1rem margin-bottom-1rem"},"Clear main polygon"),o.a.createElement("br",null),o.a.createElement(f.a,{variant:"primary",onClick:b,className:"margin-right-1rem margin-bottom-1rem"},"Clear beacons"),o.a.createElement("br",null),o.a.createElement(f.a,{variant:"primary",onClick:v,className:"margin-right-1rem margin-bottom-1rem"},"Clear tracks"),o.a.createElement("br",null)))}}]),t}(n.Component)),ye=[{color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}}},{color:{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}}},{color:{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}}},{color:{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}}},{color:{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}}},{color:{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}}},{color:{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}}},{color:{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}}},{color:{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}}},{color:{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}}},{color:{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}}},{color:{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}}},{color:{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}}},{color:{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}}},{color:{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}}},{color:{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}}},{color:{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}}},{color:{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}}},{color:{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}}},{color:{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}}],Ee=[],ke=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={showBeaconMarkers:!0,showPolygonLabels:!1,showPolygonBoundaries:!0,showBeaconSignalArea:!1,showMassCenters:!0,showTracks:!0,enableAutoIteration:!1,maxDelta:1,signalRadius:40,mode:"addBeacon"},a.getClickCoords=function(e){var t=document.querySelector("svg.root-image").getBoundingClientRect(),a=e.clientX,n=e.clientY;return{x:Math.round(a-t.left),y:Math.round(n-t.top)}},a.addBeacon=function(e){var t=a.getClickCoords(e),n={x:t.x,y:t.y,id:p.a.generate(),props:{sound:"none"}},o=a.props,r=o.beacons,l=o.setBeacons;Ee=[],l([].concat(Object(v.a)(r),[n]))},a.addMainPolygonPoint=function(e){var t=a.getClickCoords(e),n=t.x,o=t.y,r=a.props,l=r.mainPolygon,c=r.setMainPolygon,i=[n,o];if(l.length>0){var u=Object(he.a)(l[0],2),s=u[0],m=u[1];N({x:n,y:o},{x:s,y:m})<20&&(i=[s,m])}var d=l;if(l.length>1){var g=l[0],h=l[l.length-1];g[0]===h[0]&&g[1]===h[1]&&(d=[])}c([].concat(Object(v.a)(d),[i]))},a.onBeaconChange=function(e,t){return function(n){var o=n.target.value,r=a.props,l=r.beacons,u=r.setBeacons,s=l.findIndex(function(t){return t.id===e}),m=Object(v.a)(l);m[s]=Object(i.a)({},m[s],Object(c.a)({},t,o)),u(m)}},a.onMainPolygonPointChange=function(e,t){return function(n){var o=n.target.value,r=a.props,l=r.mainPolygon,c=r.setMainPolygon,i=Object(v.a)(l[e]);i[t]=Number(o);var u=Object(v.a)(l);u[e]=i,c(u)}},a.onBeaconPropChange=function(e,t){return function(n){var o=n.target.value,r=a.props,l=r.beacons,u=r.setBeacons,s=l.findIndex(function(t){return t.id===e}),m=Object(v.a)(l);m[s]=Object(i.a)({},m[s],{props:Object(i.a)({},m[s].props,Object(c.a)({},t,o))}),u(m)}},a.onBeaconPropCheckboxChange=function(e,t){return function(n){var o=n.target.checked,r=a.props,l=r.beacons,u=r.setBeacons,s=l.findIndex(function(t){return t.id===e}),m=Object(v.a)(l);m[s]=Object(i.a)({},m[s],{props:Object(i.a)({},m[s].props,Object(c.a)({},t,o))}),u(m)}},a.onBeaconRemove=function(e){return function(t){var n=a.props,o=n.beacons,r=n.setBeacons,l=o.filter(function(t){return t.id!==e});Ee=[],r(l)}},a.onTableHover=function(e){return function(t){a.setState({hoveredBeacon:e})}},a.setMovable=function(e){return function(t){t.stopPropagation(),a.setState(function(t){return{movableId:null==t.movableId?e:null}})}},a.moveMovable=function(e){var t=document.querySelector("svg.root-image").getBoundingClientRect(),n=e.clientX,o=e.clientY,r={x:n-t.left,y:o-t.top};a.setState(function(e){if(null==e.movableId)return null;var t=a.props,n=t.beacons;return(0,t.setBeacons)(n.map(function(t){return t.id!==e.movableId?t:Object(i.a)({},t,r)})),{movable:r}})},a.toggleCheckbox=function(e){return function(){a.setState(function(t){return Object(c.a)({},e,!t[e])})}},a.setModeState=function(e){return function(){a.setState({mode:e})}},a.clearMainPolygon=function(e){a.props.setMainPolygon([])},a.clearBeacons=function(e){a.props.setBeacons([])},a.clearTracks=function(e){Ee=[]},a.autoIteration=function(e){e&&setTimeout(function(){return a.nextIteration()},200)},a.nextIteration=function(){var e=a.props,t=e.svgWidth,n=e.svgHeight,o=e.beacons,r=e.setBeacons,l=e.mainPolygon,c=a.state.maxDelta,u=R(o,t,n,l).clippedCenters,s=o.map(function(e){var t=u.find(function(t){return t.id===e.id});return Object(i.a)({},e,{x:e.props.positionFixed||!t||isNaN(t.x)?e.x:t.x,y:e.props.positionFixed||!t||isNaN(t.y)?e.y:t.y})});o.reduce(function(e,t,a){var n=t.x,o=t.y,r=s[a],l=r.x,c=r.y;return e+=Math.sqrt((n-l)*(n-l)+(o-c)*(o-c))},0)<c?a.setState({enableAutoIteration:!1}):(Ee.push(pe.a(s)),r(s))},a.onStateChange=function(e){return function(t){a.setState(Object(c.a)({},e,t.target.value))}},a.tracks2Polylines=function(){return 0===Ee.length?[]:Ee[0].map(function(e,t){return Ee.map(function(e){return e[t]}).map(function(e){return[e.x,e.y]})}).map(I)},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this,a=this.state,r=a.showBeaconMarkers,l=a.showPolygonLabels,c=a.showPolygonBoundaries,i=a.hoveredBeacon,u=a.mode,s=a.showBeaconSignalArea,m=a.showMassCenters,d=a.enableAutoIteration,g=a.maxDelta,h=a.signalRadius,p=a.showTracks,b=this.props,f=b.imagePositionX,v=b.imagePositionY,y=b.imageOpacity,E=b.imageScale,k=b.svgWidth,C=b.svgHeight,F=(b.onPropChange,b.beacons),B=b.audioService,w=b.mainPolygon,P=b.imageUrl;this.autoIteration(d),(l||c)&&(e=R(F,k,C,w));var x=this.tracks2Polylines();return o.a.createElement("div",{className:"Beacons flex-row justify-content-center"},o.a.createElement(K,{imagePositionX:f,imagePositionY:v,imageOpacity:y,imageScale:E,svgWidth:k,svgHeight:C,imageUrl:P,onClick:"addBeacon"===u?this.addBeacon:this.addMainPolygonPoint,onMouseMove:this.moveMovable},o.a.createElement("defs",null,o.a.createElement("radialGradient",{id:"RadialGradient1"},o.a.createElement("stop",{offset:"0%",stopColor:"red"}),o.a.createElement("stop",{offset:"100%",stopColor:"white"}))),o.a.createElement($,{mainPolygon:w}),c&&e.clippedPolygons&&e.clippedPolygons.map(function(t,a){return t.map(function(t){return o.a.createElement(n.Fragment,null,o.a.createElement("polyline",{fill:e.beaconColors[a]||ye[a%ye.length].color.background||"none",stroke:"grey",strokeWidth:"2",opacity:"0.5",points:I(t)}),o.a.createElement("polyline",{fill:"none",stroke:"grey",strokeWidth:"2",opacity:"0.5",points:I(t)}))})}),p&&x.map(function(e){return o.a.createElement("polyline",{fill:"none",stroke:"black",strokeWidth:"1",opacity:"0.5",points:e})}),l&&e.polygonCenters&&e.polygonCenters.map(function(e,t){return o.a.createElement(n.Fragment,null,o.a.createElement("text",{x:e.x,y:e.y+5,fontSize:"15",textAnchor:"middle",fill:"black"},e.id))}),F.map(function(e){return o.a.createElement(L,{x:e.x,y:e.y})}),m&&e&&e.clippedCenters&&e.clippedCenters.map(function(e,t){return o.a.createElement(L,{x:e.x,y:e.y,fill:"black"})}),s&&F.map(function(e){return o.a.createElement("circle",{r:h,cx:e.x,cy:e.y,opacity:"0.5",fill:"url(#RadialGradient1)"})}),r&&F.map(function(e){return o.a.createElement(W,{x:e.x,y:e.y,id:e.id,color:i===e.id?"blue":e.color,onClick:t.setMovable(e.id)})})),o.a.createElement("div",null,o.a.createElement(ve,{showBeaconMarkers:r,showPolygonLabels:l,showPolygonBoundaries:c,showMassCenters:m,showBeaconSignalArea:s,showTracks:p,signalRadius:h,enableAutoIteration:d,maxDelta:g,toggleCheckbox:this.toggleCheckbox,onStateChange:this.onStateChange,nextIteration:this.nextIteration,clearPolygon:this.clearMainPolygon,clearBeacons:this.clearBeacons,clearTracks:this.clearTracks}),o.a.createElement(Y.a.Check,{type:"radio",id:"addBeaconRadio",label:"Add beacon mode",value:"addBeacon",name:"mode-radio",checked:"addBeacon"===u,onClick:this.setModeState("addBeacon")}),o.a.createElement(Y.a.Check,{type:"radio",id:"editPolygonRadio",value:"editPolygon",name:"mode-radio",label:"Edit main polygon mode",checked:"addBeacon"!==u,onClick:this.setModeState("editPolygon")}),o.a.createElement("br",null),"editPolygon"===u&&o.a.createElement(fe,{mainPolygon:w,onPointChange:this.onMainPolygonPointChange}),"addBeacon"===u&&o.a.createElement(be,{audioService:B,beacons:F,onTableHover:this.onTableHover,onBeaconChange:this.onBeaconChange,onBeaconPropChange:this.onBeaconPropChange,onBeaconPropCheckboxChange:this.onBeaconPropCheckboxChange,onBeaconRemove:this.onBeaconRemove})))}}]),t}(n.Component),Ce=(a(87),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state={hasError:!1},a.componentDidCatch=function(){a.setState({hasError:!0})},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return this.state.hasError?(localStorage.removeItem("AR_POC"),setTimeout(function(){return window.location.reload()},5e3),o.a.createElement("div",null," Got error, reloading page in 5 seconds")):this.props.children}}]),t}(n.Component)),Fe=(a(88),"./images/backgroundImage.jpg"),Be=localStorage.getItem("AR_POC");if(Be){var we=JSON.parse(Be);ge=we.appState}else ge={svgWidth:800,svgHeight:581,imagePositionX:50,imagePositionY:68,imageOpacity:80,imageScale:800,beacons:[],mainPolygon:[
      [
        742,
        235
      ],
      [
        670,
        175
      ],
      [
        610,
        129
      ],
      [
        538,
        93
      ],
      [
        456,
        57
      ],
      [
        412,
        39
      ],
      [
        400,
        15
      ],
      [
        330,
        52
      ],
      [
        261,
        83
      ],
      [
        218,
        104
      ],
      [
        166,
        130
      ],
      [
        97,
        239
      ],
      [
        12,
        349
      ],
      [
        181,
        446
      ],
      [
        350,
        544
      ],
      [
        488,
        437
      ],
      [
        509,
        433
      ],
      [
        516,
        416
      ],
      [
        742,
        235
      ]
    ],imageUrl:Fe};var Pe=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).state=Object(i.a)({},ge,{showBeaconsTab:!0}),a.prepareDataForJson=function(){return{appState:a.state}},a.onStateChange=function(e){return function(t){a.setState(Object(c.a)({},e,t.target.value))}},a.setBeacons=function(e){a.setState({beacons:e})},a.setMainPolygon=function(e){a.setState({mainPolygon:e})},a.setImageUrl=function(e){a.setState({imageUrl:e})},a.toDefaultImageUrl=function(){return a.setImageUrl(Fe)},a.downloadDatabaseAsFile=function(){me(a.prepareDataForJson(),se("SR_acoustic_poc","json",new Date))},a.uploadDatabaseFile=function(e){var t=e.target.querySelector("input");t&&(t.value="",t.click())},a.onFileSelected=function(e){ne(e).then(function(e){console.log(e.appState),a.setState(e.appState)})},a}return Object(g.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval(function(){console.log("saving backup"),localStorage.setItem("AR_POC",JSON.stringify(e.prepareDataForJson()))},1e4)}},{key:"render",value:function(){var e=this,t=this.state,a=t.imagePositionX,n=t.imagePositionY,r=t.imageOpacity,l=t.imageScale,c=t.svgWidth,i=t.svgHeight,u=t.beacons,s=t.mainPolygon,m=t.imageUrl,d=t.showBeaconsTab;return o.a.createElement(Ce,null,o.a.createElement("div",{className:"App"},o.a.createElement("header",null,o.a.createElement("nav",{className:"view-switch"},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(f.a,{variant:d?"default":"primary",onClick:function(){return e.setState({showBeaconsTab:!1})}},"Map Editor")),o.a.createElement("li",null,o.a.createElement(f.a,{variant:d?"primary":"default",onClick:function(){return e.setState({showBeaconsTab:!0})}},"Beacons"))),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("button",{type:"button","data-original-title":"",title:"Upload database",onClick:this.uploadDatabaseFile},o.a.createElement("input",{type:"file",className:"display-none",tabIndex:"-1",onChange:this.onFileSelected}),"Upload database")),o.a.createElement("li",null,o.a.createElement("button",{type:"button","data-original-title":"",onClick:this.downloadDatabaseAsFile,title:"Download database"},"Download database"))))),o.a.createElement("main",null,!d&&o.a.createElement(V,{imagePositionX:a,imagePositionY:n,imageOpacity:r,imageScale:l,svgWidth:c,svgHeight:i,onPropChange:this.onStateChange,mainPolygon:s,imageUrl:m,setImageUrl:this.setImageUrl,toDefaultImageUrl:this.toDefaultImageUrl}),d&&o.a.createElement(ke,{imagePositionX:a,imagePositionY:n,imageOpacity:r,imageScale:l,svgWidth:c,svgHeight:i,beacons:u,setBeacons:this.setBeacons,mainPolygon:s,setMainPolygon:this.setMainPolygon,audioService:this.audioService,imageUrl:m}))))}}]),t}(n.Component);l.a.render(o.a.createElement(Pe,null),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.960747de.chunk.js.map