/*Copyright 2015 Timofey Rechkalov <ntsdk@yandex.ru>, Maria Sidekhmenova <matilda_@list.ru>

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
   limitations under the License. */

/*
 */
"use strict";

(function(exports){

    exports.profileFieldTypes = {
        "text" : {
            name : "text",
            value : ""
        },
        "string" : {
            name : "string",
            value : ""
        },
        "enum" : {
            name : "enum",
            value : "_"
        },
        "number" : {
            name : "number",
            value : 0
        },
        "checkbox" : {
            name : "checkbox",
            value : false
        },
        "multiEnum" : {
            name : "multiEnum",
            value : ""
        }
    };
    
    exports.playerAccessTypes = ["write","readonly","hidden"];
    
    exports.originProperties = ['name','text','time'];
    
    exports.adaptationProperties = ['text','time','ready'];
    
    exports.playersOptionTypes = ["allowPlayerCreation","allowCharacterCreation"];
    
    exports.objectSubsets = [
        "allObjects",
        "selectedCharacters",
        "selectedStories",
    ];
    
    exports.networks = [
        "socialRelations"          ,
        "characterPresenceInStory" ,
        "characterActivityInStory" ,
    ];
    
    exports.ownedEntityTypes = ['character','player','story','group'];
    exports.ownedEntityTypes2 = ['characters','players','stories','groups'];
    
    exports.metaInfoList = ["name", "date", "preGameDate", "description"];
    
    exports.profileTypes = ["character", "player"];
    
    exports.groupProfileStructure = [{
        name: "filterModel",
        type: "container",
    },{
        name: "characterList",
        type: "container",
    },{
        name: "masterDescription",
        type: "text",
    },{
        name: "doExport",
        type: "checkbox",
    },{
        name: "characterDescription",
        type: "text",
    }];
    
    exports.groupEditableItems = ['masterDescription','doExport','characterDescription'];
    
    exports.noGroup = "noGroup";
    
    exports.characterActivityTypes = [
        "active",
        "follower",
        "defensive",
        "passive",
    ];

    exports.numberFilter = [
        "ignore" ,
        "greater",
        "equal"  ,
        "lesser" ,
    ];
    
    exports.multiEnumFilter = [
        "ignore" ,
        "every",
        "equal",
        "some",
    ];
    
    exports.finishedText   = "finishedText"  ;
    exports.finishedSuffix = "finishedSuffix";
    exports.emptySuffix    = "emptySuffix"   ;
    
    exports[true] = "yes";
    exports[false] = "no";
    
    exports.yesNo = [exports[true], exports[false]];
    
    exports.briefingNumber = [1,5,10,20,50];
    
    exports.colorPalette = [
      //{color: {border: "#2B7CE9", background: "#97C2FC", highlight: {border: "#2B7CE9", background: "#D2E5FF"}, hover: {border: "#2B7CE9", background: "#D2E5FF"}}}, // 0: blue
      //{color: {border: "#FFA500", background: "#FFFF00", highlight: {border: "#FFA500", background: "#FFFFA3"}, hover: {border: "#FFA500", background: "#FFFFA3"}}}, // 1: yellow
      {color: {border: "#FA0A10", background: "#FB7E81", highlight: {border: "#FA0A10", background: "#FFAFB1"}, hover: {border: "#FA0A10", background: "#FFAFB1"}}}, // 2: red
      {color: {border: "#41A906", background: "#7BE141", highlight: {border: "#41A906", background: "#A1EC76"}, hover: {border: "#41A906", background: "#A1EC76"}}}, // 3: green
      {color: {border: "#E129F0", background: "#EB7DF4", highlight: {border: "#E129F0", background: "#F0B3F5"}, hover: {border: "#E129F0", background: "#F0B3F5"}}}, // 4: magenta
      {color: {border: "#7C29F0", background: "#AD85E4", highlight: {border: "#7C29F0", background: "#D3BDF0"}, hover: {border: "#7C29F0", background: "#D3BDF0"}}}, // 5: purple
      {color: {border: "#C37F00", background: "#FFA807", highlight: {border: "#C37F00", background: "#FFCA66"}, hover: {border: "#C37F00", background: "#FFCA66"}}}, // 6: orange
      {color: {border: "#4220FB", background: "#6E6EFD", highlight: {border: "#4220FB", background: "#9B9BFD"}, hover: {border: "#4220FB", background: "#9B9BFD"}}}, // 7: darkblue
      {color: {border: "#FD5A77", background: "#FFC0CB", highlight: {border: "#FD5A77", background: "#FFD1D9"}, hover: {border: "#FD5A77", background: "#FFD1D9"}}}, // 8: pink
      {color: {border: "#4AD63A", background: "#C2FABC", highlight: {border: "#4AD63A", background: "#E6FFE3"}, hover: {border: "#4AD63A", background: "#E6FFE3"}}}, // 9: mint
      
      {color: {border: "#990000", background: "#EE0000", highlight: {border: "#BB0000", background: "#FF3333"}, hover: {border: "#BB0000", background: "#FF3333"}}}, // 10:bright red
      
      {color: {border: "#FF6000", background: "#FF6000", highlight: {border: "#FF6000", background: "#FF6000"}, hover: {border: "#FF6000", background: "#FF6000"}}}, // 12: real orange
      {color: {border: "#97C2FC", background: "#2B7CE9", highlight: {border: "#D2E5FF", background: "#2B7CE9"}, hover: {border: "#D2E5FF", background: "#2B7CE9"}}}, // 13: blue
      {color: {border: "#399605", background: "#255C03", highlight: {border: "#399605", background: "#255C03"}, hover: {border: "#399605", background: "#255C03"}}}, // 14: green
      {color: {border: "#B70054", background: "#FF007E", highlight: {border: "#B70054", background: "#FF007E"}, hover: {border: "#B70054", background: "#FF007E"}}}, // 15: magenta
      {color: {border: "#AD85E4", background: "#7C29F0", highlight: {border: "#D3BDF0", background: "#7C29F0"}, hover: {border: "#D3BDF0", background: "#7C29F0"}}}, // 16: purple
      {color: {border: "#4557FA", background: "#000EA1", highlight: {border: "#6E6EFD", background: "#000EA1"}, hover: {border: "#6E6EFD", background: "#000EA1"}}}, // 17: darkblue
      {color: {border: "#FFC0CB", background: "#FD5A77", highlight: {border: "#FFD1D9", background: "#FD5A77"}, hover: {border: "#FFD1D9", background: "#FD5A77"}}}, // 18: pink
      {color: {border: "#C2FABC", background: "#74D66A", highlight: {border: "#E6FFE3", background: "#74D66A"}, hover: {border: "#E6FFE3", background: "#74D66A"}}}, // 19: mint
      
      {color: {border: "#EE0000", background: "#990000", highlight: {border: "#FF3333", background: "#BB0000"}, hover: {border: "#FF3333", background: "#BB0000"}}} // 20:bright red
    ];
    
    exports.CHAR_NAME = 'char-name';
    exports.CHAR_OWNER = 'char-owner';
    exports.CHAR_PREFIX = 'profile-';
    exports.PLAYER_NAME = 'player-name';
    exports.PLAYER_OWNER = 'player-owner';
    exports.PLAYER_PREFIX = 'player-profile-';
    exports.SUMMARY_PREFIX = 'summary-';
    
    exports.summaryStats = [
        ['active'      , "constant-active"   ],
        ['follower'    , "constant-follower" ],
        ['defensive'   , "constant-defensive"],
        ['passive'     , "constant-passive"  ],
        ['completeness', "profile-filter-completeness"],
        ['totalStories', "profile-filter-totalStories"]
    ];
    
    exports.socialNetworkOpts = {
        nodes : {
            shape : 'dot',
            scaling : {
                min : 10,
                max : 30,
                label : {
                    min : 8,
                    // min : 4,
                    max : 30,
                    // max : 50,
                    // drawThreshold : 12,
                    drawThreshold : 5,
                    maxVisible : 30
                // maxVisible : 20
                }
            },
            font : {
                // size : 12,
                size : 20,
                face : 'Tahoma'
            }
        },
        edges : {
            width : 0.15,
            color : {
                inherit : 'from'
            },
            smooth : {
//                    type : 'continuous'
                type : 'dynamic'
            }
        },
        physics : {
            barnesHut : {
//                    gravitationalConstant : -15000
                gravitationalConstant : -30000,
//                 gravitationalConstant : -60000
//                    springLength: 20,
                springConstant: 0.1
            },
            stabilization : {
//                    iterations : 2500
                iterations : 50
            }
        },
        // physics : false,
        // layout : true,
        layout : {
            randomSeed : 1200
        },
        interaction : {
            tooltipDelay : 200,
        // hideEdgesOnDrag : true
        },
    };
    
    exports.groupSchemaOpts = {
        nodes : {
            scaling : {
                min : 10,
                max : 30,
                label : {
                    min : 8,
                    max : 30,
                    drawThreshold : 5,
                    maxVisible : 30
                }
            },
            font : {
                size : 20,
                face : 'Tahoma'
            }
        },
        manipulation : false,
        height : '90%',
        layout : {
            hierarchical : {
                enabled : true,
                levelSeparation : 200
            }
        },
        physics : {
            hierarchicalRepulsion : {
                nodeDistance : 140
            }
        }
    };
    
    exports.investigationBoardOpts = {
            edges : {
                arrows:'to',
                width : 0.7,
//                width : 0.15,
//                color : {
//                    inherit : 'from'
//                },
                color: 'black',
                smooth : {
//                    type : 'continuous'
                    type : 'dynamic'
                },
                font: {background: '#33cccc', strokeWidth: 0}
            },
            groups : {
                groups: {color:{background:'#ffcc00', border: '#a78912'}, borderWidth:1, shape: 'box'},
                resources: {color:{background:'#99cc00', border: '#839159'}, borderWidth:1, shape: 'ellipse'}
//                 - edge label back
            },
            physics : {
                barnesHut : {
                    gravitationalConstant : -2000,
//                        gravitationalConstant : -15000,
//                    gravitationalConstant : -30000,
//                     gravitationalConstant : -60000,
//                        springLength: 20,
//                    springConstant: 0.1,
                    avoidOverlap: 0.4,
//                    avoidOverlap: 0.6,
//                    springLength: 300,
                    springLength: 120,
                    centralGravity: 0.8,
                },
                stabilization : {
//                        iterations : 2500
                    iterations : 50
                },
                timestep: 0.3
            },
//            physics : {
//                enabled: false
//            }
    };
    
    exports.snActivityColors = {
            "active": "red", 
            "follower": "blue", 
            "defensive": "green", 
            "passive": "grey"
    };
    
    exports.snFocusOptions = {
        scale : 1.2,
        offset : {
            x : 0,
            y : 0
        },
        animation : {
            duration : 1000,
            easingFunction : "easeInOutQuad"
        }
    };
    
    exports.snFixedColors = {
        "storyColor" : {
            color : {
                background : 'rgb(255,255,0)',
                border : 'rgb(255,168,3)'
            }
        },
        "noGroup" : {
            color : {
                background : 'rgb(151,194,252)',
                border : 'rgb(43,124,233)'
            }
        },
        "fromGroup" : {
            color : {
                background : '#7BE141',
                border : '#41A906'
            }
        },
        "thirdDegreeNode" : {
            color : {
                background : 'rgba(200,200,200,0.5)',
                border : 'rgba(200,200,200,0.5)'
            }
        },
        "secondDegreeNode" : {
            color : {
                background : 'rgba(150,150,150,0.75)',
                border : 'rgba(150,150,150,0.75)'
            }
        },
        "firstDegreeNode" : {
            color : {
                background : 'rgb(151,194,252)',
                border : 'rgb(43,124,233)'
            }
        }
    };
    

    exports.visLocales = {
        'ru' : {
            edit : 'Редактировать',
            del : 'Удалить выбранное',
            back : 'Назад',
            addNode : 'Добавить узел',
            addEdge : 'Добавить ребро',
            editNode : 'Редактировать узел',
            editEdge : 'Редактировать ребро',
            addDescription : 'Кликните в свободное место, чтобы добавить новый узел.',
            edgeDescription : 'Кликните на узел и протяните ребро к другому узлу, чтобы соединить их.',
            editEdgeDescription : 'Кликните на контрольные точки и перетащите их к другому узлу, чтобы соединить узлы.',
            createEdgeError : 'Невозможно соединить ребра в кластер.',
            deleteClusterError : 'Кластеры не могут быть удалены',
            editClusterError : 'Кластеры недоступны для редактирования.'
        },
        'en':{
            edit: 'Edit',
            del: 'Delete selected',
            back: 'Back',
            addNode: 'Add Node',
            addEdge: 'Add Edge',
            editNode: 'Edit Node',
            editEdge: 'Edit Edge',
            addDescription: 'Click in an empty space to place a new node.',
            edgeDescription: 'Click on a node and drag the edge to another node to connect them.',
            editEdgeDescription: 'Click on the control points and drag them to a node to connect to it.',
            createEdgeError: 'Cannot link edges to a cluster.',
            deleteClusterError: 'Clusters cannot be deleted.',
            editClusterError: 'Clusters cannot be edited.'
        }
    };
    
    exports.visLocales['en_EN'] = exports.visLocales['en'];
    exports.visLocales['en_US'] = exports.visLocales['en'];
    exports.visLocales['ru_RU'] = exports.visLocales['ru'];
    
    exports.httpTimeout = 5000;
    
})(typeof exports === 'undefined'? this['Constants']={}: exports);


/*Copyright 2015 Timofey Rechkalov <ntsdk@yandex.ru>, Maria Sidekhmenova <matilda_@list.ru>

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
   limitations under the License. */

/*
 */
"use strict";

(function(exports){

    function ValidationError(messageId, parameters) {
      Error.call(this, arguments) ;
      this.name = "ValidationError";
    
      this.messageId = messageId;
      this.parameters = parameters;
    
      if (Error.captureStackTrace) {
        Error.captureStackTrace(this, ValidationError);
      } else {
        this.stack = (new Error()).stack;
      }
    };
    
    ValidationError.prototype = Object.create(Error.prototype);
    
    exports.ValidationError = ValidationError;
    
    function InternalError(messageId, parameters) {
        Error.call(this, arguments) ;
        this.name = "InternalError";
        
        this.messageId = messageId;
        this.parameters = parameters;
        
        if (Error.captureStackTrace) {
            Error.captureStackTrace(this, InternalError);
        } else {
            this.stack = (new Error()).stack;
        }
    };
    
    InternalError.prototype = Object.create(Error.prototype);
    
    exports.InternalError = InternalError;

})(typeof exports === 'undefined'? this['Errors']={}: exports);
/*Copyright 2015 Timofey Rechkalov <ntsdk@yandex.ru>, Maria Sidekhmenova <matilda_@list.ru>

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
   limitations under the License. */

"use strict";

(function(callback){
        
    function CommonUtils(exports, R, Constants, Errors) {
    
        exports.startsWith = function(str1, str2){
            return str1.substring(0, str2.length) === str2;
        };
    
        exports.removeFromArrayByIndex = function(array, from, to) {
            "use strict";
            var rest = array.slice((to || from) + 1 || array.length);
            array.length = from < 0 ? array.length + from : from;
            return array.push.apply(array, rest);
        };
        
        exports.charOrdAFactoryBase = R.curry(function(sortDir, prepare){
            return function(a, b) {
                a = prepare(a);
                b = prepare(b);
                if(R.isNil(a) && R.isNil(b)) return 0;
                if(R.isNil(a)) return 1;
                if(R.isNil(b)) return -1;
                if (a > b)
                    return sortDir === "asc" ? 1 : -1;
                if (a < b)
                    return sortDir === "asc" ? -1 : 1;
                return 0;
            };
        });
        
        exports.charOrdAFactory = exports.charOrdAFactoryBase('asc');
        
        exports.charOrdA = exports.charOrdAFactory(function(a){return a.toLowerCase();});
        
        exports.eventsByTime = exports.charOrdAFactory(function(a){return new Date(a.time);});
    
        exports.strFormat = function(str, vals){
            "use strict";
            return str.replace(/\{\{|\}\}|\{(\d+)\}/g, function (m, n) {
                if (m == "{{") { return "{"; }
                if (m == "}}") { return "}"; }
                return vals[n];
            });
        };
        
        exports.consoleLog = function(str){
            "use strict";
            console.log(str);
        };
        
        exports.clone = function(o) {
            "use strict";
            if (!o || 'object' !== typeof o) {
                return o;
            }
            var c = 'function' === typeof o.pop ? [] : {};
            var p, v;
            for (p in o) {
                if (o.hasOwnProperty(p)) {
                    v = o[p];
                    if (v && 'object' === typeof v) {
                        c[p] = exports.clone(v);
                    } else {
                        c[p] = v;
                    }
                }
            }
            return c;
        };
        
        var preg_quote = function (str, delimiter) {
            "use strict";
            // http://kevin.vanzonneveld.net
            // + original by: booeyOH
            // + improved by: Ates Goral (http://magnetiq.com)
            // + improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
            // + bugfixed by: Onno Marsman
            // + improved by: Brett Zamir (http://brett-zamir.me)
            // * example 1: preg_quote("$40");
            // * returns 1: '\$40'
            // * example 2: preg_quote("*RRRING* Hello?");
            // * returns 2: '\*RRRING\* Hello\?'
            // * example 3: preg_quote("\\.+*?[^]$(){}=!<>|:");
            // * returns 3: '\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:'
            return (str + '').replace(new RegExp('[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\'
                    + (delimiter || '') + '-]', 'g'), '\\$&');
        };
        
        exports.globStringToRegex = function (str) {
            "use strict";
            return new RegExp(preg_quote(str).replace(/\\\*/g, '.*').replace(
                    /\\\?/g, '.'), 'g');
        };
        
        // taken from MDN https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions
        exports.escapeRegExp = function(string){
          return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); // $& means the whole matched string
        };
        
        exports.arr2map = function(array, key){
            return array.reduce(function(a, b) {
                a[b[key]] = b;
                return a;
            }, {});
        };
        
        exports.acceptDataRow = R.curry(function (model, dataString) {
            var value, regex, result;
            var dataMap = exports.arr2map(dataString, 'itemName');
            return model.every(function(filterItem){
                result = true;
                value = dataMap[filterItem.name].value;
                if (value === undefined) {
                    result = false;
                    return;
                }
                switch (filterItem.type) {
                case "enum":
                case "checkbox":
                    if (!filterItem.selectedOptions[value]) {
                        result = false;
                    }
                    break;
                case "multiEnum":
                    var values = value === '' ? [] : value.split(',');
                    switch (filterItem.condition) {
                    case "every":
                        if(R.keys(filterItem.selectedOptions).length === 0){
                            result = false;
                        } else {
                            result = R.difference(R.keys(filterItem.selectedOptions), values).length === 0;
                        }
                        break;
                    case "some":
                        result = R.difference(values,  R.keys(filterItem.selectedOptions)).length !== values.length;
                        break;
                    case "equal":
                        result = R.symmetricDifference(values,  R.keys(filterItem.selectedOptions)).length === 0;
                        break;
                    default:
                        throw 'Unexpected condition ' + filterItem.condition;
                    }
                    break;
                case "number":
                    switch (filterItem.condition) {
                    case "greater":
                        result = value > filterItem.num;
                        break;
                    case "equal":
                        result = value === filterItem.num;
                        break;
                    case "lesser":
                        result = value < filterItem.num;
                        break;
                    default:
                        throw 'Unexpected condition ' + filterItem.condition;
                    }
                    break;
                case "text":
                case "string":
                    result = value.toLowerCase().indexOf(filterItem.regexString.toLowerCase()) != -1;
                    break;
                default:
                    throw new Error('Unexpected type ' + filterItem.type);
                }
                return result;
            });
        });
        
        exports.makeGroupedProfileFilterInfo = function(opts){
            var groupedProfileFilterItems = [];
            var arr = [];
            arr.push({
                name : Constants.CHAR_NAME,
                type : "string",
                displayName : "profile-filter-character",
            });
            arr.push({
                name : Constants.CHAR_OWNER,
                type : "string",
                displayName : "profile-filter-character-owner",
            });
            arr = arr.concat(opts.characters.profileStructure.map(function(element){
                return {
                    name: Constants.CHAR_PREFIX + element.name,
                    type: element.type,
                    displayName: element.name,
                    value: element.value
                }
            }));
            groupedProfileFilterItems.push({
                name: 'characterFilterItems',
                profileFilterItems: arr
            });
            
            arr = [];
            arr.push({
                name : Constants.PLAYER_NAME,
                type : "string",
                displayName : "profile-filter-player-name",
            });
            arr.push({
                name : Constants.PLAYER_OWNER,
                type : "string",
                displayName : "profile-filter-player-owner",
            });
            arr = arr.concat(opts.players.profileStructure.map(function(element){
                return {
                    name: Constants.PLAYER_PREFIX + element.name,
                    type: element.type,
                    displayName: element.name,
                    value: element.value
                }
            }));
            groupedProfileFilterItems.push({
                name: 'playerFilterItems',
                profileFilterItems: arr
            });
            
            arr = Constants.summaryStats.map(function(stat){
                return {
                    name: Constants.SUMMARY_PREFIX + stat[0],
                    type: 'number',
                    displayName: stat[1],
                };
            });
            groupedProfileFilterItems.push({
                name: 'summaryFilterItems',
                profileFilterItems: arr
            });
            opts.groupedProfileFilterItems = groupedProfileFilterItems;
            return opts;
        };
        
        var getCharacterInfoValue = function(info, characterName, profileItemName){
            if(profileItemName == Constants.CHAR_NAME){
                return characterName;
            } else if(profileItemName == Constants.CHAR_OWNER){
                return info.characters.owners[characterName];
            } else if(exports.startsWith(profileItemName, Constants.SUMMARY_PREFIX) ){
                return info.charactersSummary[characterName][profileItemName.substring(Constants.SUMMARY_PREFIX.length)];
            } else if(exports.startsWith(profileItemName, Constants.CHAR_PREFIX) ){
                return info.characters.profiles[characterName][profileItemName.substring(Constants.CHAR_PREFIX.length)];
            } else {
                throw new Error('Unexpected profileItemName: ' + profileItemName);
            }
        };
        var getCharacterInfoValue2 = function(info, profileId, profileItemName){
            if (profileItemName == Constants.CHAR_NAME || 
                    profileItemName == Constants.CHAR_OWNER || 
                    exports.startsWith(profileItemName, Constants.SUMMARY_PREFIX) || 
                    exports.startsWith(profileItemName, Constants.CHAR_PREFIX)) {
                if(profileId[0] === '') return undefined;
                var characterName = profileId[0];
                if(profileItemName == Constants.CHAR_NAME){
                    return characterName;
                } else if(profileItemName == Constants.CHAR_OWNER){
                    return info.characters.owners[characterName];
                } else if(exports.startsWith(profileItemName, Constants.SUMMARY_PREFIX) ){
                    return info.charactersSummary[characterName][profileItemName.substring(Constants.SUMMARY_PREFIX.length)];
                } else if(exports.startsWith(profileItemName, Constants.CHAR_PREFIX) ){
                    return info.characters.profiles[characterName][profileItemName.substring(Constants.CHAR_PREFIX.length)];
                } 
            } else if(profileItemName == Constants.PLAYER_NAME || 
                    profileItemName == Constants.PLAYER_OWNER || 
                    exports.startsWith(profileItemName, Constants.PLAYER_PREFIX)){
                if(profileId[1] === '') return undefined;
                var playerName = profileId[1];
                if(profileItemName == Constants.PLAYER_NAME){
                    return playerName;
                } else if(profileItemName == Constants.PLAYER_OWNER){
                    return info.players.owners[playerName];
                } else if(exports.startsWith(profileItemName, Constants.PLAYER_PREFIX) ){
                    return info.players.profiles[playerName][profileItemName.substring(Constants.PLAYER_PREFIX.length)];
                } 
            } else {
                throw new Error('Unexpected profileItemName: ' + profileItemName);
            }
        };
        
        exports.getDataArray = R.curry(function (info, profileId) {
            return R.flatten(info.groupedProfileFilterItems.map(R.prop('profileFilterItems'))).map(function(profileItemInfo){
                var value = getCharacterInfoValue2(info, profileId, profileItemInfo.name);
                return {
                    value: value,
                    type: profileItemInfo.type,
                    itemName: profileItemInfo.name
                }
            });
        });
        
        exports.getDataArrays = function(info, filterModel) {
            return info.bindingData.map(exports.getDataArray(info)).filter(exports.acceptDataRow(filterModel));
        };
        
        var findProfileStructureConflicts = function(prefix, profileStructure, filterModel){
            var conflictTypes = [];
            var profilePart = filterModel.filter(R.compose(R.test(new RegExp('^' + prefix)), R.prop('name')));
            var profileSettingsMap = R.indexBy(R.prop('name'), profileStructure);
            profilePart.forEach(function(modelItem){
                var itemName = modelItem.name.substring(prefix.length);
                var profileItem = profileSettingsMap[itemName];
                if(!profileItem || profileItem.type !== modelItem.type){
                    conflictTypes.push(itemName);
                    return;
                }
                if(profileItem.type === 'enum' || profileItem.type === 'multiEnum'){
                    var profileEnum = profileItem.value.split(',');
                    var modelEnum = Object.keys(modelItem.selectedOptions);
                    if(R.difference(modelEnum, profileEnum).length != 0){
                        conflictTypes.push(itemName);
                        return;
                    }
                }
            });
            return conflictTypes;
        };
        
        exports.isFilterModelCompatibleWithProfiles = function(profileStructure, filterModel){
            var charConflicts = findProfileStructureConflicts(Constants.CHAR_PREFIX, profileStructure.characters, filterModel);
            var playerConflicts = findProfileStructureConflicts(Constants.PLAYER_PREFIX, profileStructure.players, filterModel);
            return charConflicts.concat(playerConflicts);
        };
        
        exports.makeValidationError = function(err){
            err.splice(0, 0, null);
            return new (Function.prototype.bind.apply(Errors.ValidationError, err));
        };
        
        // precondition API
        exports.precondition = R.curry(function(check, reject, resolve){
            var err = check();
            if(err === null){
                resolve();
            } else {
                reject(exports.makeValidationError(err));
            }
        });
        
        exports.chainCheck = R.curry(function(arr){
            return () => {
                return arr.reduce(function(err, item){
                    if(err) return err;
                    return item();
                }, null);
            }
        });
        
        exports.eitherCheck = R.curry(function(func1, func2){
            return () => {
                var res1 = func1();
                if(res1 === null){
                    return null;
                }
                var res2 = func2();
                if(res2 === null){
                    return null;
                }
                return res1;
            }
        });
        
        // primitive precondition checks
        var arrContainsElsCheck = R.curry(function(msg, els, valueList){
            return () => {
                var diff = R.difference(els, valueList);
                return diff.length === 0 ? null : [msg, [JSON.stringify(diff)]];
            }
        });
        
        exports.elementsFromEnum = arrContainsElsCheck('errors-unsupported-types-in-list');
        exports.entitiesExist = arrContainsElsCheck('errors-entities-are-not-exist');
        
        var arrContainsElCheck = R.curry(function(msg, el, valueList){
            return () => {
                return R.contains(el, valueList) ? null : [msg, [el]];
            }
        });
        
        exports.elementFromEnum = arrContainsElCheck('errors-unsupported-type-in-list');
        exports.entityExists = arrContainsElCheck('errors-entity-is-not-exist');
        
        exports.entityIsNotUsed = R.curry(function(el, valueList){
            return () => {
                return !R.contains(el, valueList) ? null : ['errors-entity-is-used', [el]];
            }
        });
        
        exports.isString = R.curry(function(el){
            return () => {
                return R.is(String, el) ? null : ['errors-argument-is-not-a-string', [el]];
            }
        });
        
        exports.isEmptyString = R.curry(function(el){
            return () => {
                return R.equals('', el) ? null : ['errors-argument-is-not-empty-string', [el]];
            }
        });
        
        exports.isNotEmptyString = R.curry(function(el){
            return () => {
                return !R.equals('', el) ? null : ['errors-argument-is-empty-string', [el]];
            }
        });
        
        exports.nameIsNotEmpty = R.curry(function(el){
            return () => {
                return !R.equals('', el) ? null : ['errors-name-is-empty-string', [el]];
            }
        });
        
        exports.isArray = R.curry(function(el){
            return () => {
                return R.is(Array, el) ? null : ['errors-argument-is-not-an-array', [el]];
            }
        });
        
        exports.isObject = R.curry(function(el){
            return () => {
                return R.is(Object, el) ? null : ['errors-argument-is-not-an-object', [el]];
            }
        });
        
        exports.isBoolean = R.curry(function(el){
            return () => {
                return R.is(Boolean, el) ? null : ['errors-argument-is-not-a-boolean', [el]];
            }
        });
        
        exports.isNumber = R.curry(function(el){
            return () => {
                return R.is(Number, el) ? null : ['errors-argument-is-not-a-number', [el]];
            }
        });
        
        exports.isNil = R.curry(function(el){
            return () => {
                return R.isNil(el) ? null : ['errors-argument-is-not-nil', [el]];
            }
        });
        
        exports.nil = R.curry(function(){
            return () => {
                return null;
            }
        });
        
        exports.notEquals = R.curry(function(el, el2){
            return () => {
                return !R.equals(el, el2) ? null : ['errors-argument-must-not-be-equal', [el]];
            }
        });
        
        exports.isInRange = R.curry(function(el, low, up){
            return () => {
                return low <= el && el <= up ? null : ['errors-argument-is-not-in-range', [el, low, up]];
            }
        });
        
        exports.createEntityCheck = R.curry(function(entityName, entityList){
            return exports.chainCheck([exports.isString(entityName), exports.nameIsNotEmpty(entityName), exports.entityIsNotUsed(entityName, entityList)]);
        });
        
        exports.entityExistsCheck = exports.removeEntityCheck = R.curry(function(entityName, entityList){
            return exports.chainCheck([exports.isString(entityName), exports.entityExists(entityName, entityList)]);
        });
        
        exports.renameEntityCheck = R.curry(function(fromName, toName, entityList){
            return exports.chainCheck([exports.removeEntityCheck(fromName, entityList), exports.createEntityCheck(toName, entityList)]);
        });
        
        exports.switchEntityCheck = R.curry(function(entity1, entity2, entityList, entityContainerList){
            return exports.chainCheck([exports.entityExistsCheck(entity1, entityList), 
                                       exports.entityExistsCheck(entity2, entityList),
                                       exports.entityExists(entity1, entityContainerList),
                                       exports.entityIsNotUsed(entity2, entityContainerList)]);
        });
        
        exports.getValueCheck = function(type){
            switch (type) {
            case "checkbox":
                return exports.isBoolean;
            case "number":
                return exports.isNumber;
            }
            return exports.isString;
        };
        
    }
    
    callback(CommonUtils);

})(function(api){
    typeof exports === 'undefined'? api(this['CommonUtils'] = {}, R, Constants, Errors) : module.exports = api;
}.bind(this));
/*
 * Date Format 1.2.3
 * (c) 2007-2009 Steven Levithan <stevenlevithan.com>
 * MIT license
 *
 * Includes enhancements by Scott Trenda <scott.trenda.net>
 * and Kris Kowal <cixar.com/~kris.kowal/>
 *
 * Accepts a date, a mask, or a date and a mask.
 * Returns a formatted version of the given date.
 * The date defaults to the current date/time.
 * The mask defaults to dateFormat.masks.default.
 */

// Thanks for your work ;) 
// NtsDK

(function(callback){

var dateFormat = function () {
    var    token = /d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,
        timezone = /\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,
        timezoneClip = /[^-+\dA-Z]/g,
        pad = function (val, len) {
            val = String(val);
            len = len || 2;
            while (val.length < len) val = "0" + val;
            return val;
        };

    // Regexes and supporting functions are cached through closure
    return function (date, mask, utc) {
        var dF = dateFormat;

        // You can't provide utc if you skip other args (use the "UTC:" mask prefix)
        if (arguments.length == 1 && Object.prototype.toString.call(date) == "[object String]" && !/\d/.test(date)) {
            mask = date;
            date = undefined;
        }

        // Passing date through Date applies Date.parse, if necessary
        date = date ? new Date(date) : new Date;
        if (isNaN(date)) throw SyntaxError("invalid date");

        mask = String(dF.masks[mask] || mask || dF.masks["default"]);

        // Allow setting the utc argument via the mask
        if (mask.slice(0, 4) == "UTC:") {
            mask = mask.slice(4);
            utc = true;
        }

        var    _ = utc ? "getUTC" : "get",
            d = date[_ + "Date"](),
            D = date[_ + "Day"](),
            m = date[_ + "Month"](),
            y = date[_ + "FullYear"](),
            H = date[_ + "Hours"](),
            M = date[_ + "Minutes"](),
            s = date[_ + "Seconds"](),
            L = date[_ + "Milliseconds"](),
            o = utc ? 0 : date.getTimezoneOffset(),
            flags = {
                d:    d,
                dd:   pad(d),
                ddd:  dF.i18n.dayNames[D],
                dddd: dF.i18n.dayNames[D + 7],
                m:    m + 1,
                mm:   pad(m + 1),
                mmm:  dF.i18n.monthNames[m],
                mmmm: dF.i18n.monthNames[m + 12],
                yy:   String(y).slice(2),
                yyyy: y,
                h:    H % 12 || 12,
                hh:   pad(H % 12 || 12),
                H:    H,
                HH:   pad(H),
                M:    M,
                MM:   pad(M),
                s:    s,
                ss:   pad(s),
                l:    pad(L, 3),
                L:    pad(L > 99 ? Math.round(L / 10) : L),
                t:    H < 12 ? "a"  : "p",
                tt:   H < 12 ? "am" : "pm",
                T:    H < 12 ? "A"  : "P",
                TT:   H < 12 ? "AM" : "PM",
                Z:    utc ? "UTC" : (String(date).match(timezone) || [""]).pop().replace(timezoneClip, ""),
                o:    (o > 0 ? "-" : "+") + pad(Math.floor(Math.abs(o) / 60) * 100 + Math.abs(o) % 60, 4),
                S:    ["th", "st", "nd", "rd"][d % 10 > 3 ? 0 : (d % 100 - d % 10 != 10) * d % 10]
            };

        return mask.replace(token, function ($0) {
            return $0 in flags ? flags[$0] : $0.slice(1, $0.length - 1);
        });
    };
}();

// Some common format strings
dateFormat.masks = {
    "default":      "ddd mmm dd yyyy HH:MM:ss",
    shortDate:      "m/d/yy",
    mediumDate:     "mmm d, yyyy",
    longDate:       "mmmm d, yyyy",
    fullDate:       "dddd, mmmm d, yyyy",
    shortTime:      "h:MM TT",
    mediumTime:     "h:MM:ss TT",
    longTime:       "h:MM:ss TT Z",
    isoDate:        "yyyy-mm-dd",
    isoTime:        "HH:MM:ss",
    isoDateTime:    "yyyy-mm-dd'T'HH:MM:ss",
    isoUtcDateTime: "UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"
};

// Internationalization strings
dateFormat.i18n = {
    dayNames: [
        "Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat",
        "Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"
    ],
    monthNames: [
        "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec",
        "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"
    ]
};

callback(dateFormat);

})(function(dateFormat){
    typeof exports === 'undefined'? this['dateFormat'] = dateFormat: module.exports = dateFormat;
}.bind(this));


var defaultLang = 'ru';

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL2NvbW1vbi9jb25zdGFudHMuanMiLCJqcy9jb21tb24vZXJyb3JzLmpzIiwianMvY29tbW9uL2NvbW1vblV0aWxzLmpzIiwianMvY29tbW9uL2RhdGVGb3JtYXQuanMiLCIuLi8uLi8uLi9zbXRrLW5pbXMtdHJhbnNsYXRpb25zL3J1L2RlZmF1bHRMYW5nLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9mQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3BJQTtBQUNBIiwiZmlsZSI6ImNvbW1vbkNvcmUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypDb3B5cmlnaHQgMjAxNSBUaW1vZmV5IFJlY2hrYWxvdiA8bnRzZGtAeWFuZGV4LnJ1PiwgTWFyaWEgU2lkZWtobWVub3ZhIDxtYXRpbGRhX0BsaXN0LnJ1PlxyXG5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuXHJcbmh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLiAqL1xyXG5cclxuLypcclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKGV4cG9ydHMpe1xyXG5cclxuICAgIGV4cG9ydHMucHJvZmlsZUZpZWxkVHlwZXMgPSB7XHJcbiAgICAgICAgXCJ0ZXh0XCIgOiB7XHJcbiAgICAgICAgICAgIG5hbWUgOiBcInRleHRcIixcclxuICAgICAgICAgICAgdmFsdWUgOiBcIlwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInN0cmluZ1wiIDoge1xyXG4gICAgICAgICAgICBuYW1lIDogXCJzdHJpbmdcIixcclxuICAgICAgICAgICAgdmFsdWUgOiBcIlwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImVudW1cIiA6IHtcclxuICAgICAgICAgICAgbmFtZSA6IFwiZW51bVwiLFxyXG4gICAgICAgICAgICB2YWx1ZSA6IFwiX1wiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcIm51bWJlclwiIDoge1xyXG4gICAgICAgICAgICBuYW1lIDogXCJudW1iZXJcIixcclxuICAgICAgICAgICAgdmFsdWUgOiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImNoZWNrYm94XCIgOiB7XHJcbiAgICAgICAgICAgIG5hbWUgOiBcImNoZWNrYm94XCIsXHJcbiAgICAgICAgICAgIHZhbHVlIDogZmFsc2VcclxuICAgICAgICB9LFxyXG4gICAgICAgIFwibXVsdGlFbnVtXCIgOiB7XHJcbiAgICAgICAgICAgIG5hbWUgOiBcIm11bHRpRW51bVwiLFxyXG4gICAgICAgICAgICB2YWx1ZSA6IFwiXCJcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBleHBvcnRzLnBsYXllckFjY2Vzc1R5cGVzID0gW1wid3JpdGVcIixcInJlYWRvbmx5XCIsXCJoaWRkZW5cIl07XHJcbiAgICBcclxuICAgIGV4cG9ydHMub3JpZ2luUHJvcGVydGllcyA9IFsnbmFtZScsJ3RleHQnLCd0aW1lJ107XHJcbiAgICBcclxuICAgIGV4cG9ydHMuYWRhcHRhdGlvblByb3BlcnRpZXMgPSBbJ3RleHQnLCd0aW1lJywncmVhZHknXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5wbGF5ZXJzT3B0aW9uVHlwZXMgPSBbXCJhbGxvd1BsYXllckNyZWF0aW9uXCIsXCJhbGxvd0NoYXJhY3RlckNyZWF0aW9uXCJdO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLm9iamVjdFN1YnNldHMgPSBbXHJcbiAgICAgICAgXCJhbGxPYmplY3RzXCIsXHJcbiAgICAgICAgXCJzZWxlY3RlZENoYXJhY3RlcnNcIixcclxuICAgICAgICBcInNlbGVjdGVkU3Rvcmllc1wiLFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5uZXR3b3JrcyA9IFtcclxuICAgICAgICBcInNvY2lhbFJlbGF0aW9uc1wiICAgICAgICAgICxcclxuICAgICAgICBcImNoYXJhY3RlclByZXNlbmNlSW5TdG9yeVwiICxcclxuICAgICAgICBcImNoYXJhY3RlckFjdGl2aXR5SW5TdG9yeVwiICxcclxuICAgIF07XHJcbiAgICBcclxuICAgIGV4cG9ydHMub3duZWRFbnRpdHlUeXBlcyA9IFsnY2hhcmFjdGVyJywncGxheWVyJywnc3RvcnknLCdncm91cCddO1xyXG4gICAgZXhwb3J0cy5vd25lZEVudGl0eVR5cGVzMiA9IFsnY2hhcmFjdGVycycsJ3BsYXllcnMnLCdzdG9yaWVzJywnZ3JvdXBzJ107XHJcbiAgICBcclxuICAgIGV4cG9ydHMubWV0YUluZm9MaXN0ID0gW1wibmFtZVwiLCBcImRhdGVcIiwgXCJwcmVHYW1lRGF0ZVwiLCBcImRlc2NyaXB0aW9uXCJdO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLnByb2ZpbGVUeXBlcyA9IFtcImNoYXJhY3RlclwiLCBcInBsYXllclwiXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5ncm91cFByb2ZpbGVTdHJ1Y3R1cmUgPSBbe1xyXG4gICAgICAgIG5hbWU6IFwiZmlsdGVyTW9kZWxcIixcclxuICAgICAgICB0eXBlOiBcImNvbnRhaW5lclwiLFxyXG4gICAgfSx7XHJcbiAgICAgICAgbmFtZTogXCJjaGFyYWN0ZXJMaXN0XCIsXHJcbiAgICAgICAgdHlwZTogXCJjb250YWluZXJcIixcclxuICAgIH0se1xyXG4gICAgICAgIG5hbWU6IFwibWFzdGVyRGVzY3JpcHRpb25cIixcclxuICAgICAgICB0eXBlOiBcInRleHRcIixcclxuICAgIH0se1xyXG4gICAgICAgIG5hbWU6IFwiZG9FeHBvcnRcIixcclxuICAgICAgICB0eXBlOiBcImNoZWNrYm94XCIsXHJcbiAgICB9LHtcclxuICAgICAgICBuYW1lOiBcImNoYXJhY3RlckRlc2NyaXB0aW9uXCIsXHJcbiAgICAgICAgdHlwZTogXCJ0ZXh0XCIsXHJcbiAgICB9XTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5ncm91cEVkaXRhYmxlSXRlbXMgPSBbJ21hc3RlckRlc2NyaXB0aW9uJywnZG9FeHBvcnQnLCdjaGFyYWN0ZXJEZXNjcmlwdGlvbiddO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLm5vR3JvdXAgPSBcIm5vR3JvdXBcIjtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5jaGFyYWN0ZXJBY3Rpdml0eVR5cGVzID0gW1xyXG4gICAgICAgIFwiYWN0aXZlXCIsXHJcbiAgICAgICAgXCJmb2xsb3dlclwiLFxyXG4gICAgICAgIFwiZGVmZW5zaXZlXCIsXHJcbiAgICAgICAgXCJwYXNzaXZlXCIsXHJcbiAgICBdO1xyXG5cclxuICAgIGV4cG9ydHMubnVtYmVyRmlsdGVyID0gW1xyXG4gICAgICAgIFwiaWdub3JlXCIgLFxyXG4gICAgICAgIFwiZ3JlYXRlclwiLFxyXG4gICAgICAgIFwiZXF1YWxcIiAgLFxyXG4gICAgICAgIFwibGVzc2VyXCIgLFxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5tdWx0aUVudW1GaWx0ZXIgPSBbXHJcbiAgICAgICAgXCJpZ25vcmVcIiAsXHJcbiAgICAgICAgXCJldmVyeVwiLFxyXG4gICAgICAgIFwiZXF1YWxcIixcclxuICAgICAgICBcInNvbWVcIixcclxuICAgIF07XHJcbiAgICBcclxuICAgIGV4cG9ydHMuZmluaXNoZWRUZXh0ICAgPSBcImZpbmlzaGVkVGV4dFwiICA7XHJcbiAgICBleHBvcnRzLmZpbmlzaGVkU3VmZml4ID0gXCJmaW5pc2hlZFN1ZmZpeFwiO1xyXG4gICAgZXhwb3J0cy5lbXB0eVN1ZmZpeCAgICA9IFwiZW1wdHlTdWZmaXhcIiAgIDtcclxuICAgIFxyXG4gICAgZXhwb3J0c1t0cnVlXSA9IFwieWVzXCI7XHJcbiAgICBleHBvcnRzW2ZhbHNlXSA9IFwibm9cIjtcclxuICAgIFxyXG4gICAgZXhwb3J0cy55ZXNObyA9IFtleHBvcnRzW3RydWVdLCBleHBvcnRzW2ZhbHNlXV07XHJcbiAgICBcclxuICAgIGV4cG9ydHMuYnJpZWZpbmdOdW1iZXIgPSBbMSw1LDEwLDIwLDUwXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5jb2xvclBhbGV0dGUgPSBbXHJcbiAgICAgIC8ve2NvbG9yOiB7Ym9yZGVyOiBcIiMyQjdDRTlcIiwgYmFja2dyb3VuZDogXCIjOTdDMkZDXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjMkI3Q0U5XCIsIGJhY2tncm91bmQ6IFwiI0QyRTVGRlwifSwgaG92ZXI6IHtib3JkZXI6IFwiIzJCN0NFOVwiLCBiYWNrZ3JvdW5kOiBcIiNEMkU1RkZcIn19fSwgLy8gMDogYmx1ZVxyXG4gICAgICAvL3tjb2xvcjoge2JvcmRlcjogXCIjRkZBNTAwXCIsIGJhY2tncm91bmQ6IFwiI0ZGRkYwMFwiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiI0ZGQTUwMFwiLCBiYWNrZ3JvdW5kOiBcIiNGRkZGQTNcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiNGRkE1MDBcIiwgYmFja2dyb3VuZDogXCIjRkZGRkEzXCJ9fX0sIC8vIDE6IHllbGxvd1xyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiI0ZBMEExMFwiLCBiYWNrZ3JvdW5kOiBcIiNGQjdFODFcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiNGQTBBMTBcIiwgYmFja2dyb3VuZDogXCIjRkZBRkIxXCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjRkEwQTEwXCIsIGJhY2tncm91bmQ6IFwiI0ZGQUZCMVwifX19LCAvLyAyOiByZWRcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiM0MUE5MDZcIiwgYmFja2dyb3VuZDogXCIjN0JFMTQxXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjNDFBOTA2XCIsIGJhY2tncm91bmQ6IFwiI0ExRUM3NlwifSwgaG92ZXI6IHtib3JkZXI6IFwiIzQxQTkwNlwiLCBiYWNrZ3JvdW5kOiBcIiNBMUVDNzZcIn19fSwgLy8gMzogZ3JlZW5cclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiNFMTI5RjBcIiwgYmFja2dyb3VuZDogXCIjRUI3REY0XCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjRTEyOUYwXCIsIGJhY2tncm91bmQ6IFwiI0YwQjNGNVwifSwgaG92ZXI6IHtib3JkZXI6IFwiI0UxMjlGMFwiLCBiYWNrZ3JvdW5kOiBcIiNGMEIzRjVcIn19fSwgLy8gNDogbWFnZW50YVxyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiIzdDMjlGMFwiLCBiYWNrZ3JvdW5kOiBcIiNBRDg1RTRcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiM3QzI5RjBcIiwgYmFja2dyb3VuZDogXCIjRDNCREYwXCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjN0MyOUYwXCIsIGJhY2tncm91bmQ6IFwiI0QzQkRGMFwifX19LCAvLyA1OiBwdXJwbGVcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiNDMzdGMDBcIiwgYmFja2dyb3VuZDogXCIjRkZBODA3XCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjQzM3RjAwXCIsIGJhY2tncm91bmQ6IFwiI0ZGQ0E2NlwifSwgaG92ZXI6IHtib3JkZXI6IFwiI0MzN0YwMFwiLCBiYWNrZ3JvdW5kOiBcIiNGRkNBNjZcIn19fSwgLy8gNjogb3JhbmdlXHJcbiAgICAgIHtjb2xvcjoge2JvcmRlcjogXCIjNDIyMEZCXCIsIGJhY2tncm91bmQ6IFwiIzZFNkVGRFwiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiIzQyMjBGQlwiLCBiYWNrZ3JvdW5kOiBcIiM5QjlCRkRcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiM0MjIwRkJcIiwgYmFja2dyb3VuZDogXCIjOUI5QkZEXCJ9fX0sIC8vIDc6IGRhcmtibHVlXHJcbiAgICAgIHtjb2xvcjoge2JvcmRlcjogXCIjRkQ1QTc3XCIsIGJhY2tncm91bmQ6IFwiI0ZGQzBDQlwiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiI0ZENUE3N1wiLCBiYWNrZ3JvdW5kOiBcIiNGRkQxRDlcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiNGRDVBNzdcIiwgYmFja2dyb3VuZDogXCIjRkZEMUQ5XCJ9fX0sIC8vIDg6IHBpbmtcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiM0QUQ2M0FcIiwgYmFja2dyb3VuZDogXCIjQzJGQUJDXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjNEFENjNBXCIsIGJhY2tncm91bmQ6IFwiI0U2RkZFM1wifSwgaG92ZXI6IHtib3JkZXI6IFwiIzRBRDYzQVwiLCBiYWNrZ3JvdW5kOiBcIiNFNkZGRTNcIn19fSwgLy8gOTogbWludFxyXG4gICAgICBcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiM5OTAwMDBcIiwgYmFja2dyb3VuZDogXCIjRUUwMDAwXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjQkIwMDAwXCIsIGJhY2tncm91bmQ6IFwiI0ZGMzMzM1wifSwgaG92ZXI6IHtib3JkZXI6IFwiI0JCMDAwMFwiLCBiYWNrZ3JvdW5kOiBcIiNGRjMzMzNcIn19fSwgLy8gMTA6YnJpZ2h0IHJlZFxyXG4gICAgICBcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiNGRjYwMDBcIiwgYmFja2dyb3VuZDogXCIjRkY2MDAwXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjRkY2MDAwXCIsIGJhY2tncm91bmQ6IFwiI0ZGNjAwMFwifSwgaG92ZXI6IHtib3JkZXI6IFwiI0ZGNjAwMFwiLCBiYWNrZ3JvdW5kOiBcIiNGRjYwMDBcIn19fSwgLy8gMTI6IHJlYWwgb3JhbmdlXHJcbiAgICAgIHtjb2xvcjoge2JvcmRlcjogXCIjOTdDMkZDXCIsIGJhY2tncm91bmQ6IFwiIzJCN0NFOVwiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiI0QyRTVGRlwiLCBiYWNrZ3JvdW5kOiBcIiMyQjdDRTlcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiNEMkU1RkZcIiwgYmFja2dyb3VuZDogXCIjMkI3Q0U5XCJ9fX0sIC8vIDEzOiBibHVlXHJcbiAgICAgIHtjb2xvcjoge2JvcmRlcjogXCIjMzk5NjA1XCIsIGJhY2tncm91bmQ6IFwiIzI1NUMwM1wiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiIzM5OTYwNVwiLCBiYWNrZ3JvdW5kOiBcIiMyNTVDMDNcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiMzOTk2MDVcIiwgYmFja2dyb3VuZDogXCIjMjU1QzAzXCJ9fX0sIC8vIDE0OiBncmVlblxyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiI0I3MDA1NFwiLCBiYWNrZ3JvdW5kOiBcIiNGRjAwN0VcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiNCNzAwNTRcIiwgYmFja2dyb3VuZDogXCIjRkYwMDdFXCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjQjcwMDU0XCIsIGJhY2tncm91bmQ6IFwiI0ZGMDA3RVwifX19LCAvLyAxNTogbWFnZW50YVxyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiI0FEODVFNFwiLCBiYWNrZ3JvdW5kOiBcIiM3QzI5RjBcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiNEM0JERjBcIiwgYmFja2dyb3VuZDogXCIjN0MyOUYwXCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjRDNCREYwXCIsIGJhY2tncm91bmQ6IFwiIzdDMjlGMFwifX19LCAvLyAxNjogcHVycGxlXHJcbiAgICAgIHtjb2xvcjoge2JvcmRlcjogXCIjNDU1N0ZBXCIsIGJhY2tncm91bmQ6IFwiIzAwMEVBMVwiLCBoaWdobGlnaHQ6IHtib3JkZXI6IFwiIzZFNkVGRFwiLCBiYWNrZ3JvdW5kOiBcIiMwMDBFQTFcIn0sIGhvdmVyOiB7Ym9yZGVyOiBcIiM2RTZFRkRcIiwgYmFja2dyb3VuZDogXCIjMDAwRUExXCJ9fX0sIC8vIDE3OiBkYXJrYmx1ZVxyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiI0ZGQzBDQlwiLCBiYWNrZ3JvdW5kOiBcIiNGRDVBNzdcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiNGRkQxRDlcIiwgYmFja2dyb3VuZDogXCIjRkQ1QTc3XCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjRkZEMUQ5XCIsIGJhY2tncm91bmQ6IFwiI0ZENUE3N1wifX19LCAvLyAxODogcGlua1xyXG4gICAgICB7Y29sb3I6IHtib3JkZXI6IFwiI0MyRkFCQ1wiLCBiYWNrZ3JvdW5kOiBcIiM3NEQ2NkFcIiwgaGlnaGxpZ2h0OiB7Ym9yZGVyOiBcIiNFNkZGRTNcIiwgYmFja2dyb3VuZDogXCIjNzRENjZBXCJ9LCBob3Zlcjoge2JvcmRlcjogXCIjRTZGRkUzXCIsIGJhY2tncm91bmQ6IFwiIzc0RDY2QVwifX19LCAvLyAxOTogbWludFxyXG4gICAgICBcclxuICAgICAge2NvbG9yOiB7Ym9yZGVyOiBcIiNFRTAwMDBcIiwgYmFja2dyb3VuZDogXCIjOTkwMDAwXCIsIGhpZ2hsaWdodDoge2JvcmRlcjogXCIjRkYzMzMzXCIsIGJhY2tncm91bmQ6IFwiI0JCMDAwMFwifSwgaG92ZXI6IHtib3JkZXI6IFwiI0ZGMzMzM1wiLCBiYWNrZ3JvdW5kOiBcIiNCQjAwMDBcIn19fSAvLyAyMDpicmlnaHQgcmVkXHJcbiAgICBdO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLkNIQVJfTkFNRSA9ICdjaGFyLW5hbWUnO1xyXG4gICAgZXhwb3J0cy5DSEFSX09XTkVSID0gJ2NoYXItb3duZXInO1xyXG4gICAgZXhwb3J0cy5DSEFSX1BSRUZJWCA9ICdwcm9maWxlLSc7XHJcbiAgICBleHBvcnRzLlBMQVlFUl9OQU1FID0gJ3BsYXllci1uYW1lJztcclxuICAgIGV4cG9ydHMuUExBWUVSX09XTkVSID0gJ3BsYXllci1vd25lcic7XHJcbiAgICBleHBvcnRzLlBMQVlFUl9QUkVGSVggPSAncGxheWVyLXByb2ZpbGUtJztcclxuICAgIGV4cG9ydHMuU1VNTUFSWV9QUkVGSVggPSAnc3VtbWFyeS0nO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLnN1bW1hcnlTdGF0cyA9IFtcclxuICAgICAgICBbJ2FjdGl2ZScgICAgICAsIFwiY29uc3RhbnQtYWN0aXZlXCIgICBdLFxyXG4gICAgICAgIFsnZm9sbG93ZXInICAgICwgXCJjb25zdGFudC1mb2xsb3dlclwiIF0sXHJcbiAgICAgICAgWydkZWZlbnNpdmUnICAgLCBcImNvbnN0YW50LWRlZmVuc2l2ZVwiXSxcclxuICAgICAgICBbJ3Bhc3NpdmUnICAgICAsIFwiY29uc3RhbnQtcGFzc2l2ZVwiICBdLFxyXG4gICAgICAgIFsnY29tcGxldGVuZXNzJywgXCJwcm9maWxlLWZpbHRlci1jb21wbGV0ZW5lc3NcIl0sXHJcbiAgICAgICAgWyd0b3RhbFN0b3JpZXMnLCBcInByb2ZpbGUtZmlsdGVyLXRvdGFsU3Rvcmllc1wiXVxyXG4gICAgXTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5zb2NpYWxOZXR3b3JrT3B0cyA9IHtcclxuICAgICAgICBub2RlcyA6IHtcclxuICAgICAgICAgICAgc2hhcGUgOiAnZG90JyxcclxuICAgICAgICAgICAgc2NhbGluZyA6IHtcclxuICAgICAgICAgICAgICAgIG1pbiA6IDEwLFxyXG4gICAgICAgICAgICAgICAgbWF4IDogMzAsXHJcbiAgICAgICAgICAgICAgICBsYWJlbCA6IHtcclxuICAgICAgICAgICAgICAgICAgICBtaW4gOiA4LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1pbiA6IDQsXHJcbiAgICAgICAgICAgICAgICAgICAgbWF4IDogMzAsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbWF4IDogNTAsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJhd1RocmVzaG9sZCA6IDEyLFxyXG4gICAgICAgICAgICAgICAgICAgIGRyYXdUaHJlc2hvbGQgOiA1LFxyXG4gICAgICAgICAgICAgICAgICAgIG1heFZpc2libGUgOiAzMFxyXG4gICAgICAgICAgICAgICAgLy8gbWF4VmlzaWJsZSA6IDIwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGZvbnQgOiB7XHJcbiAgICAgICAgICAgICAgICAvLyBzaXplIDogMTIsXHJcbiAgICAgICAgICAgICAgICBzaXplIDogMjAsXHJcbiAgICAgICAgICAgICAgICBmYWNlIDogJ1RhaG9tYSdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZWRnZXMgOiB7XHJcbiAgICAgICAgICAgIHdpZHRoIDogMC4xNSxcclxuICAgICAgICAgICAgY29sb3IgOiB7XHJcbiAgICAgICAgICAgICAgICBpbmhlcml0IDogJ2Zyb20nXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNtb290aCA6IHtcclxuLy8gICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnY29udGludW91cydcclxuICAgICAgICAgICAgICAgIHR5cGUgOiAnZHluYW1pYydcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGh5c2ljcyA6IHtcclxuICAgICAgICAgICAgYmFybmVzSHV0IDoge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgZ3Jhdml0YXRpb25hbENvbnN0YW50IDogLTE1MDAwXHJcbiAgICAgICAgICAgICAgICBncmF2aXRhdGlvbmFsQ29uc3RhbnQgOiAtMzAwMDAsXHJcbi8vICAgICAgICAgICAgICAgICBncmF2aXRhdGlvbmFsQ29uc3RhbnQgOiAtNjAwMDBcclxuLy8gICAgICAgICAgICAgICAgICAgIHNwcmluZ0xlbmd0aDogMjAsXHJcbiAgICAgICAgICAgICAgICBzcHJpbmdDb25zdGFudDogMC4xXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHN0YWJpbGl6YXRpb24gOiB7XHJcbi8vICAgICAgICAgICAgICAgICAgICBpdGVyYXRpb25zIDogMjUwMFxyXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9ucyA6IDUwXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIC8vIHBoeXNpY3MgOiBmYWxzZSxcclxuICAgICAgICAvLyBsYXlvdXQgOiB0cnVlLFxyXG4gICAgICAgIGxheW91dCA6IHtcclxuICAgICAgICAgICAgcmFuZG9tU2VlZCA6IDEyMDBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGludGVyYWN0aW9uIDoge1xyXG4gICAgICAgICAgICB0b29sdGlwRGVsYXkgOiAyMDAsXHJcbiAgICAgICAgLy8gaGlkZUVkZ2VzT25EcmFnIDogdHJ1ZVxyXG4gICAgICAgIH0sXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBleHBvcnRzLmdyb3VwU2NoZW1hT3B0cyA9IHtcclxuICAgICAgICBub2RlcyA6IHtcclxuICAgICAgICAgICAgc2NhbGluZyA6IHtcclxuICAgICAgICAgICAgICAgIG1pbiA6IDEwLFxyXG4gICAgICAgICAgICAgICAgbWF4IDogMzAsXHJcbiAgICAgICAgICAgICAgICBsYWJlbCA6IHtcclxuICAgICAgICAgICAgICAgICAgICBtaW4gOiA4LFxyXG4gICAgICAgICAgICAgICAgICAgIG1heCA6IDMwLFxyXG4gICAgICAgICAgICAgICAgICAgIGRyYXdUaHJlc2hvbGQgOiA1LFxyXG4gICAgICAgICAgICAgICAgICAgIG1heFZpc2libGUgOiAzMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmb250IDoge1xyXG4gICAgICAgICAgICAgICAgc2l6ZSA6IDIwLFxyXG4gICAgICAgICAgICAgICAgZmFjZSA6ICdUYWhvbWEnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIG1hbmlwdWxhdGlvbiA6IGZhbHNlLFxyXG4gICAgICAgIGhlaWdodCA6ICc5MCUnLFxyXG4gICAgICAgIGxheW91dCA6IHtcclxuICAgICAgICAgICAgaGllcmFyY2hpY2FsIDoge1xyXG4gICAgICAgICAgICAgICAgZW5hYmxlZCA6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBsZXZlbFNlcGFyYXRpb24gOiAyMDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGh5c2ljcyA6IHtcclxuICAgICAgICAgICAgaGllcmFyY2hpY2FsUmVwdWxzaW9uIDoge1xyXG4gICAgICAgICAgICAgICAgbm9kZURpc3RhbmNlIDogMTQwXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBleHBvcnRzLmludmVzdGlnYXRpb25Cb2FyZE9wdHMgPSB7XHJcbiAgICAgICAgICAgIGVkZ2VzIDoge1xyXG4gICAgICAgICAgICAgICAgYXJyb3dzOid0bycsXHJcbiAgICAgICAgICAgICAgICB3aWR0aCA6IDAuNyxcclxuLy8gICAgICAgICAgICAgICAgd2lkdGggOiAwLjE1LFxyXG4vLyAgICAgICAgICAgICAgICBjb2xvciA6IHtcclxuLy8gICAgICAgICAgICAgICAgICAgIGluaGVyaXQgOiAnZnJvbSdcclxuLy8gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAnYmxhY2snLFxyXG4gICAgICAgICAgICAgICAgc21vb3RoIDoge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICdjb250aW51b3VzJ1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnZHluYW1pYydcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmb250OiB7YmFja2dyb3VuZDogJyMzM2NjY2MnLCBzdHJva2VXaWR0aDogMH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ3JvdXBzIDoge1xyXG4gICAgICAgICAgICAgICAgZ3JvdXBzOiB7Y29sb3I6e2JhY2tncm91bmQ6JyNmZmNjMDAnLCBib3JkZXI6ICcjYTc4OTEyJ30sIGJvcmRlcldpZHRoOjEsIHNoYXBlOiAnYm94J30sXHJcbiAgICAgICAgICAgICAgICByZXNvdXJjZXM6IHtjb2xvcjp7YmFja2dyb3VuZDonIzk5Y2MwMCcsIGJvcmRlcjogJyM4MzkxNTknfSwgYm9yZGVyV2lkdGg6MSwgc2hhcGU6ICdlbGxpcHNlJ31cclxuLy8gICAgICAgICAgICAgICAgIC0gZWRnZSBsYWJlbCBiYWNrXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHBoeXNpY3MgOiB7XHJcbiAgICAgICAgICAgICAgICBiYXJuZXNIdXQgOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZ3Jhdml0YXRpb25hbENvbnN0YW50IDogLTIwMDAsXHJcbi8vICAgICAgICAgICAgICAgICAgICAgICAgZ3Jhdml0YXRpb25hbENvbnN0YW50IDogLTE1MDAwLFxyXG4vLyAgICAgICAgICAgICAgICAgICAgZ3Jhdml0YXRpb25hbENvbnN0YW50IDogLTMwMDAwLFxyXG4vLyAgICAgICAgICAgICAgICAgICAgIGdyYXZpdGF0aW9uYWxDb25zdGFudCA6IC02MDAwMCxcclxuLy8gICAgICAgICAgICAgICAgICAgICAgICBzcHJpbmdMZW5ndGg6IDIwLFxyXG4vLyAgICAgICAgICAgICAgICAgICAgc3ByaW5nQ29uc3RhbnQ6IDAuMSxcclxuICAgICAgICAgICAgICAgICAgICBhdm9pZE92ZXJsYXA6IDAuNCxcclxuLy8gICAgICAgICAgICAgICAgICAgIGF2b2lkT3ZlcmxhcDogMC42LFxyXG4vLyAgICAgICAgICAgICAgICAgICAgc3ByaW5nTGVuZ3RoOiAzMDAsXHJcbiAgICAgICAgICAgICAgICAgICAgc3ByaW5nTGVuZ3RoOiAxMjAsXHJcbiAgICAgICAgICAgICAgICAgICAgY2VudHJhbEdyYXZpdHk6IDAuOCxcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzdGFiaWxpemF0aW9uIDoge1xyXG4vLyAgICAgICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnMgOiAyNTAwXHJcbiAgICAgICAgICAgICAgICAgICAgaXRlcmF0aW9ucyA6IDUwXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgdGltZXN0ZXA6IDAuM1xyXG4gICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgIHBoeXNpY3MgOiB7XHJcbi8vICAgICAgICAgICAgICAgIGVuYWJsZWQ6IGZhbHNlXHJcbi8vICAgICAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5zbkFjdGl2aXR5Q29sb3JzID0ge1xyXG4gICAgICAgICAgICBcImFjdGl2ZVwiOiBcInJlZFwiLCBcclxuICAgICAgICAgICAgXCJmb2xsb3dlclwiOiBcImJsdWVcIiwgXHJcbiAgICAgICAgICAgIFwiZGVmZW5zaXZlXCI6IFwiZ3JlZW5cIiwgXHJcbiAgICAgICAgICAgIFwicGFzc2l2ZVwiOiBcImdyZXlcIlxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgZXhwb3J0cy5zbkZvY3VzT3B0aW9ucyA9IHtcclxuICAgICAgICBzY2FsZSA6IDEuMixcclxuICAgICAgICBvZmZzZXQgOiB7XHJcbiAgICAgICAgICAgIHggOiAwLFxyXG4gICAgICAgICAgICB5IDogMFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgYW5pbWF0aW9uIDoge1xyXG4gICAgICAgICAgICBkdXJhdGlvbiA6IDEwMDAsXHJcbiAgICAgICAgICAgIGVhc2luZ0Z1bmN0aW9uIDogXCJlYXNlSW5PdXRRdWFkXCJcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBleHBvcnRzLnNuRml4ZWRDb2xvcnMgPSB7XHJcbiAgICAgICAgXCJzdG9yeUNvbG9yXCIgOiB7XHJcbiAgICAgICAgICAgIGNvbG9yIDoge1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZCA6ICdyZ2IoMjU1LDI1NSwwKScsXHJcbiAgICAgICAgICAgICAgICBib3JkZXIgOiAncmdiKDI1NSwxNjgsMyknXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFwibm9Hcm91cFwiIDoge1xyXG4gICAgICAgICAgICBjb2xvciA6IHtcclxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQgOiAncmdiKDE1MSwxOTQsMjUyKScsXHJcbiAgICAgICAgICAgICAgICBib3JkZXIgOiAncmdiKDQzLDEyNCwyMzMpJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcImZyb21Hcm91cFwiIDoge1xyXG4gICAgICAgICAgICBjb2xvciA6IHtcclxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQgOiAnIzdCRTE0MScsXHJcbiAgICAgICAgICAgICAgICBib3JkZXIgOiAnIzQxQTkwNidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgXCJ0aGlyZERlZ3JlZU5vZGVcIiA6IHtcclxuICAgICAgICAgICAgY29sb3IgOiB7XHJcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kIDogJ3JnYmEoMjAwLDIwMCwyMDAsMC41KScsXHJcbiAgICAgICAgICAgICAgICBib3JkZXIgOiAncmdiYSgyMDAsMjAwLDIwMCwwLjUpJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICBcInNlY29uZERlZ3JlZU5vZGVcIiA6IHtcclxuICAgICAgICAgICAgY29sb3IgOiB7XHJcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kIDogJ3JnYmEoMTUwLDE1MCwxNTAsMC43NSknLFxyXG4gICAgICAgICAgICAgICAgYm9yZGVyIDogJ3JnYmEoMTUwLDE1MCwxNTAsMC43NSknXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIFwiZmlyc3REZWdyZWVOb2RlXCIgOiB7XHJcbiAgICAgICAgICAgIGNvbG9yIDoge1xyXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZCA6ICdyZ2IoMTUxLDE5NCwyNTIpJyxcclxuICAgICAgICAgICAgICAgIGJvcmRlciA6ICdyZ2IoNDMsMTI0LDIzMyknXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcblxyXG4gICAgZXhwb3J0cy52aXNMb2NhbGVzID0ge1xyXG4gICAgICAgICdydScgOiB7XHJcbiAgICAgICAgICAgIGVkaXQgOiAn0KDQtdC00LDQutGC0LjRgNC+0LLQsNGC0YwnLFxyXG4gICAgICAgICAgICBkZWwgOiAn0KPQtNCw0LvQuNGC0Ywg0LLRi9Cx0YDQsNC90L3QvtC1JyxcclxuICAgICAgICAgICAgYmFjayA6ICfQndCw0LfQsNC0JyxcclxuICAgICAgICAgICAgYWRkTm9kZSA6ICfQlNC+0LHQsNCy0LjRgtGMINGD0LfQtdC7JyxcclxuICAgICAgICAgICAgYWRkRWRnZSA6ICfQlNC+0LHQsNCy0LjRgtGMINGA0LXQsdGA0L4nLFxyXG4gICAgICAgICAgICBlZGl0Tm9kZSA6ICfQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCDRg9C30LXQuycsXHJcbiAgICAgICAgICAgIGVkaXRFZGdlIDogJ9Cg0LXQtNCw0LrRgtC40YDQvtCy0LDRgtGMINGA0LXQsdGA0L4nLFxyXG4gICAgICAgICAgICBhZGREZXNjcmlwdGlvbiA6ICfQmtC70LjQutC90LjRgtC1INCyINGB0LLQvtCx0L7QtNC90L7QtSDQvNC10YHRgtC+LCDRh9GC0L7QsdGLINC00L7QsdCw0LLQuNGC0Ywg0L3QvtCy0YvQuSDRg9C30LXQuy4nLFxyXG4gICAgICAgICAgICBlZGdlRGVzY3JpcHRpb24gOiAn0JrQu9C40LrQvdC40YLQtSDQvdCwINGD0LfQtdC7INC4INC/0YDQvtGC0Y/QvdC40YLQtSDRgNC10LHRgNC+INC6INC00YDRg9Cz0L7QvNGDINGD0LfQu9GDLCDRh9GC0L7QsdGLINGB0L7QtdC00LjQvdC40YLRjCDQuNGFLicsXHJcbiAgICAgICAgICAgIGVkaXRFZGdlRGVzY3JpcHRpb24gOiAn0JrQu9C40LrQvdC40YLQtSDQvdCwINC60L7QvdGC0YDQvtC70YzQvdGL0LUg0YLQvtGH0LrQuCDQuCDQv9C10YDQtdGC0LDRidC40YLQtSDQuNGFINC6INC00YDRg9Cz0L7QvNGDINGD0LfQu9GDLCDRh9GC0L7QsdGLINGB0L7QtdC00LjQvdC40YLRjCDRg9C30LvRiy4nLFxyXG4gICAgICAgICAgICBjcmVhdGVFZGdlRXJyb3IgOiAn0J3QtdCy0L7Qt9C80L7QttC90L4g0YHQvtC10LTQuNC90LjRgtGMINGA0LXQsdGA0LAg0LIg0LrQu9Cw0YHRgtC10YAuJyxcclxuICAgICAgICAgICAgZGVsZXRlQ2x1c3RlckVycm9yIDogJ9Ca0LvQsNGB0YLQtdGA0Ysg0L3QtSDQvNC+0LPRg9GCINCx0YvRgtGMINGD0LTQsNC70LXQvdGLJyxcclxuICAgICAgICAgICAgZWRpdENsdXN0ZXJFcnJvciA6ICfQmtC70LDRgdGC0LXRgNGLINC90LXQtNC+0YHRgtGD0L/QvdGLINC00LvRjyDRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QuNGPLidcclxuICAgICAgICB9LFxyXG4gICAgICAgICdlbic6e1xyXG4gICAgICAgICAgICBlZGl0OiAnRWRpdCcsXHJcbiAgICAgICAgICAgIGRlbDogJ0RlbGV0ZSBzZWxlY3RlZCcsXHJcbiAgICAgICAgICAgIGJhY2s6ICdCYWNrJyxcclxuICAgICAgICAgICAgYWRkTm9kZTogJ0FkZCBOb2RlJyxcclxuICAgICAgICAgICAgYWRkRWRnZTogJ0FkZCBFZGdlJyxcclxuICAgICAgICAgICAgZWRpdE5vZGU6ICdFZGl0IE5vZGUnLFxyXG4gICAgICAgICAgICBlZGl0RWRnZTogJ0VkaXQgRWRnZScsXHJcbiAgICAgICAgICAgIGFkZERlc2NyaXB0aW9uOiAnQ2xpY2sgaW4gYW4gZW1wdHkgc3BhY2UgdG8gcGxhY2UgYSBuZXcgbm9kZS4nLFxyXG4gICAgICAgICAgICBlZGdlRGVzY3JpcHRpb246ICdDbGljayBvbiBhIG5vZGUgYW5kIGRyYWcgdGhlIGVkZ2UgdG8gYW5vdGhlciBub2RlIHRvIGNvbm5lY3QgdGhlbS4nLFxyXG4gICAgICAgICAgICBlZGl0RWRnZURlc2NyaXB0aW9uOiAnQ2xpY2sgb24gdGhlIGNvbnRyb2wgcG9pbnRzIGFuZCBkcmFnIHRoZW0gdG8gYSBub2RlIHRvIGNvbm5lY3QgdG8gaXQuJyxcclxuICAgICAgICAgICAgY3JlYXRlRWRnZUVycm9yOiAnQ2Fubm90IGxpbmsgZWRnZXMgdG8gYSBjbHVzdGVyLicsXHJcbiAgICAgICAgICAgIGRlbGV0ZUNsdXN0ZXJFcnJvcjogJ0NsdXN0ZXJzIGNhbm5vdCBiZSBkZWxldGVkLicsXHJcbiAgICAgICAgICAgIGVkaXRDbHVzdGVyRXJyb3I6ICdDbHVzdGVycyBjYW5ub3QgYmUgZWRpdGVkLidcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBleHBvcnRzLnZpc0xvY2FsZXNbJ2VuX0VOJ10gPSBleHBvcnRzLnZpc0xvY2FsZXNbJ2VuJ107XHJcbiAgICBleHBvcnRzLnZpc0xvY2FsZXNbJ2VuX1VTJ10gPSBleHBvcnRzLnZpc0xvY2FsZXNbJ2VuJ107XHJcbiAgICBleHBvcnRzLnZpc0xvY2FsZXNbJ3J1X1JVJ10gPSBleHBvcnRzLnZpc0xvY2FsZXNbJ3J1J107XHJcbiAgICBcclxuICAgIGV4cG9ydHMuaHR0cFRpbWVvdXQgPSA1MDAwO1xyXG4gICAgXHJcbn0pKHR5cGVvZiBleHBvcnRzID09PSAndW5kZWZpbmVkJz8gdGhpc1snQ29uc3RhbnRzJ109e306IGV4cG9ydHMpO1xyXG5cclxuIiwiLypDb3B5cmlnaHQgMjAxNSBUaW1vZmV5IFJlY2hrYWxvdiA8bnRzZGtAeWFuZGV4LnJ1PiwgTWFyaWEgU2lkZWtobWVub3ZhIDxtYXRpbGRhX0BsaXN0LnJ1PlxyXG5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuXHJcbmh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLiAqL1xyXG5cclxuLypcclxuICovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxuKGZ1bmN0aW9uKGV4cG9ydHMpe1xyXG5cclxuICAgIGZ1bmN0aW9uIFZhbGlkYXRpb25FcnJvcihtZXNzYWdlSWQsIHBhcmFtZXRlcnMpIHtcclxuICAgICAgRXJyb3IuY2FsbCh0aGlzLCBhcmd1bWVudHMpIDtcclxuICAgICAgdGhpcy5uYW1lID0gXCJWYWxpZGF0aW9uRXJyb3JcIjtcclxuICAgIFxyXG4gICAgICB0aGlzLm1lc3NhZ2VJZCA9IG1lc3NhZ2VJZDtcclxuICAgICAgdGhpcy5wYXJhbWV0ZXJzID0gcGFyYW1ldGVycztcclxuICAgIFxyXG4gICAgICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcclxuICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBWYWxpZGF0aW9uRXJyb3IpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuc3RhY2sgPSAobmV3IEVycm9yKCkpLnN0YWNrO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBWYWxpZGF0aW9uRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLlZhbGlkYXRpb25FcnJvciA9IFZhbGlkYXRpb25FcnJvcjtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gSW50ZXJuYWxFcnJvcihtZXNzYWdlSWQsIHBhcmFtZXRlcnMpIHtcclxuICAgICAgICBFcnJvci5jYWxsKHRoaXMsIGFyZ3VtZW50cykgO1xyXG4gICAgICAgIHRoaXMubmFtZSA9IFwiSW50ZXJuYWxFcnJvclwiO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMubWVzc2FnZUlkID0gbWVzc2FnZUlkO1xyXG4gICAgICAgIHRoaXMucGFyYW1ldGVycyA9IHBhcmFtZXRlcnM7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XHJcbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIEludGVybmFsRXJyb3IpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhY2sgPSAobmV3IEVycm9yKCkpLnN0YWNrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIEludGVybmFsRXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgXHJcbiAgICBleHBvcnRzLkludGVybmFsRXJyb3IgPSBJbnRlcm5hbEVycm9yO1xyXG5cclxufSkodHlwZW9mIGV4cG9ydHMgPT09ICd1bmRlZmluZWQnPyB0aGlzWydFcnJvcnMnXT17fTogZXhwb3J0cyk7IiwiLypDb3B5cmlnaHQgMjAxNSBUaW1vZmV5IFJlY2hrYWxvdiA8bnRzZGtAeWFuZGV4LnJ1PiwgTWFyaWEgU2lkZWtobWVub3ZhIDxtYXRpbGRhX0BsaXN0LnJ1PlxyXG5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxueW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG5Zb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuXHJcbmh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG5kaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbldJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG5TZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLiAqL1xyXG5cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4oZnVuY3Rpb24oY2FsbGJhY2spe1xyXG4gICAgICAgIFxyXG4gICAgZnVuY3Rpb24gQ29tbW9uVXRpbHMoZXhwb3J0cywgUiwgQ29uc3RhbnRzLCBFcnJvcnMpIHtcclxuICAgIFxyXG4gICAgICAgIGV4cG9ydHMuc3RhcnRzV2l0aCA9IGZ1bmN0aW9uKHN0cjEsIHN0cjIpe1xyXG4gICAgICAgICAgICByZXR1cm4gc3RyMS5zdWJzdHJpbmcoMCwgc3RyMi5sZW5ndGgpID09PSBzdHIyO1xyXG4gICAgICAgIH07XHJcbiAgICBcclxuICAgICAgICBleHBvcnRzLnJlbW92ZUZyb21BcnJheUJ5SW5kZXggPSBmdW5jdGlvbihhcnJheSwgZnJvbSwgdG8pIHtcclxuICAgICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgICAgIHZhciByZXN0ID0gYXJyYXkuc2xpY2UoKHRvIHx8IGZyb20pICsgMSB8fCBhcnJheS5sZW5ndGgpO1xyXG4gICAgICAgICAgICBhcnJheS5sZW5ndGggPSBmcm9tIDwgMCA/IGFycmF5Lmxlbmd0aCArIGZyb20gOiBmcm9tO1xyXG4gICAgICAgICAgICByZXR1cm4gYXJyYXkucHVzaC5hcHBseShhcnJheSwgcmVzdCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmNoYXJPcmRBRmFjdG9yeUJhc2UgPSBSLmN1cnJ5KGZ1bmN0aW9uKHNvcnREaXIsIHByZXBhcmUpe1xyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICAgICAgYSA9IHByZXBhcmUoYSk7XHJcbiAgICAgICAgICAgICAgICBiID0gcHJlcGFyZShiKTtcclxuICAgICAgICAgICAgICAgIGlmKFIuaXNOaWwoYSkgJiYgUi5pc05pbChiKSkgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICBpZihSLmlzTmlsKGEpKSByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgIGlmKFIuaXNOaWwoYikpIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChhID4gYilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc29ydERpciA9PT0gXCJhc2NcIiA/IDEgOiAtMTtcclxuICAgICAgICAgICAgICAgIGlmIChhIDwgYilcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc29ydERpciA9PT0gXCJhc2NcIiA/IC0xIDogMTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuY2hhck9yZEFGYWN0b3J5ID0gZXhwb3J0cy5jaGFyT3JkQUZhY3RvcnlCYXNlKCdhc2MnKTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmNoYXJPcmRBID0gZXhwb3J0cy5jaGFyT3JkQUZhY3RvcnkoZnVuY3Rpb24oYSl7cmV0dXJuIGEudG9Mb3dlckNhc2UoKTt9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmV2ZW50c0J5VGltZSA9IGV4cG9ydHMuY2hhck9yZEFGYWN0b3J5KGZ1bmN0aW9uKGEpe3JldHVybiBuZXcgRGF0ZShhLnRpbWUpO30pO1xyXG4gICAgXHJcbiAgICAgICAgZXhwb3J0cy5zdHJGb3JtYXQgPSBmdW5jdGlvbihzdHIsIHZhbHMpe1xyXG4gICAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXHtcXHt8XFx9XFx9fFxceyhcXGQrKVxcfS9nLCBmdW5jdGlvbiAobSwgbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKG0gPT0gXCJ7e1wiKSB7IHJldHVybiBcIntcIjsgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG0gPT0gXCJ9fVwiKSB7IHJldHVybiBcIn1cIjsgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHNbbl07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5jb25zb2xlTG9nID0gZnVuY3Rpb24oc3RyKXtcclxuICAgICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmNsb25lID0gZnVuY3Rpb24obykge1xyXG4gICAgICAgICAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgICAgICAgICAgaWYgKCFvIHx8ICdvYmplY3QnICE9PSB0eXBlb2Ygbykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG87XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGMgPSAnZnVuY3Rpb24nID09PSB0eXBlb2Ygby5wb3AgPyBbXSA6IHt9O1xyXG4gICAgICAgICAgICB2YXIgcCwgdjtcclxuICAgICAgICAgICAgZm9yIChwIGluIG8pIHtcclxuICAgICAgICAgICAgICAgIGlmIChvLmhhc093blByb3BlcnR5KHApKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdiA9IG9bcF07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHYgJiYgJ29iamVjdCcgPT09IHR5cGVvZiB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNbcF0gPSBleHBvcnRzLmNsb25lKHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNbcF0gPSB2O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gYztcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBwcmVnX3F1b3RlID0gZnVuY3Rpb24gKHN0ciwgZGVsaW1pdGVyKSB7XHJcbiAgICAgICAgICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgICAgICAgICAvLyBodHRwOi8va2V2aW4udmFuem9ubmV2ZWxkLm5ldFxyXG4gICAgICAgICAgICAvLyArIG9yaWdpbmFsIGJ5OiBib29leU9IXHJcbiAgICAgICAgICAgIC8vICsgaW1wcm92ZWQgYnk6IEF0ZXMgR29yYWwgKGh0dHA6Ly9tYWduZXRpcS5jb20pXHJcbiAgICAgICAgICAgIC8vICsgaW1wcm92ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxyXG4gICAgICAgICAgICAvLyArIGJ1Z2ZpeGVkIGJ5OiBPbm5vIE1hcnNtYW5cclxuICAgICAgICAgICAgLy8gKyBpbXByb3ZlZCBieTogQnJldHQgWmFtaXIgKGh0dHA6Ly9icmV0dC16YW1pci5tZSlcclxuICAgICAgICAgICAgLy8gKiBleGFtcGxlIDE6IHByZWdfcXVvdGUoXCIkNDBcIik7XHJcbiAgICAgICAgICAgIC8vICogcmV0dXJucyAxOiAnXFwkNDAnXHJcbiAgICAgICAgICAgIC8vICogZXhhbXBsZSAyOiBwcmVnX3F1b3RlKFwiKlJSUklORyogSGVsbG8/XCIpO1xyXG4gICAgICAgICAgICAvLyAqIHJldHVybnMgMjogJ1xcKlJSUklOR1xcKiBIZWxsb1xcPydcclxuICAgICAgICAgICAgLy8gKiBleGFtcGxlIDM6IHByZWdfcXVvdGUoXCJcXFxcLisqP1teXSQoKXt9PSE8Pnw6XCIpO1xyXG4gICAgICAgICAgICAvLyAqIHJldHVybnMgMzogJ1xcXFxcXC5cXCtcXCpcXD9cXFtcXF5cXF1cXCRcXChcXClcXHtcXH1cXD1cXCFcXDxcXD5cXHxcXDonXHJcbiAgICAgICAgICAgIHJldHVybiAoc3RyICsgJycpLnJlcGxhY2UobmV3IFJlZ0V4cCgnWy5cXFxcXFxcXCsqP1xcXFxbXFxcXF5cXFxcXSQoKXt9PSE8Pnw6XFxcXCdcclxuICAgICAgICAgICAgICAgICAgICArIChkZWxpbWl0ZXIgfHwgJycpICsgJy1dJywgJ2cnKSwgJ1xcXFwkJicpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5nbG9iU3RyaW5nVG9SZWdleCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgICAgICAgICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVnRXhwKHByZWdfcXVvdGUoc3RyKS5yZXBsYWNlKC9cXFxcXFwqL2csICcuKicpLnJlcGxhY2UoXHJcbiAgICAgICAgICAgICAgICAgICAgL1xcXFxcXD8vZywgJy4nKSwgJ2cnKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHRha2VuIGZyb20gTUROIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvR3VpZGUvUmVndWxhcl9FeHByZXNzaW9uc1xyXG4gICAgICAgIGV4cG9ydHMuZXNjYXBlUmVnRXhwID0gZnVuY3Rpb24oc3RyaW5nKXtcclxuICAgICAgICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTsgLy8gJCYgbWVhbnMgdGhlIHdob2xlIG1hdGNoZWQgc3RyaW5nXHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmFycjJtYXAgPSBmdW5jdGlvbihhcnJheSwga2V5KXtcclxuICAgICAgICAgICAgcmV0dXJuIGFycmF5LnJlZHVjZShmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICBhW2Jba2V5XV0gPSBiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XHJcbiAgICAgICAgICAgIH0sIHt9KTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuYWNjZXB0RGF0YVJvdyA9IFIuY3VycnkoZnVuY3Rpb24gKG1vZGVsLCBkYXRhU3RyaW5nKSB7XHJcbiAgICAgICAgICAgIHZhciB2YWx1ZSwgcmVnZXgsIHJlc3VsdDtcclxuICAgICAgICAgICAgdmFyIGRhdGFNYXAgPSBleHBvcnRzLmFycjJtYXAoZGF0YVN0cmluZywgJ2l0ZW1OYW1lJyk7XHJcbiAgICAgICAgICAgIHJldHVybiBtb2RlbC5ldmVyeShmdW5jdGlvbihmaWx0ZXJJdGVtKXtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFNYXBbZmlsdGVySXRlbS5uYW1lXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChmaWx0ZXJJdGVtLnR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJlbnVtXCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiY2hlY2tib3hcIjpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbHRlckl0ZW0uc2VsZWN0ZWRPcHRpb25zW3ZhbHVlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwibXVsdGlFbnVtXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlcyA9IHZhbHVlID09PSAnJyA/IFtdIDogdmFsdWUuc3BsaXQoJywnKTtcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGZpbHRlckl0ZW0uY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImV2ZXJ5XCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKFIua2V5cyhmaWx0ZXJJdGVtLnNlbGVjdGVkT3B0aW9ucykubGVuZ3RoID09PSAwKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gUi5kaWZmZXJlbmNlKFIua2V5cyhmaWx0ZXJJdGVtLnNlbGVjdGVkT3B0aW9ucyksIHZhbHVlcykubGVuZ3RoID09PSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJzb21lXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFIuZGlmZmVyZW5jZSh2YWx1ZXMsICBSLmtleXMoZmlsdGVySXRlbS5zZWxlY3RlZE9wdGlvbnMpKS5sZW5ndGggIT09IHZhbHVlcy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJlcXVhbFwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBSLnN5bW1ldHJpY0RpZmZlcmVuY2UodmFsdWVzLCAgUi5rZXlzKGZpbHRlckl0ZW0uc2VsZWN0ZWRPcHRpb25zKSkubGVuZ3RoID09PSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAnVW5leHBlY3RlZCBjb25kaXRpb24gJyArIGZpbHRlckl0ZW0uY29uZGl0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJudW1iZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGZpbHRlckl0ZW0uY29uZGl0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImdyZWF0ZXJcIjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUgPiBmaWx0ZXJJdGVtLm51bTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImVxdWFsXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHZhbHVlID09PSBmaWx0ZXJJdGVtLm51bTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImxlc3NlclwiOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSB2YWx1ZSA8IGZpbHRlckl0ZW0ubnVtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAnVW5leHBlY3RlZCBjb25kaXRpb24gJyArIGZpbHRlckl0ZW0uY29uZGl0aW9uO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwic3RyaW5nXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKGZpbHRlckl0ZW0ucmVnZXhTdHJpbmcudG9Mb3dlckNhc2UoKSkgIT0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCB0eXBlICcgKyBmaWx0ZXJJdGVtLnR5cGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5tYWtlR3JvdXBlZFByb2ZpbGVGaWx0ZXJJbmZvID0gZnVuY3Rpb24ob3B0cyl7XHJcbiAgICAgICAgICAgIHZhciBncm91cGVkUHJvZmlsZUZpbHRlckl0ZW1zID0gW107XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcclxuICAgICAgICAgICAgYXJyLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZSA6IENvbnN0YW50cy5DSEFSX05BTUUsXHJcbiAgICAgICAgICAgICAgICB0eXBlIDogXCJzdHJpbmdcIixcclxuICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lIDogXCJwcm9maWxlLWZpbHRlci1jaGFyYWN0ZXJcIixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGFyci5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG5hbWUgOiBDb25zdGFudHMuQ0hBUl9PV05FUixcclxuICAgICAgICAgICAgICAgIHR5cGUgOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgOiBcInByb2ZpbGUtZmlsdGVyLWNoYXJhY3Rlci1vd25lclwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXJyID0gYXJyLmNvbmNhdChvcHRzLmNoYXJhY3RlcnMucHJvZmlsZVN0cnVjdHVyZS5tYXAoZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IENvbnN0YW50cy5DSEFSX1BSRUZJWCArIGVsZW1lbnQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBlbGVtZW50LnR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlzcGxheU5hbWU6IGVsZW1lbnQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogZWxlbWVudC52YWx1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgICAgIGdyb3VwZWRQcm9maWxlRmlsdGVySXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnY2hhcmFjdGVyRmlsdGVySXRlbXMnLFxyXG4gICAgICAgICAgICAgICAgcHJvZmlsZUZpbHRlckl0ZW1zOiBhcnJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhcnIgPSBbXTtcclxuICAgICAgICAgICAgYXJyLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgbmFtZSA6IENvbnN0YW50cy5QTEFZRVJfTkFNRSxcclxuICAgICAgICAgICAgICAgIHR5cGUgOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgOiBcInByb2ZpbGUtZmlsdGVyLXBsYXllci1uYW1lXCIsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBhcnIucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lIDogQ29uc3RhbnRzLlBMQVlFUl9PV05FUixcclxuICAgICAgICAgICAgICAgIHR5cGUgOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICAgICAgZGlzcGxheU5hbWUgOiBcInByb2ZpbGUtZmlsdGVyLXBsYXllci1vd25lclwiLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXJyID0gYXJyLmNvbmNhdChvcHRzLnBsYXllcnMucHJvZmlsZVN0cnVjdHVyZS5tYXAoZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IENvbnN0YW50cy5QTEFZRVJfUFJFRklYICsgZWxlbWVudC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGVsZW1lbnQudHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBkaXNwbGF5TmFtZTogZWxlbWVudC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbGVtZW50LnZhbHVlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgZ3JvdXBlZFByb2ZpbGVGaWx0ZXJJdGVtcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdwbGF5ZXJGaWx0ZXJJdGVtcycsXHJcbiAgICAgICAgICAgICAgICBwcm9maWxlRmlsdGVySXRlbXM6IGFyclxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGFyciA9IENvbnN0YW50cy5zdW1tYXJ5U3RhdHMubWFwKGZ1bmN0aW9uKHN0YXQpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBDb25zdGFudHMuU1VNTUFSWV9QUkVGSVggKyBzdGF0WzBdLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGRpc3BsYXlOYW1lOiBzdGF0WzFdLFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGdyb3VwZWRQcm9maWxlRmlsdGVySXRlbXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnc3VtbWFyeUZpbHRlckl0ZW1zJyxcclxuICAgICAgICAgICAgICAgIHByb2ZpbGVGaWx0ZXJJdGVtczogYXJyXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBvcHRzLmdyb3VwZWRQcm9maWxlRmlsdGVySXRlbXMgPSBncm91cGVkUHJvZmlsZUZpbHRlckl0ZW1zO1xyXG4gICAgICAgICAgICByZXR1cm4gb3B0cztcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBnZXRDaGFyYWN0ZXJJbmZvVmFsdWUgPSBmdW5jdGlvbihpbmZvLCBjaGFyYWN0ZXJOYW1lLCBwcm9maWxlSXRlbU5hbWUpe1xyXG4gICAgICAgICAgICBpZihwcm9maWxlSXRlbU5hbWUgPT0gQ29uc3RhbnRzLkNIQVJfTkFNRSl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hhcmFjdGVyTmFtZTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKHByb2ZpbGVJdGVtTmFtZSA9PSBDb25zdGFudHMuQ0hBUl9PV05FUil7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5mby5jaGFyYWN0ZXJzLm93bmVyc1tjaGFyYWN0ZXJOYW1lXTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKGV4cG9ydHMuc3RhcnRzV2l0aChwcm9maWxlSXRlbU5hbWUsIENvbnN0YW50cy5TVU1NQVJZX1BSRUZJWCkgKXtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbmZvLmNoYXJhY3RlcnNTdW1tYXJ5W2NoYXJhY3Rlck5hbWVdW3Byb2ZpbGVJdGVtTmFtZS5zdWJzdHJpbmcoQ29uc3RhbnRzLlNVTU1BUllfUFJFRklYLmxlbmd0aCldO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYoZXhwb3J0cy5zdGFydHNXaXRoKHByb2ZpbGVJdGVtTmFtZSwgQ29uc3RhbnRzLkNIQVJfUFJFRklYKSApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZm8uY2hhcmFjdGVycy5wcm9maWxlc1tjaGFyYWN0ZXJOYW1lXVtwcm9maWxlSXRlbU5hbWUuc3Vic3RyaW5nKENvbnN0YW50cy5DSEFSX1BSRUZJWC5sZW5ndGgpXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCBwcm9maWxlSXRlbU5hbWU6ICcgKyBwcm9maWxlSXRlbU5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgZ2V0Q2hhcmFjdGVySW5mb1ZhbHVlMiA9IGZ1bmN0aW9uKGluZm8sIHByb2ZpbGVJZCwgcHJvZmlsZUl0ZW1OYW1lKXtcclxuICAgICAgICAgICAgaWYgKHByb2ZpbGVJdGVtTmFtZSA9PSBDb25zdGFudHMuQ0hBUl9OQU1FIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2ZpbGVJdGVtTmFtZSA9PSBDb25zdGFudHMuQ0hBUl9PV05FUiB8fCBcclxuICAgICAgICAgICAgICAgICAgICBleHBvcnRzLnN0YXJ0c1dpdGgocHJvZmlsZUl0ZW1OYW1lLCBDb25zdGFudHMuU1VNTUFSWV9QUkVGSVgpIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuc3RhcnRzV2l0aChwcm9maWxlSXRlbU5hbWUsIENvbnN0YW50cy5DSEFSX1BSRUZJWCkpIHtcclxuICAgICAgICAgICAgICAgIGlmKHByb2ZpbGVJZFswXSA9PT0gJycpIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hhcmFjdGVyTmFtZSA9IHByb2ZpbGVJZFswXTtcclxuICAgICAgICAgICAgICAgIGlmKHByb2ZpbGVJdGVtTmFtZSA9PSBDb25zdGFudHMuQ0hBUl9OQU1FKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hhcmFjdGVyTmFtZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihwcm9maWxlSXRlbU5hbWUgPT0gQ29uc3RhbnRzLkNIQVJfT1dORVIpe1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbmZvLmNoYXJhY3RlcnMub3duZXJzW2NoYXJhY3Rlck5hbWVdO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmKGV4cG9ydHMuc3RhcnRzV2l0aChwcm9maWxlSXRlbU5hbWUsIENvbnN0YW50cy5TVU1NQVJZX1BSRUZJWCkgKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaW5mby5jaGFyYWN0ZXJzU3VtbWFyeVtjaGFyYWN0ZXJOYW1lXVtwcm9maWxlSXRlbU5hbWUuc3Vic3RyaW5nKENvbnN0YW50cy5TVU1NQVJZX1BSRUZJWC5sZW5ndGgpXTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihleHBvcnRzLnN0YXJ0c1dpdGgocHJvZmlsZUl0ZW1OYW1lLCBDb25zdGFudHMuQ0hBUl9QUkVGSVgpICl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZm8uY2hhcmFjdGVycy5wcm9maWxlc1tjaGFyYWN0ZXJOYW1lXVtwcm9maWxlSXRlbU5hbWUuc3Vic3RyaW5nKENvbnN0YW50cy5DSEFSX1BSRUZJWC5sZW5ndGgpXTtcclxuICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZihwcm9maWxlSXRlbU5hbWUgPT0gQ29uc3RhbnRzLlBMQVlFUl9OQU1FIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgIHByb2ZpbGVJdGVtTmFtZSA9PSBDb25zdGFudHMuUExBWUVSX09XTkVSIHx8IFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuc3RhcnRzV2l0aChwcm9maWxlSXRlbU5hbWUsIENvbnN0YW50cy5QTEFZRVJfUFJFRklYKSl7XHJcbiAgICAgICAgICAgICAgICBpZihwcm9maWxlSWRbMV0gPT09ICcnKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBsYXllck5hbWUgPSBwcm9maWxlSWRbMV07XHJcbiAgICAgICAgICAgICAgICBpZihwcm9maWxlSXRlbU5hbWUgPT0gQ29uc3RhbnRzLlBMQVlFUl9OQU1FKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxheWVyTmFtZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZihwcm9maWxlSXRlbU5hbWUgPT0gQ29uc3RhbnRzLlBMQVlFUl9PV05FUil7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZm8ucGxheWVycy5vd25lcnNbcGxheWVyTmFtZV07XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYoZXhwb3J0cy5zdGFydHNXaXRoKHByb2ZpbGVJdGVtTmFtZSwgQ29uc3RhbnRzLlBMQVlFUl9QUkVGSVgpICl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGluZm8ucGxheWVycy5wcm9maWxlc1twbGF5ZXJOYW1lXVtwcm9maWxlSXRlbU5hbWUuc3Vic3RyaW5nKENvbnN0YW50cy5QTEFZRVJfUFJFRklYLmxlbmd0aCldO1xyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVW5leHBlY3RlZCBwcm9maWxlSXRlbU5hbWU6ICcgKyBwcm9maWxlSXRlbU5hbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmdldERhdGFBcnJheSA9IFIuY3VycnkoZnVuY3Rpb24gKGluZm8sIHByb2ZpbGVJZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUi5mbGF0dGVuKGluZm8uZ3JvdXBlZFByb2ZpbGVGaWx0ZXJJdGVtcy5tYXAoUi5wcm9wKCdwcm9maWxlRmlsdGVySXRlbXMnKSkpLm1hcChmdW5jdGlvbihwcm9maWxlSXRlbUluZm8pe1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZ2V0Q2hhcmFjdGVySW5mb1ZhbHVlMihpbmZvLCBwcm9maWxlSWQsIHByb2ZpbGVJdGVtSW5mby5uYW1lKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHByb2ZpbGVJdGVtSW5mby50eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIGl0ZW1OYW1lOiBwcm9maWxlSXRlbUluZm8ubmFtZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmdldERhdGFBcnJheXMgPSBmdW5jdGlvbihpbmZvLCBmaWx0ZXJNb2RlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5mby5iaW5kaW5nRGF0YS5tYXAoZXhwb3J0cy5nZXREYXRhQXJyYXkoaW5mbykpLmZpbHRlcihleHBvcnRzLmFjY2VwdERhdGFSb3coZmlsdGVyTW9kZWwpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBmaW5kUHJvZmlsZVN0cnVjdHVyZUNvbmZsaWN0cyA9IGZ1bmN0aW9uKHByZWZpeCwgcHJvZmlsZVN0cnVjdHVyZSwgZmlsdGVyTW9kZWwpe1xyXG4gICAgICAgICAgICB2YXIgY29uZmxpY3RUeXBlcyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgcHJvZmlsZVBhcnQgPSBmaWx0ZXJNb2RlbC5maWx0ZXIoUi5jb21wb3NlKFIudGVzdChuZXcgUmVnRXhwKCdeJyArIHByZWZpeCkpLCBSLnByb3AoJ25hbWUnKSkpO1xyXG4gICAgICAgICAgICB2YXIgcHJvZmlsZVNldHRpbmdzTWFwID0gUi5pbmRleEJ5KFIucHJvcCgnbmFtZScpLCBwcm9maWxlU3RydWN0dXJlKTtcclxuICAgICAgICAgICAgcHJvZmlsZVBhcnQuZm9yRWFjaChmdW5jdGlvbihtb2RlbEl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1OYW1lID0gbW9kZWxJdGVtLm5hbWUuc3Vic3RyaW5nKHByZWZpeC5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVJdGVtID0gcHJvZmlsZVNldHRpbmdzTWFwW2l0ZW1OYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmKCFwcm9maWxlSXRlbSB8fCBwcm9maWxlSXRlbS50eXBlICE9PSBtb2RlbEl0ZW0udHlwZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmxpY3RUeXBlcy5wdXNoKGl0ZW1OYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihwcm9maWxlSXRlbS50eXBlID09PSAnZW51bScgfHwgcHJvZmlsZUl0ZW0udHlwZSA9PT0gJ211bHRpRW51bScpe1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9maWxlRW51bSA9IHByb2ZpbGVJdGVtLnZhbHVlLnNwbGl0KCcsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGVsRW51bSA9IE9iamVjdC5rZXlzKG1vZGVsSXRlbS5zZWxlY3RlZE9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKFIuZGlmZmVyZW5jZShtb2RlbEVudW0sIHByb2ZpbGVFbnVtKS5sZW5ndGggIT0gMCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmZsaWN0VHlwZXMucHVzaChpdGVtTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICByZXR1cm4gY29uZmxpY3RUeXBlcztcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuaXNGaWx0ZXJNb2RlbENvbXBhdGlibGVXaXRoUHJvZmlsZXMgPSBmdW5jdGlvbihwcm9maWxlU3RydWN0dXJlLCBmaWx0ZXJNb2RlbCl7XHJcbiAgICAgICAgICAgIHZhciBjaGFyQ29uZmxpY3RzID0gZmluZFByb2ZpbGVTdHJ1Y3R1cmVDb25mbGljdHMoQ29uc3RhbnRzLkNIQVJfUFJFRklYLCBwcm9maWxlU3RydWN0dXJlLmNoYXJhY3RlcnMsIGZpbHRlck1vZGVsKTtcclxuICAgICAgICAgICAgdmFyIHBsYXllckNvbmZsaWN0cyA9IGZpbmRQcm9maWxlU3RydWN0dXJlQ29uZmxpY3RzKENvbnN0YW50cy5QTEFZRVJfUFJFRklYLCBwcm9maWxlU3RydWN0dXJlLnBsYXllcnMsIGZpbHRlck1vZGVsKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNoYXJDb25mbGljdHMuY29uY2F0KHBsYXllckNvbmZsaWN0cyk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLm1ha2VWYWxpZGF0aW9uRXJyb3IgPSBmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgICBlcnIuc3BsaWNlKDAsIDAsIG51bGwpO1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IChGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5hcHBseShFcnJvcnMuVmFsaWRhdGlvbkVycm9yLCBlcnIpKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIHByZWNvbmRpdGlvbiBBUElcclxuICAgICAgICBleHBvcnRzLnByZWNvbmRpdGlvbiA9IFIuY3VycnkoZnVuY3Rpb24oY2hlY2ssIHJlamVjdCwgcmVzb2x2ZSl7XHJcbiAgICAgICAgICAgIHZhciBlcnIgPSBjaGVjaygpO1xyXG4gICAgICAgICAgICBpZihlcnIgPT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KGV4cG9ydHMubWFrZVZhbGlkYXRpb25FcnJvcihlcnIpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuY2hhaW5DaGVjayA9IFIuY3VycnkoZnVuY3Rpb24oYXJyKXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhcnIucmVkdWNlKGZ1bmN0aW9uKGVyciwgaXRlbSl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoZXJyKSByZXR1cm4gZXJyO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtKCk7XHJcbiAgICAgICAgICAgICAgICB9LCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuZWl0aGVyQ2hlY2sgPSBSLmN1cnJ5KGZ1bmN0aW9uKGZ1bmMxLCBmdW5jMil7XHJcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzMSA9IGZ1bmMxKCk7XHJcbiAgICAgICAgICAgICAgICBpZihyZXMxID09PSBudWxsKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciByZXMyID0gZnVuYzIoKTtcclxuICAgICAgICAgICAgICAgIGlmKHJlczIgPT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlczE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBwcmltaXRpdmUgcHJlY29uZGl0aW9uIGNoZWNrc1xyXG4gICAgICAgIHZhciBhcnJDb250YWluc0Vsc0NoZWNrID0gUi5jdXJyeShmdW5jdGlvbihtc2csIGVscywgdmFsdWVMaXN0KXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBkaWZmID0gUi5kaWZmZXJlbmNlKGVscywgdmFsdWVMaXN0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkaWZmLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBbbXNnLCBbSlNPTi5zdHJpbmdpZnkoZGlmZildXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuZWxlbWVudHNGcm9tRW51bSA9IGFyckNvbnRhaW5zRWxzQ2hlY2soJ2Vycm9ycy11bnN1cHBvcnRlZC10eXBlcy1pbi1saXN0Jyk7XHJcbiAgICAgICAgZXhwb3J0cy5lbnRpdGllc0V4aXN0ID0gYXJyQ29udGFpbnNFbHNDaGVjaygnZXJyb3JzLWVudGl0aWVzLWFyZS1ub3QtZXhpc3QnKTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgYXJyQ29udGFpbnNFbENoZWNrID0gUi5jdXJyeShmdW5jdGlvbihtc2csIGVsLCB2YWx1ZUxpc3Qpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFIuY29udGFpbnMoZWwsIHZhbHVlTGlzdCkgPyBudWxsIDogW21zZywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmVsZW1lbnRGcm9tRW51bSA9IGFyckNvbnRhaW5zRWxDaGVjaygnZXJyb3JzLXVuc3VwcG9ydGVkLXR5cGUtaW4tbGlzdCcpO1xyXG4gICAgICAgIGV4cG9ydHMuZW50aXR5RXhpc3RzID0gYXJyQ29udGFpbnNFbENoZWNrKCdlcnJvcnMtZW50aXR5LWlzLW5vdC1leGlzdCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuZW50aXR5SXNOb3RVc2VkID0gUi5jdXJyeShmdW5jdGlvbihlbCwgdmFsdWVMaXN0KXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhUi5jb250YWlucyhlbCwgdmFsdWVMaXN0KSA/IG51bGwgOiBbJ2Vycm9ycy1lbnRpdHktaXMtdXNlZCcsIFtlbF1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5pc1N0cmluZyA9IFIuY3VycnkoZnVuY3Rpb24oZWwpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFIuaXMoU3RyaW5nLCBlbCkgPyBudWxsIDogWydlcnJvcnMtYXJndW1lbnQtaXMtbm90LWEtc3RyaW5nJywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmlzRW1wdHlTdHJpbmcgPSBSLmN1cnJ5KGZ1bmN0aW9uKGVsKXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBSLmVxdWFscygnJywgZWwpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LWlzLW5vdC1lbXB0eS1zdHJpbmcnLCBbZWxdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuaXNOb3RFbXB0eVN0cmluZyA9IFIuY3VycnkoZnVuY3Rpb24oZWwpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFSLmVxdWFscygnJywgZWwpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LWlzLWVtcHR5LXN0cmluZycsIFtlbF1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5uYW1lSXNOb3RFbXB0eSA9IFIuY3VycnkoZnVuY3Rpb24oZWwpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICFSLmVxdWFscygnJywgZWwpID8gbnVsbCA6IFsnZXJyb3JzLW5hbWUtaXMtZW1wdHktc3RyaW5nJywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmlzQXJyYXkgPSBSLmN1cnJ5KGZ1bmN0aW9uKGVsKXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBSLmlzKEFycmF5LCBlbCkgPyBudWxsIDogWydlcnJvcnMtYXJndW1lbnQtaXMtbm90LWFuLWFycmF5JywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmlzT2JqZWN0ID0gUi5jdXJyeShmdW5jdGlvbihlbCl7XHJcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUi5pcyhPYmplY3QsIGVsKSA/IG51bGwgOiBbJ2Vycm9ycy1hcmd1bWVudC1pcy1ub3QtYW4tb2JqZWN0JywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmlzQm9vbGVhbiA9IFIuY3VycnkoZnVuY3Rpb24oZWwpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFIuaXMoQm9vbGVhbiwgZWwpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LWlzLW5vdC1hLWJvb2xlYW4nLCBbZWxdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuaXNOdW1iZXIgPSBSLmN1cnJ5KGZ1bmN0aW9uKGVsKXtcclxuICAgICAgICAgICAgcmV0dXJuICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBSLmlzKE51bWJlciwgZWwpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LWlzLW5vdC1hLW51bWJlcicsIFtlbF1dO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5pc05pbCA9IFIuY3VycnkoZnVuY3Rpb24oZWwpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFIuaXNOaWwoZWwpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LWlzLW5vdC1uaWwnLCBbZWxdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMubmlsID0gUi5jdXJyeShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLm5vdEVxdWFscyA9IFIuY3VycnkoZnVuY3Rpb24oZWwsIGVsMil7XHJcbiAgICAgICAgICAgIHJldHVybiAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gIVIuZXF1YWxzKGVsLCBlbDIpID8gbnVsbCA6IFsnZXJyb3JzLWFyZ3VtZW50LW11c3Qtbm90LWJlLWVxdWFsJywgW2VsXV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLmlzSW5SYW5nZSA9IFIuY3VycnkoZnVuY3Rpb24oZWwsIGxvdywgdXApe1xyXG4gICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvdyA8PSBlbCAmJiBlbCA8PSB1cCA/IG51bGwgOiBbJ2Vycm9ycy1hcmd1bWVudC1pcy1ub3QtaW4tcmFuZ2UnLCBbZWwsIGxvdywgdXBdXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuY3JlYXRlRW50aXR5Q2hlY2sgPSBSLmN1cnJ5KGZ1bmN0aW9uKGVudGl0eU5hbWUsIGVudGl0eUxpc3Qpe1xyXG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5jaGFpbkNoZWNrKFtleHBvcnRzLmlzU3RyaW5nKGVudGl0eU5hbWUpLCBleHBvcnRzLm5hbWVJc05vdEVtcHR5KGVudGl0eU5hbWUpLCBleHBvcnRzLmVudGl0eUlzTm90VXNlZChlbnRpdHlOYW1lLCBlbnRpdHlMaXN0KV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuZW50aXR5RXhpc3RzQ2hlY2sgPSBleHBvcnRzLnJlbW92ZUVudGl0eUNoZWNrID0gUi5jdXJyeShmdW5jdGlvbihlbnRpdHlOYW1lLCBlbnRpdHlMaXN0KXtcclxuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuY2hhaW5DaGVjayhbZXhwb3J0cy5pc1N0cmluZyhlbnRpdHlOYW1lKSwgZXhwb3J0cy5lbnRpdHlFeGlzdHMoZW50aXR5TmFtZSwgZW50aXR5TGlzdCldKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBleHBvcnRzLnJlbmFtZUVudGl0eUNoZWNrID0gUi5jdXJyeShmdW5jdGlvbihmcm9tTmFtZSwgdG9OYW1lLCBlbnRpdHlMaXN0KXtcclxuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuY2hhaW5DaGVjayhbZXhwb3J0cy5yZW1vdmVFbnRpdHlDaGVjayhmcm9tTmFtZSwgZW50aXR5TGlzdCksIGV4cG9ydHMuY3JlYXRlRW50aXR5Q2hlY2sodG9OYW1lLCBlbnRpdHlMaXN0KV0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGV4cG9ydHMuc3dpdGNoRW50aXR5Q2hlY2sgPSBSLmN1cnJ5KGZ1bmN0aW9uKGVudGl0eTEsIGVudGl0eTIsIGVudGl0eUxpc3QsIGVudGl0eUNvbnRhaW5lckxpc3Qpe1xyXG4gICAgICAgICAgICByZXR1cm4gZXhwb3J0cy5jaGFpbkNoZWNrKFtleHBvcnRzLmVudGl0eUV4aXN0c0NoZWNrKGVudGl0eTEsIGVudGl0eUxpc3QpLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5lbnRpdHlFeGlzdHNDaGVjayhlbnRpdHkyLCBlbnRpdHlMaXN0KSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0cy5lbnRpdHlFeGlzdHMoZW50aXR5MSwgZW50aXR5Q29udGFpbmVyTGlzdCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cG9ydHMuZW50aXR5SXNOb3RVc2VkKGVudGl0eTIsIGVudGl0eUNvbnRhaW5lckxpc3QpXSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZXhwb3J0cy5nZXRWYWx1ZUNoZWNrID0gZnVuY3Rpb24odHlwZSl7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFwiY2hlY2tib3hcIjpcclxuICAgICAgICAgICAgICAgIHJldHVybiBleHBvcnRzLmlzQm9vbGVhbjtcclxuICAgICAgICAgICAgY2FzZSBcIm51bWJlclwiOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuaXNOdW1iZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGV4cG9ydHMuaXNTdHJpbmc7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gICAgY2FsbGJhY2soQ29tbW9uVXRpbHMpO1xyXG5cclxufSkoZnVuY3Rpb24oYXBpKXtcclxuICAgIHR5cGVvZiBleHBvcnRzID09PSAndW5kZWZpbmVkJz8gYXBpKHRoaXNbJ0NvbW1vblV0aWxzJ10gPSB7fSwgUiwgQ29uc3RhbnRzLCBFcnJvcnMpIDogbW9kdWxlLmV4cG9ydHMgPSBhcGk7XHJcbn0uYmluZCh0aGlzKSk7IiwiLypcclxuICogRGF0ZSBGb3JtYXQgMS4yLjNcclxuICogKGMpIDIwMDctMjAwOSBTdGV2ZW4gTGV2aXRoYW4gPHN0ZXZlbmxldml0aGFuLmNvbT5cclxuICogTUlUIGxpY2Vuc2VcclxuICpcclxuICogSW5jbHVkZXMgZW5oYW5jZW1lbnRzIGJ5IFNjb3R0IFRyZW5kYSA8c2NvdHQudHJlbmRhLm5ldD5cclxuICogYW5kIEtyaXMgS293YWwgPGNpeGFyLmNvbS9+a3Jpcy5rb3dhbC8+XHJcbiAqXHJcbiAqIEFjY2VwdHMgYSBkYXRlLCBhIG1hc2ssIG9yIGEgZGF0ZSBhbmQgYSBtYXNrLlxyXG4gKiBSZXR1cm5zIGEgZm9ybWF0dGVkIHZlcnNpb24gb2YgdGhlIGdpdmVuIGRhdGUuXHJcbiAqIFRoZSBkYXRlIGRlZmF1bHRzIHRvIHRoZSBjdXJyZW50IGRhdGUvdGltZS5cclxuICogVGhlIG1hc2sgZGVmYXVsdHMgdG8gZGF0ZUZvcm1hdC5tYXNrcy5kZWZhdWx0LlxyXG4gKi9cclxuXHJcbi8vIFRoYW5rcyBmb3IgeW91ciB3b3JrIDspIFxyXG4vLyBOdHNES1xyXG5cclxuKGZ1bmN0aW9uKGNhbGxiYWNrKXtcclxuXHJcbnZhciBkYXRlRm9ybWF0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyICAgIHRva2VuID0gL2R7MSw0fXxtezEsNH18eXkoPzp5eSk/fChbSGhNc1R0XSlcXDE/fFtMbG9TWl18XCJbXlwiXSpcInwnW14nXSonL2csXHJcbiAgICAgICAgdGltZXpvbmUgPSAvXFxiKD86W1BNQ0VBXVtTRFBdVHwoPzpQYWNpZmljfE1vdW50YWlufENlbnRyYWx8RWFzdGVybnxBdGxhbnRpYykgKD86U3RhbmRhcmR8RGF5bGlnaHR8UHJldmFpbGluZykgVGltZXwoPzpHTVR8VVRDKSg/OlstK11cXGR7NH0pPylcXGIvZyxcclxuICAgICAgICB0aW1lem9uZUNsaXAgPSAvW14tK1xcZEEtWl0vZyxcclxuICAgICAgICBwYWQgPSBmdW5jdGlvbiAodmFsLCBsZW4pIHtcclxuICAgICAgICAgICAgdmFsID0gU3RyaW5nKHZhbCk7XHJcbiAgICAgICAgICAgIGxlbiA9IGxlbiB8fCAyO1xyXG4gICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IGxlbikgdmFsID0gXCIwXCIgKyB2YWw7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAvLyBSZWdleGVzIGFuZCBzdXBwb3J0aW5nIGZ1bmN0aW9ucyBhcmUgY2FjaGVkIHRocm91Z2ggY2xvc3VyZVxyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRlLCBtYXNrLCB1dGMpIHtcclxuICAgICAgICB2YXIgZEYgPSBkYXRlRm9ybWF0O1xyXG5cclxuICAgICAgICAvLyBZb3UgY2FuJ3QgcHJvdmlkZSB1dGMgaWYgeW91IHNraXAgb3RoZXIgYXJncyAodXNlIHRoZSBcIlVUQzpcIiBtYXNrIHByZWZpeClcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxICYmIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChkYXRlKSA9PSBcIltvYmplY3QgU3RyaW5nXVwiICYmICEvXFxkLy50ZXN0KGRhdGUpKSB7XHJcbiAgICAgICAgICAgIG1hc2sgPSBkYXRlO1xyXG4gICAgICAgICAgICBkYXRlID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGFzc2luZyBkYXRlIHRocm91Z2ggRGF0ZSBhcHBsaWVzIERhdGUucGFyc2UsIGlmIG5lY2Vzc2FyeVxyXG4gICAgICAgIGRhdGUgPSBkYXRlID8gbmV3IERhdGUoZGF0ZSkgOiBuZXcgRGF0ZTtcclxuICAgICAgICBpZiAoaXNOYU4oZGF0ZSkpIHRocm93IFN5bnRheEVycm9yKFwiaW52YWxpZCBkYXRlXCIpO1xyXG5cclxuICAgICAgICBtYXNrID0gU3RyaW5nKGRGLm1hc2tzW21hc2tdIHx8IG1hc2sgfHwgZEYubWFza3NbXCJkZWZhdWx0XCJdKTtcclxuXHJcbiAgICAgICAgLy8gQWxsb3cgc2V0dGluZyB0aGUgdXRjIGFyZ3VtZW50IHZpYSB0aGUgbWFza1xyXG4gICAgICAgIGlmIChtYXNrLnNsaWNlKDAsIDQpID09IFwiVVRDOlwiKSB7XHJcbiAgICAgICAgICAgIG1hc2sgPSBtYXNrLnNsaWNlKDQpO1xyXG4gICAgICAgICAgICB1dGMgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyICAgIF8gPSB1dGMgPyBcImdldFVUQ1wiIDogXCJnZXRcIixcclxuICAgICAgICAgICAgZCA9IGRhdGVbXyArIFwiRGF0ZVwiXSgpLFxyXG4gICAgICAgICAgICBEID0gZGF0ZVtfICsgXCJEYXlcIl0oKSxcclxuICAgICAgICAgICAgbSA9IGRhdGVbXyArIFwiTW9udGhcIl0oKSxcclxuICAgICAgICAgICAgeSA9IGRhdGVbXyArIFwiRnVsbFllYXJcIl0oKSxcclxuICAgICAgICAgICAgSCA9IGRhdGVbXyArIFwiSG91cnNcIl0oKSxcclxuICAgICAgICAgICAgTSA9IGRhdGVbXyArIFwiTWludXRlc1wiXSgpLFxyXG4gICAgICAgICAgICBzID0gZGF0ZVtfICsgXCJTZWNvbmRzXCJdKCksXHJcbiAgICAgICAgICAgIEwgPSBkYXRlW18gKyBcIk1pbGxpc2Vjb25kc1wiXSgpLFxyXG4gICAgICAgICAgICBvID0gdXRjID8gMCA6IGRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKSxcclxuICAgICAgICAgICAgZmxhZ3MgPSB7XHJcbiAgICAgICAgICAgICAgICBkOiAgICBkLFxyXG4gICAgICAgICAgICAgICAgZGQ6ICAgcGFkKGQpLFxyXG4gICAgICAgICAgICAgICAgZGRkOiAgZEYuaTE4bi5kYXlOYW1lc1tEXSxcclxuICAgICAgICAgICAgICAgIGRkZGQ6IGRGLmkxOG4uZGF5TmFtZXNbRCArIDddLFxyXG4gICAgICAgICAgICAgICAgbTogICAgbSArIDEsXHJcbiAgICAgICAgICAgICAgICBtbTogICBwYWQobSArIDEpLFxyXG4gICAgICAgICAgICAgICAgbW1tOiAgZEYuaTE4bi5tb250aE5hbWVzW21dLFxyXG4gICAgICAgICAgICAgICAgbW1tbTogZEYuaTE4bi5tb250aE5hbWVzW20gKyAxMl0sXHJcbiAgICAgICAgICAgICAgICB5eTogICBTdHJpbmcoeSkuc2xpY2UoMiksXHJcbiAgICAgICAgICAgICAgICB5eXl5OiB5LFxyXG4gICAgICAgICAgICAgICAgaDogICAgSCAlIDEyIHx8IDEyLFxyXG4gICAgICAgICAgICAgICAgaGg6ICAgcGFkKEggJSAxMiB8fCAxMiksXHJcbiAgICAgICAgICAgICAgICBIOiAgICBILFxyXG4gICAgICAgICAgICAgICAgSEg6ICAgcGFkKEgpLFxyXG4gICAgICAgICAgICAgICAgTTogICAgTSxcclxuICAgICAgICAgICAgICAgIE1NOiAgIHBhZChNKSxcclxuICAgICAgICAgICAgICAgIHM6ICAgIHMsXHJcbiAgICAgICAgICAgICAgICBzczogICBwYWQocyksXHJcbiAgICAgICAgICAgICAgICBsOiAgICBwYWQoTCwgMyksXHJcbiAgICAgICAgICAgICAgICBMOiAgICBwYWQoTCA+IDk5ID8gTWF0aC5yb3VuZChMIC8gMTApIDogTCksXHJcbiAgICAgICAgICAgICAgICB0OiAgICBIIDwgMTIgPyBcImFcIiAgOiBcInBcIixcclxuICAgICAgICAgICAgICAgIHR0OiAgIEggPCAxMiA/IFwiYW1cIiA6IFwicG1cIixcclxuICAgICAgICAgICAgICAgIFQ6ICAgIEggPCAxMiA/IFwiQVwiICA6IFwiUFwiLFxyXG4gICAgICAgICAgICAgICAgVFQ6ICAgSCA8IDEyID8gXCJBTVwiIDogXCJQTVwiLFxyXG4gICAgICAgICAgICAgICAgWjogICAgdXRjID8gXCJVVENcIiA6IChTdHJpbmcoZGF0ZSkubWF0Y2godGltZXpvbmUpIHx8IFtcIlwiXSkucG9wKCkucmVwbGFjZSh0aW1lem9uZUNsaXAsIFwiXCIpLFxyXG4gICAgICAgICAgICAgICAgbzogICAgKG8gPiAwID8gXCItXCIgOiBcIitcIikgKyBwYWQoTWF0aC5mbG9vcihNYXRoLmFicyhvKSAvIDYwKSAqIDEwMCArIE1hdGguYWJzKG8pICUgNjAsIDQpLFxyXG4gICAgICAgICAgICAgICAgUzogICAgW1widGhcIiwgXCJzdFwiLCBcIm5kXCIsIFwicmRcIl1bZCAlIDEwID4gMyA/IDAgOiAoZCAlIDEwMCAtIGQgJSAxMCAhPSAxMCkgKiBkICUgMTBdXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBtYXNrLnJlcGxhY2UodG9rZW4sIGZ1bmN0aW9uICgkMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJDAgaW4gZmxhZ3MgPyBmbGFnc1skMF0gOiAkMC5zbGljZSgxLCAkMC5sZW5ndGggLSAxKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn0oKTtcclxuXHJcbi8vIFNvbWUgY29tbW9uIGZvcm1hdCBzdHJpbmdzXHJcbmRhdGVGb3JtYXQubWFza3MgPSB7XHJcbiAgICBcImRlZmF1bHRcIjogICAgICBcImRkZCBtbW0gZGQgeXl5eSBISDpNTTpzc1wiLFxyXG4gICAgc2hvcnREYXRlOiAgICAgIFwibS9kL3l5XCIsXHJcbiAgICBtZWRpdW1EYXRlOiAgICAgXCJtbW0gZCwgeXl5eVwiLFxyXG4gICAgbG9uZ0RhdGU6ICAgICAgIFwibW1tbSBkLCB5eXl5XCIsXHJcbiAgICBmdWxsRGF0ZTogICAgICAgXCJkZGRkLCBtbW1tIGQsIHl5eXlcIixcclxuICAgIHNob3J0VGltZTogICAgICBcImg6TU0gVFRcIixcclxuICAgIG1lZGl1bVRpbWU6ICAgICBcImg6TU06c3MgVFRcIixcclxuICAgIGxvbmdUaW1lOiAgICAgICBcImg6TU06c3MgVFQgWlwiLFxyXG4gICAgaXNvRGF0ZTogICAgICAgIFwieXl5eS1tbS1kZFwiLFxyXG4gICAgaXNvVGltZTogICAgICAgIFwiSEg6TU06c3NcIixcclxuICAgIGlzb0RhdGVUaW1lOiAgICBcInl5eXktbW0tZGQnVCdISDpNTTpzc1wiLFxyXG4gICAgaXNvVXRjRGF0ZVRpbWU6IFwiVVRDOnl5eXktbW0tZGQnVCdISDpNTTpzcydaJ1wiXHJcbn07XHJcblxyXG4vLyBJbnRlcm5hdGlvbmFsaXphdGlvbiBzdHJpbmdzXHJcbmRhdGVGb3JtYXQuaTE4biA9IHtcclxuICAgIGRheU5hbWVzOiBbXHJcbiAgICAgICAgXCJTdW5cIiwgXCJNb25cIiwgXCJUdWVcIiwgXCJXZWRcIiwgXCJUaHVcIiwgXCJGcmlcIiwgXCJTYXRcIixcclxuICAgICAgICBcIlN1bmRheVwiLCBcIk1vbmRheVwiLCBcIlR1ZXNkYXlcIiwgXCJXZWRuZXNkYXlcIiwgXCJUaHVyc2RheVwiLCBcIkZyaWRheVwiLCBcIlNhdHVyZGF5XCJcclxuICAgIF0sXHJcbiAgICBtb250aE5hbWVzOiBbXHJcbiAgICAgICAgXCJKYW5cIiwgXCJGZWJcIiwgXCJNYXJcIiwgXCJBcHJcIiwgXCJNYXlcIiwgXCJKdW5cIiwgXCJKdWxcIiwgXCJBdWdcIiwgXCJTZXBcIiwgXCJPY3RcIiwgXCJOb3ZcIiwgXCJEZWNcIixcclxuICAgICAgICBcIkphbnVhcnlcIiwgXCJGZWJydWFyeVwiLCBcIk1hcmNoXCIsIFwiQXByaWxcIiwgXCJNYXlcIiwgXCJKdW5lXCIsIFwiSnVseVwiLCBcIkF1Z3VzdFwiLCBcIlNlcHRlbWJlclwiLCBcIk9jdG9iZXJcIiwgXCJOb3ZlbWJlclwiLCBcIkRlY2VtYmVyXCJcclxuICAgIF1cclxufTtcclxuXHJcbmNhbGxiYWNrKGRhdGVGb3JtYXQpO1xyXG5cclxufSkoZnVuY3Rpb24oZGF0ZUZvcm1hdCl7XHJcbiAgICB0eXBlb2YgZXhwb3J0cyA9PT0gJ3VuZGVmaW5lZCc/IHRoaXNbJ2RhdGVGb3JtYXQnXSA9IGRhdGVGb3JtYXQ6IG1vZHVsZS5leHBvcnRzID0gZGF0ZUZvcm1hdDtcclxufS5iaW5kKHRoaXMpKTtcclxuXHJcbiIsInZhciBkZWZhdWx0TGFuZyA9ICdydSc7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
